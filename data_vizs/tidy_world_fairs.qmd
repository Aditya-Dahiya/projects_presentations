---
title: "World's Fairs data @ #TidyTuesday"
author: "Aditya Dahiya"
date: "2024-08-14"
subtitle: ".................."
categories:
  - "#TidyTuesday"
image: "thumbnails/tidy_world_fairs.png"
format:
  html:
    code-fold: true
editor_options: 
  chunk_output_type: console
execute: 
  error: false
  message: false
  warning: false
  eval: false
filters:
  - social-share
share:
  permalink: "https://aditya-dahiya.github.io/projects_presentations/data_vizs.html"
  twitter: true
  linkedin: true
  email: true
  mastodon: true
bibliography: references.bib
---

![...................](tidy_world_fairs.png){#fig-1}

### **How I made this graphic?**

Loading libraries & data

```{r}
#| label: setup

# Data Import and Wrangling Tools
library(tidyverse)            # All things tidy

# Final plot tools
library(scales)               # Nice Scales for ggplot2
library(fontawesome)          # Icons display in ggplot2
library(ggtext)               # Markdown text support for ggplot2
library(showtext)             # Display fonts in ggplot2
library(colorspace)           # Lighten and Darken colours
library(seecolor)             # To print and view colours
library(patchwork)            # Combining plots

# Read data directly from GitHub
worlds_fairs <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-08-13/worlds_fairs.csv')
```

Data Wrangling

```{r}
#| label: eda

worlds_fairs |> 
  summarytools::dfSummary() |> 
  summarytools::view()

worlds_fairs |> 
  group_by(category) |> 
  summarise(mean(is.na(cost)))

df <- worlds_fairs |> 
  mutate(
    end_month = if_else(
      start_year != end_year,
      12 + end_month,
      end_month
    ),
    end_year = if_else(
      start_year != end_year,
      start_year,
      end_year
    )
  )

df |> 
  ggplot(
    mapping = aes(
      y = start_year
    )
  ) +
  geom_segment(
    mapping = aes(
      yend = start_year,
      x = start_month,
      xend = end_month,
      linewidth = visitors
    ),
    alpha = 0.5
  ) +
  scale_x_continuous(
    expand = expansion(0),
    breaks = 1:22,
    limits = c(1, 22),
    labels = c(month.abb, month.abb[1:10])
  ) +
  scale_y_continuous()

```

Visualization Parameters

```{r}
#| label: viz-params

# Font for titles
font_add_google("Bilbo",
  family = "title_font"
) 

# Font for the caption
font_add_google("Barlow Semi Condensed",
  family = "caption_font",
  regular.wt = 400,
  bold.wt = 700
) 

# Font for plot text
font_add_google("Ubuntu Condensed",
  family = "body_font"
) 

showtext_auto()

text_col <- "grey20"
text_hil <- "grey30"

bts <- 80

# Caption stuff for the plot
sysfonts::font_add(
  family = "Font Awesome 6 Brands",
  regular = here::here("docs", "Font Awesome 6 Brands-Regular-400.otf")
)
github <- "&#xf09b"
github_username <- "aditya-dahiya"
xtwitter <- "&#xe61b"
xtwitter_username <- "@adityadahiyaias"
social_caption_1 <- glue::glue("<span style='font-family:\"Font Awesome 6 Brands\";'>{github};</span> <span style='color: {text_hil}'>{github_username}  </span>")
social_caption_2 <- glue::glue("<span style='font-family:\"Font Awesome 6 Brands\";'>{xtwitter};</span> <span style='color: {text_hil}'>{xtwitter_username}</span>")

plot_title <- "Average Age of Olympians"

plot_subtitle <- "Since the start of Modern Summer Olympics in 1896, the average age **(represented by**<br>**the dots)** of Olympics' medallists and participants has stayed around 25 years<br>**(represented by the vertical line)**. Of late, average age has been increasing slightly."
str_view(plot_subtitle)

plot_caption <- paste0(
  "**Data:** _#TidyTuesday_ & RGriffin's Kaggle Dataset: ", 
  " |  **Code:** ", 
  social_caption_1, 
  " |  **Graphics:** ", 
  social_caption_2
  )

rm(github, github_username, xtwitter, 
   xtwitter_username, social_caption_1, 
   social_caption_2)
```

The static plot

```{r}
#| label: static-plot


df5 |> 
  ggplot(
    mapping = aes(
      x = 1, 
      y = n, 
      fill = continent
    )
  ) +
  geom_col(
    colour = bg_col,
    width = 0.15
  ) +
  geom_text(
    mapping = aes(
      label = paste0(perc, " %")
    ),
    position = position_stack(vjust = 0.5),
    family = "body_font"
  ) +
  facet_wrap(~ year, scales = "free") +
  scale_x_continuous(
    limits = c(0, 1.5), 
    expand = expansion(c(0, -0.3))
  ) +
  coord_polar(theta = "y") +
  theme_void(
    base_family = "body_font",
    base_size = bts
  ) +
  theme(
    legend.position = "none",
    plot.background = element_rect(
      fill = "transparent",
      colour = "transparent"
    ),
    panel.background = element_rect(
      fill = "transparent",
      colour = "transparent"
    )
  )
```

Savings the graphics

```{r}
#| label: save-image

ggsave(
  filename = here::here("data_vizs", "tidy_olympics.png"),
  plot = g,
  width = 400,    # Best Twitter Aspect Ratio = 5:4
  height = 500,   
  units = "mm",
  bg = "white"
)

library(magick)
# Saving a thumbnail for the webpage
image_read(here::here("data_vizs", "tidy_olympics.png")) |> 
  image_resize(geometry = "400") |> 
  image_write(here::here("data_vizs", "thumbnails", "tidy_olympics.png"))
```
