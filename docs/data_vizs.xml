<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Data Viz Collective</title>
<link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs.html</link>
<atom:link href="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs.xml" rel="self" type="application/rss+xml"/>
<description>Aditya Dahiya</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Sun, 02 Nov 2025 18:30:00 GMT</lastBuildDate>
<item>
  <title>The Coastal Gravity: Where Humanity Chooses to Live</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_elev_pop_chart.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<p>The GlobPOP dataset (<a href="https://github.com/lulingliu/GlobPOP">GlobPOP GitHub Repository</a>) is a comprehensive 33-year (1990-2022) global gridded population product generated through cluster analysis and statistical learning. The data, which has a spatial resolution of 30 arcseconds (approximately 1km), is provided in GeoTIFF format for easy integration and analysis, featuring two key population formats: ‘Count’ and ‘Density’. The primary, continuous GlobPOP 1990-2022 dataset can be freely accessed on Zenodo (<a href="https://doi.org/10.5281/zenodo.7813301">Zenodo Data Access</a>). Researchers can find the methodology and initial scope (1990-2020) detailed in the corresponding article published in Scientific Data (<a href="https://doi.org/10.1038/s41597-024-02913-0">Sci Data 11, 124 (2024)</a>). For a visual and comparative understanding of the data’s temporal accuracy, an interactive web application (<a href="https://globpop.shinyapps.io/GlobPOP/">GlobPOP ShinyApp</a>) for time-series analysis is also available. Specific citation links are provided for the methodology Code (<a href="https://doi.org/10.5281/zenodo.10098366">Code Citation on Zenodo</a>) and the Updated Dataset version 3.0 (<a href="https://doi.org/10.5281/zenodo.11179644">Updated Dataset Citation on Zenodo</a>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/a4_world_elev_pop_chart.png" class="img-fluid figure-img"></p>
<figcaption>This chart compares global population distribution with Earth’s topography across elevation bands. The black line represents the percentage of Earth’s surface area at each elevation above sea level. Colored vertical bars show the percentage of world population living at each elevation in 2020, with bar colors indicating change from 1990 to 2020: green shows elevation bands where population share increased, red where it decreased. Bar height reflects concentration—taller bars indicate more people living at that elevation relative to available land area.</figcaption>
</figure>
</div>
</section>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic"><strong>How I made this graphic?</strong></h2>
<section id="loading-required-libraries-data-import-creating-custom-functions" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries-data-import-creating-custom-functions">Loading required libraries, data import &amp; creating custom functions</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb1-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb1-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb1-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb1-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb1-11">  terra,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb1-12">  tidyterra,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting Rasters with ggplot2</span></span>
<span id="cb1-13">  sf,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling geometric objects</span></span>
<span id="cb1-14">  geodata       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get elevation data</span></span>
<span id="cb1-15">)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35">mypal1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rcartocolor::SunsetDark"</span>)</span>
<span id="cb2-36">mypal2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rcartocolor::ag_GrnYl"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-37"></span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  GlobalPOP dataset + {gedata}"</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span></code></pre></div>
</details>
</div>
</section>
<section id="annotation-text-for-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="annotation-text-for-the-plot">Annotation Text for the Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">plot_title1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Living on the Edge"</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">plot_title2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global Population Shifts Toward Low Elevations"</span></span>
<span id="cb3-4"></span>
<span id="cb3-5">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A dangerous demographic trend emerges from three decades of data: humanity is clustering ever more densely in low-lying coastal zones. Areas near sea level&lt;br&gt;(shown in &lt;span style='color:#2a9d8f;'&gt;**green**&lt;/span&gt;) experienced the largest increases in their contribution to global population between 1990 and 2020, while higher elevations (&lt;span style='color:#e76f51;'&gt;**red bars**&lt;/span&gt;)&lt;br&gt;saw their share decline proportionally. This concentration in climate-vulnerable areas intensifies as sea levels rise, creating a collision course&lt;br&gt;between population distribution and environmental risk."</span></span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span>
<span id="cb3-7"></span>
<span id="cb3-8">inset_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_elev_pop_chart"</span></span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(inset_text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;"</span>)</span></code></pre></div>
</details>
</div>
<p>Loading of temporarily saved files.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SAVE ELEVATION DATA AND RASTER</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Save the elevation data tibbles as RDS files (preserves R data structure)</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(</span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   all_elev_data, </span></span>
<span id="cb4-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   file = "all_elev_data.rds"</span></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   all_elev_data_summary, </span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   file = "all_elev_data_summary.rds"</span></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># saveRDS(</span></span>
<span id="cb4-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   elev_area_summary,</span></span>
<span id="cb4-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   file = "elevation_area_summary.rds"</span></span>
<span id="cb4-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb4-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Save the elevation raster (terra format)</span></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># terra::writeRaster(</span></span>
<span id="cb4-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   elev_raster,</span></span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filename = "elev_raster.tif",</span></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   overwrite = TRUE</span></span>
<span id="cb4-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb4-26"></span>
<span id="cb4-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save the resampled elevation raster (matched to population data)</span></span>
<span id="cb4-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># terra::writeRaster(</span></span>
<span id="cb4-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   elev_resampled,</span></span>
<span id="cb4-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filename = "elev_resampled.tif",</span></span>
<span id="cb4-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   overwrite = TRUE</span></span>
<span id="cb4-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb4-33"></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb4-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># TO LOAD THESE FILES LATER</span></span>
<span id="cb4-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb4-37"></span>
<span id="cb4-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To load the data in a new session:</span></span>
<span id="cb4-39">all_elev_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all_elev_data.rds"</span>)</span>
<span id="cb4-40">elev_area_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation_area_summary.rds"</span>)</span>
<span id="cb4-41">all_elev_data_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readRDS</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"all_elev_data_summary.rds"</span>)</span>
<span id="cb4-42">elev_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elev_raster.tif"</span>)</span>
<span id="cb4-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># elev_resampled &lt;- terra::rast("elev_resampled.tif")</span></span></code></pre></div>
</details>
</div>
</section>
<section id="getting-world-elevation-raster-using-geodata" class="level3">
<h3 class="anchored" data-anchor-id="getting-world-elevation-raster-using-geodata">Getting World Elevation Raster using <code>{geodata}</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Define the directory where the data will be downloaded/stored.</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We use tempdir() to ensure the file is saved temporarily, but you can</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># replace this with a permanent path if you plan to reuse the data.</span></span>
<span id="cb5-4">data_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>()</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Download the global elevation raster (ETOPO1 data source)</span></span>
<span id="cb5-7">elev_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">elevation_global</span>(</span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">res =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> data_path</span>
<span id="cb5-10">)</span>
<span id="cb5-11"></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Print the result to confirm it contains elevation values (in meters)</span></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print(elev_raster)</span></span>
<span id="cb5-14"></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. (Optional) Basic plot to visualize the global elevation</span></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The values are in meters, showing land elevation and ocean bathymetry.</span></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot(</span></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   elev_raster, main = "World Elevation Raster (ETOPO1, 30 arc-sec resolution)"</span></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span>
<span id="cb5-21"></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reduce resolution significantly (aggregate by factor of 10-20)</span></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the percentage area of world for each elevation level</span></span>
<span id="cb5-24">elev_area_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> elev_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reduces resolution 20x</span></span>
<span id="cb5-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">freq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bylayer =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation_m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(value),</span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_area_m2 =</span> count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> {</span>
<span id="cb5-33">      elev_raster <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-34">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fun =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-35">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cellSize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">unit =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"m"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-36">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-37">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>()</span>
<span id="cb5-38">    }</span>
<span id="cb5-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_world_area =</span> (total_area_m2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(total_area_m2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(elevation_m, pct_world_area, count, total_area_m2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(elevation_m)</span>
<span id="cb5-43"></span>
<span id="cb5-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># View results</span></span>
<span id="cb5-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># elev_area_summary</span></span></code></pre></div>
</details>
</div>
</section>
<section id="getting-population-raster-data-and-analysis" class="level3">
<h3 class="anchored" data-anchor-id="getting-population-raster-data-and-analysis">Getting Population Raster Data and Analysis</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FUNCTION TO ANALYZE POPULATION BY ELEVATION FOR A GIVEN YEAR</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Analyzes population distribution by 1-meter elevation bands for a given year</span></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param year Integer representing the year (e.g., 1990)</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param elev_raster Terra SpatRaster of elevation data</span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A tibble with elevation bands and population percentages</span></span>
<span id="cb6-10">analyze_pop_by_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(year, elev_raster) {</span>
<span id="cb6-11">  </span>
<span id="cb6-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.1 Load population raster for the year</span></span>
<span id="cb6-13">  filename <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GlobPOP_Count_30arc_"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_I32.tiff"</span>)</span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing year: "</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" (File: "</span>, filename, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb6-15">  </span>
<span id="cb6-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(filename)) {</span>
<span id="cb6-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"File not found for year "</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">": "</span>, filename, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">". Skipping."</span>)</span>
<span id="cb6-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb6-19">  }</span>
<span id="cb6-20">  </span>
<span id="cb6-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load and aggregate population raster</span></span>
<span id="cb6-22">  pop_raster <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(filename) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-23">    terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-24">  </span>
<span id="cb6-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.2 Resample elevation to match population raster resolution and extent</span></span>
<span id="cb6-26">  elev_resampled <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resample</span>(</span>
<span id="cb6-27">    elev_raster, </span>
<span id="cb6-28">    pop_raster, </span>
<span id="cb6-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bilinear"</span></span>
<span id="cb6-30">  )</span>
<span id="cb6-31">  </span>
<span id="cb6-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.3 Convert both rasters to data frames</span></span>
<span id="cb6-33">  pop_col_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(pop_raster)</span>
<span id="cb6-34">  </span>
<span id="cb6-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine elevation and population data</span></span>
<span id="cb6-36">  combined_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(</span>
<span id="cb6-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(elev_resampled, pop_raster),</span>
<span id="cb6-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xy =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb6-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-41">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb6-42">  </span>
<span id="cb6-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename columns for clarity</span></span>
<span id="cb6-44">  elev_col_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(elev_resampled)</span>
<span id="cb6-45">  combined_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> combined_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-46">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb6-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span>elev_col_name,</span>
<span id="cb6-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span>pop_col_name</span>
<span id="cb6-49">    )</span>
<span id="cb6-50">  </span>
<span id="cb6-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.4 Calculate total global population</span></span>
<span id="cb6-52">  total_global_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(combined_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb6-53">  </span>
<span id="cb6-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.5 Create 1-meter elevation bands</span></span>
<span id="cb6-55">  pop_by_elevation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> combined_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Round elevation to nearest meter (e.g., 1m represents 0.5 to 1.5m)</span></span>
<span id="cb6-57">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(elevation)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-58">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by elevation band</span></span>
<span id="cb6-59">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(elevation_band) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sum population for each band</span></span>
<span id="cb6-61">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb6-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_in_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb6-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb6-64">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-65">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate percentage relative to total global population</span></span>
<span id="cb6-66">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_global_pop =</span> (pop_in_band <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb6-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year)</span>
<span id="cb6-69">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-70">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Rename for clarity</span></span>
<span id="cb6-71">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">elevation_m =</span> elevation_band)</span>
<span id="cb6-72">  </span>
<span id="cb6-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(pop_by_elevation)</span>
<span id="cb6-74">}</span>
<span id="cb6-75"></span>
<span id="cb6-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. ANALYZE ALL YEARS (1990-2020)</span></span>
<span id="cb6-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-79"></span>
<span id="cb6-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define years to analyze</span></span>
<span id="cb6-81">years_to_analyze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb6-82"></span>
<span id="cb6-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply the function to all years</span></span>
<span id="cb6-84">all_elevation_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(</span>
<span id="cb6-85">  years_to_analyze, </span>
<span id="cb6-86">  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analyze_pop_by_elevation</span>(.x, elev_raster)</span>
<span id="cb6-87">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-88">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compact</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove NULL entries if any files were missing</span></span>
<span id="cb6-89"></span>
<span id="cb6-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine all years into a single tibble</span></span>
<span id="cb6-91">all_elev_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>(all_elevation_results)</span>
<span id="cb6-92"></span>
<span id="cb6-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. CREATE SUMMARY FOR 1990 vs 2020 COMPARISON</span></span>
<span id="cb6-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb6-96"></span>
<span id="cb6-97">all_elev_data_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_elev_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-98">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure year is numeric for easy filtering</span></span>
<span id="cb6-99">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(year))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-100">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for start (1990) and end (2020) years</span></span>
<span id="cb6-101">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-102">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select key columns</span></span>
<span id="cb6-103">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(elevation_m, year_num, percent_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-104">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pivot wider to compare 1990 and 2020 side-by-side</span></span>
<span id="cb6-105">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb6-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> year_num,</span>
<span id="cb6-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> percent_global_pop,</span>
<span id="cb6-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_pct_"</span>,</span>
<span id="cb6-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill missing elevations with 0</span></span>
<span id="cb6-110">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-111">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate change metrics</span></span>
<span id="cb6-112">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-113">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Absolute change in percentage contribution</span></span>
<span id="cb6-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution_absolute =</span> pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990,</span>
<span id="cb6-115">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative change in percentage contribution</span></span>
<span id="cb6-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb6-117">      pop_pct_1990 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_real_</span>,</span>
<span id="cb6-118">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ((pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb6-119">    )</span>
<span id="cb6-120">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-121">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add current population percentage for plotting</span></span>
<span id="cb6-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb6-123">    all_elev_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-124">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-125">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(elevation_m, percent_global_pop),</span>
<span id="cb6-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"elevation_m"</span></span>
<span id="cb6-127">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="make-an-inset-chart-for-elevation-above-2000-metres" class="level3">
<h3 class="anchored" data-anchor-id="make-an-inset-chart-for-elevation-above-2000-metres">Make an inset chart for elevation above 2000 metres</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">g_inset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> all_elev_data_summary,</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> elevation_m,</span>
<span id="cb7-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pop_pct_2020,</span>
<span id="cb7-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> change_contribution_absolute,</span>
<span id="cb7-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_contribution_absolute</span>
<span id="cb7-9">    ),</span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb7-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev_area_summary,</span>
<span id="cb7-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> elevation_m,</span>
<span id="cb7-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pct_world_area</span>
<span id="cb7-19">    ),</span>
<span id="cb7-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb7-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb7-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb7-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>,</span>
<span id="cb7-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.08</span>,</span>
<span id="cb7-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population and Area  for elevation above 2000 metres, globally."</span>,</span>
<span id="cb7-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb7-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,  </span>
<span id="cb7-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb7-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb7-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb7-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>),</span>
<span id="cb7-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" m"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb7-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb7-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb7-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(</span>
<span id="cb7-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span>),</span>
<span id="cb7-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb7-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-47">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb7-48">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>),,</span>
<span id="cb7-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)</span>
<span id="cb7-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-54">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(</span>
<span id="cb7-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>),,</span>
<span id="cb7-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)</span>
<span id="cb7-60">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb7-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb7-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-73">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb7-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-78">    ),</span>
<span id="cb7-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb7-80">    </span>
<span id="cb7-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb7-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb7-86">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-87">      )</span>
<span id="cb7-88">    ),</span>
<span id="cb7-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb7-91">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-92">      ),</span>
<span id="cb7-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-95">    ),</span>
<span id="cb7-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb7-99">    ),</span>
<span id="cb7-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-102">    ),</span>
<span id="cb7-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-105">    ),</span>
<span id="cb7-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-108">    ),</span>
<span id="cb7-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.top =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-111">    ),</span>
<span id="cb7-112">    </span>
<span id="cb7-113">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panel and Legend</span></span>
<span id="cb7-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb7-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb7-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb7-119">    ),</span>
<span id="cb7-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb7-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb7-123">    )</span>
<span id="cb7-124">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="the-base-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-base-plot">The Base Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb8-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> all_elev_data_summary,</span>
<span id="cb8-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> elevation_m,</span>
<span id="cb8-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pop_pct_2020,</span>
<span id="cb8-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> change_contribution_absolute,</span>
<span id="cb8-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_contribution_absolute</span>
<span id="cb8-9">    ),</span>
<span id="cb8-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb8-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb8-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14"></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> elev_area_summary,</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> elevation_m,</span>
<span id="cb8-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> pct_world_area</span>
<span id="cb8-20">    ),</span>
<span id="cb8-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb8-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-24"></span>
<span id="cb8-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add plot title annotation</span></span>
<span id="cb8-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb8-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_title1,</span>
<span id="cb8-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> ,  </span>
<span id="cb8-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb8-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb8-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb8-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.32</span>,</span>
<span id="cb8-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_title2,</span>
<span id="cb8-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts ,  </span>
<span id="cb8-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb8-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb8-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add plot subtitle annotation</span></span>
<span id="cb8-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb8-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>,</span>
<span id="cb8-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.28</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Slightly below title</span></span>
<span id="cb8-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_subtitle,</span>
<span id="cb8-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,  </span>
<span id="cb8-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb8-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(bg_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>),</span>
<span id="cb8-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb8-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-67">  </span>
<span id="cb8-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotation for the global land area black line</span></span>
<span id="cb8-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(</span>
<span id="cb8-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">750</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.028</span>),</span>
<span id="cb8-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>),</span>
<span id="cb8-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb8-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb8-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span>,</span>
<span id="cb8-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb8-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Black line: Global land</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">area (%) at each elevation"</span>,</span>
<span id="cb8-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb8-87">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-88">  </span>
<span id="cb8-89">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Annotation for BARS (population) - pointing to prominent bars near sea level</span></span>
<span id="cb8-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_curve</span>(</span>
<span id="cb8-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.18</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>),</span>
<span id="cb8-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>),</span>
<span id="cb8-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb8-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb8-96">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,</span>
<span id="cb8-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.18</span>,</span>
<span id="cb8-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Colored bars:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Global population (%)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">at each elevation (2020)"</span>,</span>
<span id="cb8-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb8-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-109">    </span>
<span id="cb8-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb8-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>),</span>
<span id="cb8-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>),</span>
<span id="cb8-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">metres"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)</span>
<span id="cb8-114">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-115">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb8-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb8-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(</span>
<span id="cb8-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb8-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb8-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb8-122">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-123">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb8-124">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb8-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>),,</span>
<span id="cb8-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb8-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb8-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)</span>
<span id="cb8-129">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-130">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(</span>
<span id="cb8-131">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb8-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>),,</span>
<span id="cb8-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb8-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb8-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>)</span>
<span id="cb8-136">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb8-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Elevation (in metres) above sea level"</span>,</span>
<span id="cb8-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage (global population or area) at that elevation"</span></span>
<span id="cb8-143">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-144">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb8-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts,</span>
<span id="cb8-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb8-147">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-149">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb8-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb8-154">    ),</span>
<span id="cb8-155">    </span>
<span id="cb8-156">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb8-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb8-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb8-159">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-160">      ),</span>
<span id="cb8-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb8-163">    ),</span>
<span id="cb8-164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb8-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb8-166">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-167">      ),</span>
<span id="cb8-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb8-170">    ),</span>
<span id="cb8-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb8-174">    ),</span>
<span id="cb8-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-177">    ),</span>
<span id="cb8-178">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span>,</span>
<span id="cb8-180">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-182">    ),</span>
<span id="cb8-183">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-184">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span>,</span>
<span id="cb8-185">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-186">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-187">    ),</span>
<span id="cb8-188">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.top =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-189">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-190">    ),</span>
<span id="cb8-191">    </span>
<span id="cb8-192">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-193">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-194">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-195">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-196">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-197">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-198">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-199">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb8-200">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb8-201">      ),</span>
<span id="cb8-202">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-203">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-204">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-205">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-206">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb8-207">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-208">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb8-209">      ),</span>
<span id="cb8-210">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb8-211">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-212">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-213">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-214">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb8-215">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-216">      ),</span>
<span id="cb8-217">    </span>
<span id="cb8-218">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panel and Legend</span></span>
<span id="cb8-219">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb8-220">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-221">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey70"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-222">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-223">    ),</span>
<span id="cb8-224">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inside"</span>,</span>
<span id="cb8-225">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position.inside =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb8-226">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb8-227">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb8-228">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-229">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-230">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-231">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-232">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb8-233">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-234">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-235">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb8-236">    ),</span>
<span id="cb8-237">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-238">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-239">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb8-240">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-241">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb8-242">    ),</span>
<span id="cb8-243">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-244">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="adding-qr-code-to-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="adding-qr-code-to-the-plot">Adding QR code to the plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A QR Code for the infographic</span></span>
<span id="cb9-2">url_graphics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb9-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://aditya-dahiya.github.io/projects_presentations/data_vizs/"</span>,</span>
<span id="cb9-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The file name of the current .qmd file</span></span>
<span id="cb9-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_elev_pop_chart"</span>,         </span>
<span id="cb9-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".html"</span></span>
<span id="cb9-7">)</span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github('coolbutuseless/ggqr')</span></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggqr)</span></span>
<span id="cb9-10">plot_qr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb9-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> url_graphics)</span>
<span id="cb9-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-14">  ggqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qr</span>(</span>
<span id="cb9-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb9-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb9-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span></span>
<span id="cb9-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb9-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb9-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>,</span>
<span id="cb9-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scan for complete Code used to make this graphic"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb9-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb9-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb9-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb9-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb9-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb9-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb9-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb9-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb9-38">    ),</span>
<span id="cb9-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb9-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb9-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb9-42">    ),</span>
<span id="cb9-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb9-44">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="combining-the-plots" class="level3">
<h3 class="anchored" data-anchor-id="combining-the-plots">Combining the Plots</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">g_full <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inset_element</span>(</span>
<span id="cb10-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> g_inset,</span>
<span id="cb10-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb10-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>,</span>
<span id="cb10-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>,</span>
<span id="cb10-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb10-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inset_element</span>(</span>
<span id="cb10-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> plot_qr,</span>
<span id="cb10-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb10-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb10-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>,</span>
<span id="cb10-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb10-15">  )</span>
<span id="cb10-16"></span>
<span id="cb10-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb10-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb10-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb10-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_world_elev_pop_chart.png"</span></span>
<span id="cb10-21">  ),</span>
<span id="cb10-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g_full,</span>
<span id="cb10-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">297</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">210</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb10-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb10-26">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb10-27">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-graphics" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-graphics">Savings the graphics</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_world_elev_pop_chart.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb11-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb11-6">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_elev_pop_chart.png"</span>))</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb12-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb12-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb12-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb12-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb12-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb12-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb12-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb12-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb12-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb12-11">  terra,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb12-12">  tidyterra,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting Rasters with ggplot2</span></span>
<span id="cb12-13">  sf            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling geometric objects</span></span>
<span id="cb12-14">)</span>
<span id="cb12-15"></span>
<span id="cb12-16">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-18">  </span>
<span id="cb12-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The attached column is TRUE for packages that were </span></span>
<span id="cb12-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># explicitly loaded with library()</span></span>
<span id="cb12-21">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(attached <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-22">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb12-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb12-24">    date, source</span>
<span id="cb12-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-26">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-27">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb12-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb12-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-30">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb12-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb12-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb12-34">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rmshicqiwp" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rmshicqiwp table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rmshicqiwp thead, #rmshicqiwp tbody, #rmshicqiwp tfoot, #rmshicqiwp tr, #rmshicqiwp td, #rmshicqiwp th {
  border-style: none;
}

#rmshicqiwp p {
  margin: 0;
  padding: 0;
}

#rmshicqiwp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rmshicqiwp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rmshicqiwp .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rmshicqiwp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rmshicqiwp .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmshicqiwp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmshicqiwp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmshicqiwp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rmshicqiwp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rmshicqiwp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rmshicqiwp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rmshicqiwp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rmshicqiwp .gt_spanner_row {
  border-bottom-style: hidden;
}

#rmshicqiwp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rmshicqiwp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rmshicqiwp .gt_from_md > :first-child {
  margin-top: 0;
}

#rmshicqiwp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rmshicqiwp .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rmshicqiwp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rmshicqiwp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rmshicqiwp .gt_row_group_first td {
  border-top-width: 2px;
}

#rmshicqiwp .gt_row_group_first th {
  border-top-width: 2px;
}

#rmshicqiwp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmshicqiwp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rmshicqiwp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rmshicqiwp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmshicqiwp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmshicqiwp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rmshicqiwp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rmshicqiwp .gt_striped {
  background-color: #FAFAFA;
}

#rmshicqiwp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmshicqiwp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmshicqiwp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmshicqiwp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmshicqiwp .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmshicqiwp .gt_left {
  text-align: left;
}

#rmshicqiwp .gt_center {
  text-align: center;
}

#rmshicqiwp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rmshicqiwp .gt_font_normal {
  font-weight: normal;
}

#rmshicqiwp .gt_font_bold {
  font-weight: bold;
}

#rmshicqiwp .gt_font_italic {
  font-style: italic;
}

#rmshicqiwp .gt_super {
  font-size: 65%;
}

#rmshicqiwp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rmshicqiwp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rmshicqiwp .gt_indent_1 {
  text-indent: 5px;
}

#rmshicqiwp .gt_indent_2 {
  text-indent: 10px;
}

#rmshicqiwp .gt_indent_3 {
  text-indent: 15px;
}

#rmshicqiwp .gt_indent_4 {
  text-indent: 20px;
}

#rmshicqiwp .gt_indent_5 {
  text-indent: 25px;
}

#rmshicqiwp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rmshicqiwp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="rmshicqiwp" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="rmshicqiwp">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["colorspace","dplyr","fontawesome","forcats","ggplot2","ggtext","lubridate","magick","patchwork","purrr","readr","scales","sf","showtext","showtextdb","stringr","sysfonts","terra","tibble","tidyr","tidyterra","tidyverse"],"Version":["2.1-1","1.1.4","0.5.3","1.0.0","4.0.0","0.1.2","1.9.4","2.8.6","1.3.0","1.0.4","2.1.5","1.4.0","1.0-20","0.9-7","3.0","1.5.1","0.8.9","1.8-70","3.2.1","1.3.1","0.7.2","2.0.0"],"Date":["2024-07-26","2023-11-17","2024-11-16","2023-01-29","2025-09-11","2022-09-16","2024-12-08","2025-03-23","2024-09-16","2025-02-05","2024-01-10","2025-04-24","2025-03-24","2024-03-02","2020-06-04","2023-11-14","2024-03-02","2025-09-27","2023-03-20","2024-01-24","2025-04-14","2023-02-22"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"rmshicqiwp","dataKey":"0c598f5412915973e861628e3412b851"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>World Bank Data</category>
  <category>A4 Size Viz</category>
  <category>Governance</category>
  <category>Demographics</category>
  <category>Public Health</category>
  <category>Geocomputation</category>
  <category>Raster</category>
  <category>{terra}</category>
  <category>{geodata}</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_elev_pop_chart.html</guid>
  <pubDate>Sun, 02 Nov 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/world_elev_pop_chart.png" medium="image" type="image/png" height="102" width="144"/>
</item>
<item>
  <title>Global Population by Latitude and Longitude, 1990-2020</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_lat_lon_pop_chart.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<p>The GlobPOP dataset (<a href="https://github.com/lulingliu/GlobPOP">GlobPOP GitHub Repository</a>) is a comprehensive 33-year (1990-2022) global gridded population product generated through cluster analysis and statistical learning. The data, which has a spatial resolution of 30 arcseconds (approximately 1km), is provided in GeoTIFF format for easy integration and analysis, featuring two key population formats: ‘Count’ and ‘Density’. The primary, continuous GlobPOP 1990-2022 dataset can be freely accessed on Zenodo (<a href="https://doi.org/10.5281/zenodo.7813301">Zenodo Data Access</a>). Researchers can find the methodology and initial scope (1990-2020) detailed in the corresponding article published in Scientific Data (<a href="https://doi.org/10.1038/s41597-024-02913-0">Sci Data 11, 124 (2024)</a>). For a visual and comparative understanding of the data’s temporal accuracy, an interactive web application (<a href="https://globpop.shinyapps.io/GlobPOP/">GlobPOP ShinyApp</a>) for time-series analysis is also available. Specific citation links are provided for the methodology Code (<a href="https://doi.org/10.5281/zenodo.10098366">Code Citation on Zenodo</a>) and the Updated Dataset version 3.0 (<a href="https://doi.org/10.5281/zenodo.11179644">Updated Dataset Citation on Zenodo</a>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/a4_world_lat_lon_pop_chart.png" class="img-fluid figure-img"></p>
<figcaption>Two world maps show population distribution by one-degree latitude and longitude bands. Horizontal (latitude) and vertical (longitude) bars represent the percentage of global population residing in each band as of 2020. Colors indicate absolute change in contribution from 1990 to 2020: red bars mark regions whose share declined, green shows increases, and yellow indicates stable contributions. Secondary axes display population percentages, while primary axes show geographic coordinates, allowing readers to identify specific regions experiencing demographic shifts.</figcaption>
</figure>
</div>
</section>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic"><strong>How I made this graphic?</strong></h2>
<p>This visualization was created entirely in R using a custom coordinate transformation workflow. World map data was obtained from the <a href="https://docs.ropensci.org/rnaturalearth/">{rnaturalearth}</a> package and processed using <a href="https://r-spatial.github.io/sf/">{sf}</a> for spatial operations, including <code>st_wrap_dateline()</code> to handle polygons crossing the antimeridian at ±180° longitude. Rather than using <code>geom_sf()</code>, the spatial geometries were converted to simple x-y coordinate tibbles and rendered with <code>geom_polygon()</code>, allowing for a custom scaling system where latitude (-90° to 90°) maps to 0-100 and longitude (-180° to 180°) maps to 0-200, preserving the 2:1 aspect ratio of the EPSG:4326 projection. Population data from the GlobPOP dataset was aggregated by one-degree latitude and longitude bands using <a href="https://rspatial.github.io/terra/">{terra}</a> for raster processing, then transformed to match the custom coordinate system. The bar charts were overlaid using <code>geom_col()</code> with a diverging color scale from <a href="https://emilhvitfeldt.github.io/paletteer/">{paletteer}</a> to show absolute changes in population contribution. Final plot composition was achieved with <a href="https://patchwork.data-imaginist.com/">{patchwork}</a>, combining both latitude and longitude visualizations with shared legends and annotations using <a href="https://wilkelab.org/ggtext/">{ggtext}</a> for markdown-formatted text elements.</p>
<section id="loading-required-libraries-data-import-creating-custom-functions" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries-data-import-creating-custom-functions">Loading required libraries, data import &amp; creating custom functions</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb1-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb1-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb1-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb1-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb1-11">  terra,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb1-12">  tidyterra,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting Rasters with ggplot2</span></span>
<span id="cb1-13">  sf            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling geometric objects</span></span>
<span id="cb1-14">)</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># world_lat_lon_pop_chart</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Import Data from downloaded directory</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1990 to 2022 year Global Population Density 30 sec arc resolution</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set Working Directory to a temporary one ---------------------------</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rast_2022 &lt;- terra::rast("GlobPOP_Count_30arc_2022_I32.tiff") |&gt; </span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Reduce the granularity of the data to make it easier on computation and good to plot also</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   terra::aggregate(fact = 10)</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rast_2022 |&gt; terra::crs() |&gt; str_view()</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggplot() +</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_spatraster(data = rast_2022)</span></span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35">mypal1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rcartocolor::SunsetDark"</span>)</span>
<span id="cb2-36">mypal2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rcartocolor::ag_GrnYl"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-37"></span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  GlobalPOP dataset, Liu, Cao, Li, et al."</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span></code></pre></div>
</details>
</div>
</section>
<section id="annotation-text-for-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="annotation-text-for-the-plot">Annotation Text for the Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mapping humanity: Population Distribution (1990-2020)"</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The global demographic center of gravity is shifting. Northern temperate zones (above 30°N latitude) are losing their share of world population, while tropical and subtropical regions between 0° and 30°N—which have historically dominated—are growing fastest. In terms of longitude, East Asia's contribution declined significantly from 1990 to 2020, while the Middle East, South Asia, and Africa saw the greatest increases. Humanity is becoming more concentrated in fewer latitudes and longitudes than ever before."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span>
<span id="cb3-6"></span>
<span id="cb3-7">inset_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b&gt;About the Data:&lt;/b&gt;&lt;br&gt;The GlobPOP dataset is a comprehensive 33-year (1990-2022) global gridded&lt;br&gt;population product generated through cluster analysis and statistical learning.&lt;br&gt;The data, which has a spatial resolution of 30 arcseconds (approximately 1km),&lt;br&gt;is provided in GeoTIFF format for easy integration and analysis, featuring two&lt;br&gt;key population formats: 'Count' and 'Density'. The primary, continuous GlobPOP&lt;br&gt;1990-2022 dataset can be freely accessed on Zenodo. Researchers can find the&lt;br&gt;methodology and initial scope (1990-2020) detailed in the corresponding article&lt;br&gt;published in Scientific Data."</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(inset_text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis---for-1-year-as-an-example" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis---for-1-year-as-an-example">Exploratory Data Analysis - for 1 year as an example</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculation of Population Distribution by Latitude and Longitude</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Prepare data and get total global population</span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the SpatRaster to a tibble with coordinates (x=lon, y=lat) and population value,</span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># removing NA values (e.g., oceans)</span></span>
<span id="cb4-6">pop_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(rast_2022, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xy =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The population column name is retrieved dynamically from the raster object</span></span>
<span id="cb4-10">pop_col_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(rast_2022)</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the total global population from the processed data</span></span>
<span id="cb4-13">total_global_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop_data[[pop_col_name]])</span>
<span id="cb4-14"></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Population by Latitude Band</span></span>
<span id="cb4-16">pop_by_latitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Round latitude (y) to the nearest integer degree to define the 1-degree band (e.g., 34 is 33.5 to 34.5)</span></span>
<span id="cb4-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by the latitude band</span></span>
<span id="cb4-20">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lat_band) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sum population for each band</span></span>
<span id="cb4-22">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_in_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(.data[[pop_col_name]]),</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb4-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate percentage relative to the total global population</span></span>
<span id="cb4-27">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_global_pop =</span> (pop_in_band <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort to see the most populated bands first</span></span>
<span id="cb4-31">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(percent_global_pop))</span>
<span id="cb4-32"></span>
<span id="cb4-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Population by Longitude Band</span></span>
<span id="cb4-34">pop_by_longitude <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Round longitude (x) to the nearest integer degree to define the 1-degree band</span></span>
<span id="cb4-36">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lon_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group by the longitude band</span></span>
<span id="cb4-38">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(lon_band) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sum population for each band</span></span>
<span id="cb4-40">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_in_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(.data[[pop_col_name]]),</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb4-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate percentage relative to the total global population</span></span>
<span id="cb4-45">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_global_pop =</span> (pop_in_band <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb4-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort to see the most populated bands first</span></span>
<span id="cb4-49">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(percent_global_pop))</span>
<span id="cb4-50"></span>
<span id="cb4-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Create and Save Plots for Visualization</span></span>
<span id="cb4-52"></span>
<span id="cb4-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot for Latitude Distribution</span></span>
<span id="cb4-54">latitude_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_by_latitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat_band, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> percent_global_pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#56B4E9"</span>, </span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0072B2"</span>, </span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">orientation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span></span>
<span id="cb4-61">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage of Global Population by Latitude Band (Year 2022)"</span>,</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population aggregated for each 1-degree band (e.g., 34° is 33.5° to 34.5°)"</span>,</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latitude Band (Degrees)"</span>,</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage of Global Population (%)"</span></span>
<span id="cb4-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom scale to show N/S for clarity</span></span>
<span id="cb4-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"°"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"N"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"S"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)))</span>
<span id="cb4-72">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb4-76"></span>
<span id="cb4-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot for Longitude Distribution</span></span>
<span id="cb4-78">longitude_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_by_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> lon_band, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> percent_global_pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#009E73"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#006449"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage of Global Population by Longitude Band (Year 2022)"</span>,</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Population aggregated for each 1-degree band (e.g., 100° is 99.5° to 100.5°)"</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Longitude Band (Degrees)"</span>,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage of Global Population (%)"</span></span>
<span id="cb4-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-87">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom scale to show E/W for clarity</span></span>
<span id="cb4-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>),</span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"°"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"W"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)))</span>
<span id="cb4-91">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>))</span>
<span id="cb4-95"></span>
<span id="cb4-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combine the plots using patchwork and save</span></span>
<span id="cb4-97">combined_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> latitude_plot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> longitude_plot</span>
<span id="cb4-98"></span>
<span id="cb4-99"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-100">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-101">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-102">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_lat_lon_pop_chart_1.png"</span></span>
<span id="cb4-103">  ),</span>
<span id="cb4-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> combined_plot, </span>
<span id="cb4-105">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, </span>
<span id="cb4-106">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, </span>
<span id="cb4-107">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span>
<span id="cb4-108">)</span></code></pre></div>
</details>
</div>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_lat_lon_pop_chart_1.png" id="fig-1" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</section>
<section id="data-wrangling---to-get-data-for-multiple-years" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling---to-get-data-for-multiple-years">Data Wrangling - To get data for multiple years</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Credits: Gemini 2.5 </span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This script performs a multi-year analysis of global population distribution</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># by calculating the percentage of population residing within each 1-degree band</span></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># of latitude and longitude for the years 1990, 1995, 2000, ..., 2020.</span></span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. SETUP AND CONFIGURATION</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the years to analyze</span></span>
<span id="cb5-11">years_to_analyze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb5-12"></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. CORE ANALYSIS FUNCTION</span></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-16"></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Analyzes population distribution by 1-degree bands for a given year's raster file.</span></span>
<span id="cb5-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb5-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param year Integer representing the year (e.g., 1990).</span></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return A list containing two tibbles: 'latitude_data' and 'longitude_data',</span></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'         each with population percentages and the 'year' column. Returns NULL</span></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'         if the raster file for the year is not found.</span></span>
<span id="cb5-23">analyze_pop_for_year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(year) {</span>
<span id="cb5-24"></span>
<span id="cb5-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.1 File Handling</span></span>
<span id="cb5-26">  filename <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GlobPOP_Count_30arc_"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_I32.tiff"</span>)</span>
<span id="cb5-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Processing year: "</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" (File: "</span>, filename, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb5-28"></span>
<span id="cb5-29">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(filename)) {</span>
<span id="cb5-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"File not found for year "</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">": "</span>, filename, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">". Skipping analysis for this year."</span>)</span>
<span id="cb5-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb5-32">  }</span>
<span id="cb5-33"></span>
<span id="cb5-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.2 Load and Aggregate Raster</span></span>
<span id="cb5-35">  rast_year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rast</span>(filename) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Aggregate to reduce computation time, matching the fact = 10 from initial setup</span></span>
<span id="cb5-37">    terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aggregate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fact =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-38"></span>
<span id="cb5-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the name of the population layer</span></span>
<span id="cb5-40">  pop_col_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(rast_year)</span>
<span id="cb5-41"></span>
<span id="cb5-42">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.3 Convert to Tibble and Calculate Global Total</span></span>
<span id="cb5-43">  pop_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> terra<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(rast_year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xy =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-44">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span>
<span id="cb5-45"></span>
<span id="cb5-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure the population column is numeric for summing</span></span>
<span id="cb5-47">  pop_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-48">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!!</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_col_name :=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(.data[[pop_col_name]]))</span>
<span id="cb5-49"></span>
<span id="cb5-50">  total_global_pop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop_data[[pop_col_name]])</span>
<span id="cb5-51"></span>
<span id="cb5-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.4 Population by Latitude Band</span></span>
<span id="cb5-53">  lat_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-54">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Round latitude (y) to the nearest integer degree for the 1-degree band</span></span>
<span id="cb5-55">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-56">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(band) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-57">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb5-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_in_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(.data[[pop_col_name]]),</span>
<span id="cb5-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb5-60">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-61">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_global_pop =</span> (pop_in_band <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb5-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store year as factor for plotting</span></span>
<span id="cb5-64">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-65">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> band)</span>
<span id="cb5-66"></span>
<span id="cb5-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2.5 Population by Longitude Band</span></span>
<span id="cb5-68">  lon_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pop_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-69">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Round longitude (x) to the nearest integer degree for the 1-degree band</span></span>
<span id="cb5-70">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-71">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(band) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-72">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb5-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_in_band =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(.data[[pop_col_name]]),</span>
<span id="cb5-74">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb5-75">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-76">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percent_global_pop =</span> (pop_in_band <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb5-78">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Store year as factor for plotting</span></span>
<span id="cb5-79">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-80">    dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> band)</span>
<span id="cb5-81"></span>
<span id="cb5-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude_data =</span> lat_results, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude_data =</span> lon_results))</span>
<span id="cb5-83">}</span>
<span id="cb5-84"></span>
<span id="cb5-85"></span>
<span id="cb5-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. EXECUTION AND COMBINATION</span></span>
<span id="cb5-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-89"></span>
<span id="cb5-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply the function to all years and collect results</span></span>
<span id="cb5-91">all_results <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(years_to_analyze, analyze_pop_for_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-92">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compact</span>() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove NULL entries if any files were missing</span></span>
<span id="cb5-93"></span>
<span id="cb5-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Separate and combine the latitude and longitude results</span></span>
<span id="cb5-95">all_lat_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-96">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latitude_data"</span>)</span>
<span id="cb5-97"></span>
<span id="cb5-98">all_lon_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-99">  purrr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_df</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longitude_data"</span>)</span>
<span id="cb5-100"></span>
<span id="cb5-101"></span>
<span id="cb5-102"></span>
<span id="cb5-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Latitude Summary</span></span>
<span id="cb5-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-106"></span>
<span id="cb5-107">all_lat_data_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_lat_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-108">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure year is numeric for easy filtering</span></span>
<span id="cb5-109">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(year))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-110">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Filter for the start (1990) and end (2020) years</span></span>
<span id="cb5-111">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-112">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Select key columns</span></span>
<span id="cb5-113">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(latitude, year_num, percent_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-114">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Pivot wider to compare 1990 and 2020 side-by-side</span></span>
<span id="cb5-115">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb5-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> year_num,</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> percent_global_pop,</span>
<span id="cb5-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_pct_"</span></span>
<span id="cb5-119">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-120">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Calculate the change metrics from 1990 to 2020</span></span>
<span id="cb5-121">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-122">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative change in the percentage contribution: ((2020 - 1990) / 1990) * 100</span></span>
<span id="cb5-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb5-124">      pop_pct_1990 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_real_</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid division by zero</span></span>
<span id="cb5-125">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ((pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-126">    ),</span>
<span id="cb5-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution_absolute =</span> pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990</span>
<span id="cb5-128">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-129">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. Select and rename final columns for clarity</span></span>
<span id="cb5-130">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb5-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_pct_1990 =</span> pop_pct_1990,</span>
<span id="cb5-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_pct_2020 =</span> pop_pct_2020</span>
<span id="cb5-133">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-134">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb5-135">    all_lat_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-136">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-137">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(latitude, percent_global_pop)</span>
<span id="cb5-138">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-139">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the latitude data to match the world map coordinate system</span></span>
<span id="cb5-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-141">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform latitude from -90:90 to 0:100 scale</span></span>
<span id="cb5-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_scaled =</span> (latitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb5-143">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform percent to 0:150 scale for x-axis (horizontal bars)</span></span>
<span id="cb5-144">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assuming max percent_global_pop is 4% (mapping 4% to 150)</span></span>
<span id="cb5-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_scaled =</span> percent_global_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb5-146">  )</span>
<span id="cb5-147"></span>
<span id="cb5-148"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_lat_data_summary |&gt; </span></span>
<span id="cb5-149"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(y_scaled) |&gt; range()</span></span>
<span id="cb5-150"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb5-151"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_lat_data_summary |&gt; </span></span>
<span id="cb5-152"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(percent_global_pop) |&gt; range()</span></span>
<span id="cb5-153"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb5-154"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_lat_data_summary |&gt; </span></span>
<span id="cb5-155"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(x_scaled) |&gt; range()</span></span>
<span id="cb5-156"></span>
<span id="cb5-157"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-158"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Longitude Summary</span></span>
<span id="cb5-159"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ----------------------------------------------------------------------</span></span>
<span id="cb5-160"></span>
<span id="cb5-161">all_lon_data_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_lon_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-162">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure year is numeric for easy filtering</span></span>
<span id="cb5-163">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(year))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-164">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Filter for the start (1990) and end (2020) years</span></span>
<span id="cb5-165">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-166">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Select key columns</span></span>
<span id="cb5-167">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(longitude, year_num, percent_global_pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-168">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. Pivot wider to compare 1990 and 2020 side-by-side</span></span>
<span id="cb5-169">  tidyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb5-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> year_num,</span>
<span id="cb5-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> percent_global_pop,</span>
<span id="cb5-172">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_pct_"</span></span>
<span id="cb5-173">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-174">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. Calculate the change metrics from 1990 to 2020</span></span>
<span id="cb5-175">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-176">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Relative change in the percentage contribution: ((2020 - 1990) / 1990) * 100</span></span>
<span id="cb5-177">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution =</span> dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb5-178">      pop_pct_1990 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_real_</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid division by zero</span></span>
<span id="cb5-179">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ((pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> pop_pct_1990) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb5-180">    ),</span>
<span id="cb5-181">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">change_contribution_absolute =</span> pop_pct_2020 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pop_pct_1990</span>
<span id="cb5-182">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-183">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. Select and rename final columns for clarity</span></span>
<span id="cb5-184">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb5-185">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_pct_1990 =</span> pop_pct_1990,</span>
<span id="cb5-186">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_pct_2020 =</span> pop_pct_2020</span>
<span id="cb5-187">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-188">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb5-189">    all_lon_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-190">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-191">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(longitude, percent_global_pop)</span>
<span id="cb5-192">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-193">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the longitude data to match the world map coordinate system</span></span>
<span id="cb5-194">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb5-195">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform longitude from -180:180 to 0:200 scale</span></span>
<span id="cb5-196">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_scaled =</span> (longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb5-197">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform percent to 0:100 scale for y-axis</span></span>
<span id="cb5-198">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assuming max percent_global_pop is 2% (mapping 2% to 100)</span></span>
<span id="cb5-199">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_scaled =</span> percent_global_pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb5-200">  )</span>
<span id="cb5-201"></span>
<span id="cb5-202"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(all_lon_data_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change_contribution, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span>
<span id="cb5-203"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(all_lon_data_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change_contribution_absolute, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span>
<span id="cb5-204"></span>
<span id="cb5-205"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(all_lat_data_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change_contribution, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span>
<span id="cb5-206"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(all_lat_data_summary<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>change_contribution_absolute, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span></code></pre></div>
</details>
</div>
</section>
<section id="get-a-world-map-to-display-on-coord_cartesian" class="level3">
<h3 class="anchored" data-anchor-id="get-a-world-map-to-display-on-coord_cartesian">Get a world map to display on <code>coord_cartesian()</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearth)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get world countries as polygons, handle antimeridian, transform to EPSG:4326, convert to coordinates, and scale</span></span>
<span id="cb6-7">world_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_wrap_dateline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">options =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WRAPDATELINE=YES"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DATELINEOFFSET=180"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MULTIPOLYGON"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warn =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_cast</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"POLYGON"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warn =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> L2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb6-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinate ranges in EPSG:4326</span></span>
<span id="cb6-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_min =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb6-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb6-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_min =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb6-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate ranges</span></span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_range =</span> x_max <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_min,</span>
<span id="cb6-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_range =</span> y_max <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_min,</span>
<span id="cb6-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale y: -90° South = 0, +90° North = 100</span></span>
<span id="cb6-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_scaled =</span> (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_min) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> y_range <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,</span>
<span id="cb6-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale x: -180° West = 0, +180° East = 200 (2:1 aspect ratio)</span></span>
<span id="cb6-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_scaled =</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_min) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> x_range <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb6-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_scaled, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_scaled, group)</span>
<span id="cb6-30"></span>
<span id="cb6-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Test plot</span></span>
<span id="cb6-32">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(world_plot, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(</span>
<span id="cb6-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightgray"</span>, </span>
<span id="cb6-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, </span>
<span id="cb6-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb6-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"World Map with Scaled Coordinates (EPSG:4326)"</span>,</span>
<span id="cb6-41">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y: 0-100 (90°S to 90°N), X: 0-200 (-180°W to 180°E)"</span>)</span>
<span id="cb6-42"></span>
<span id="cb6-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb6-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-45">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-46">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_lat_lon_pop_chart_2.png"</span></span>
<span id="cb6-47">  ),</span>
<span id="cb6-48">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb6-49">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,</span>
<span id="cb6-50">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb6-51">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dpi =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span>
<span id="cb6-52">)</span></code></pre></div>
</details>
</div>
<div id="fig-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_lat_lon_pop_chart_2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: This map displays country boundaries from Natural Earth data, rendered using a custom coordinate transformation. The original geographic coordinates (EPSG:4326/WGS84) were linearly scaled to fit a standardized grid where the y-axis spans 0-100 (corresponding to 90°S to 90°N latitude) and the x-axis spans 0-200 (corresponding to 180°W to 180°E longitude), preserving the 2:1 aspect ratio characteristic of the equirectangular projection. Geometries were processed through st_wrap_dateline() to properly handle polygons crossing the antimeridian (±180° longitude). Rather than using geom_sf(), the spatial data was converted to a simple tibble of x-y coordinates and rendered with geom_polygon().
</figcaption>
</figure>
</div>
</section>
<section id="the-base-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-base-plot">The base plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the latitude data plot with dual axes</span></span>
<span id="cb7-2">lat_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add world map as background</span></span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(</span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_plot,</span>
<span id="cb7-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group),</span>
<span id="cb7-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray75"</span>,</span>
<span id="cb7-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray75"</span>,</span>
<span id="cb7-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add population bars (horizontal)</span></span>
<span id="cb7-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb7-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> all_lat_data_summary,</span>
<span id="cb7-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_scaled,</span>
<span id="cb7-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_scaled,</span>
<span id="cb7-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> change_contribution_absolute,</span>
<span id="cb7-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_contribution_absolute</span>
<span id="cb7-20">    ),</span>
<span id="cb7-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb7-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb7-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb7-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">orientation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span></span>
<span id="cb7-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># In your plot</span></span>
<span id="cb7-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb7-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb7-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">195</span>,</span>
<span id="cb7-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb7-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> inset_text,</span>
<span id="cb7-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb7-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(bg_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>),</span>
<span id="cb7-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(bg_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>),</span>
<span id="cb7-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-41">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb7-42">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb7-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb7-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb7-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-48">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(</span>
<span id="cb7-49">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb7-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb7-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb7-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-55">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Primary x-axis (bottom) shows longitude</span></span>
<span id="cb7-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb7-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Longitude"</span>,</span>
<span id="cb7-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>),</span>
<span id="cb7-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"180°W"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°W"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"180°E"</span>),</span>
<span id="cb7-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb7-61">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Secondary x-axis (top) shows percentage</span></span>
<span id="cb7-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sec.axis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sec_axis</span>(</span>
<span id="cb7-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trans =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb7-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% of world population in that latitude in year 2020"</span>,</span>
<span id="cb7-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb7-66">    )</span>
<span id="cb7-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Y-axis shows latitude</span></span>
<span id="cb7-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb7-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latitude"</span>,</span>
<span id="cb7-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb7-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°S"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"45°S"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"45°N"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°N"</span>),</span>
<span id="cb7-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb7-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>(</span>
<span id="cb7-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb7-78">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb7-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb7-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb7-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global Population Distribution by Latitude"</span></span>
<span id="cb7-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-87">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb7-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-89">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-91">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-92">    ),</span>
<span id="cb7-93">    </span>
<span id="cb7-94">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb7-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-98">    ),</span>
<span id="cb7-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x.top =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb7-101">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-102">      ),</span>
<span id="cb7-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-105">    ),</span>
<span id="cb7-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x.top =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-108">    ),</span>
<span id="cb7-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-111">    ),</span>
<span id="cb7-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-114">    ),</span>
<span id="cb7-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-117">    ),</span>
<span id="cb7-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-120">    ),</span>
<span id="cb7-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.top =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-123">    ),</span>
<span id="cb7-124">    </span>
<span id="cb7-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-126">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-127">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-128">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-129">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb7-130">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-131">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span>,</span>
<span id="cb7-132">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-133">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb7-134">      ),</span>
<span id="cb7-135">    </span>
<span id="cb7-136">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panel and Legend</span></span>
<span id="cb7-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb7-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb7-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longdash"</span></span>
<span id="cb7-142">    ),</span>
<span id="cb7-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb7-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb7-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb7-152">    ),</span>
<span id="cb7-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb7-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-157">    ),</span>
<span id="cb7-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-159">  )</span>
<span id="cb7-160"></span>
<span id="cb7-161"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the longitude data plot with dual axes</span></span>
<span id="cb7-162">lon_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-163">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add world map as background</span></span>
<span id="cb7-164">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(</span>
<span id="cb7-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_plot,</span>
<span id="cb7-166">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group),</span>
<span id="cb7-167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray75"</span>,</span>
<span id="cb7-168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray75"</span>,</span>
<span id="cb7-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-171">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-172">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add population bars</span></span>
<span id="cb7-173">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb7-174">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> all_lon_data_summary,</span>
<span id="cb7-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_scaled,</span>
<span id="cb7-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_scaled,</span>
<span id="cb7-178">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> change_contribution_absolute,</span>
<span id="cb7-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> change_contribution_absolute</span>
<span id="cb7-180">    ),</span>
<span id="cb7-181">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb7-182">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb7-183">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span></span>
<span id="cb7-184">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-185">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb7-186">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-187">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),,</span>
<span id="cb7-188">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-189">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb7-190">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb7-191">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-192">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(</span>
<span id="cb7-193">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemes::Red-Green-Gold Diverging"</span>,</span>
<span id="cb7-194">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),,</span>
<span id="cb7-195">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb7-196">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Contribution (%) to World Population between 1990 and 2020"</span>,</span>
<span id="cb7-197">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>)</span>
<span id="cb7-198">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-199">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Primary y-axis (left) shows scaled coordinates 0-100</span></span>
<span id="cb7-200">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb7-201">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latitude"</span>,</span>
<span id="cb7-202">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb7-203">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°S"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"45°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"45°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°N"</span>),</span>
<span id="cb7-204">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Secondary y-axis (right) shows percentage</span></span>
<span id="cb7-205">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sec.axis =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sec_axis</span>(</span>
<span id="cb7-206">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trans =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> . <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>,</span>
<span id="cb7-207">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"% of world population in that longitude in year 2020"</span>,</span>
<span id="cb7-208">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">percent_format</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb7-209">    )</span>
<span id="cb7-210">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-211">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># X-axis shows longitude</span></span>
<span id="cb7-212">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb7-213">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Longitude"</span>,</span>
<span id="cb7-214">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>),</span>
<span id="cb7-215">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"180°W"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°W"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0°"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90°E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"180°E"</span>),</span>
<span id="cb7-216">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb7-217">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-218">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>(</span>
<span id="cb7-219">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-220">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb7-221">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-222">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb7-223">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb7-224">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb7-225">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-226">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-227">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb7-228">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>),</span>
<span id="cb7-229">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span></span>
<span id="cb7-230">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-231">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb7-232">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global Population Distribution by Longitude"</span></span>
<span id="cb7-233">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-234">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-235">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb7-236">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-237">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-238">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-239">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-240">    ),</span>
<span id="cb7-241">    </span>
<span id="cb7-242">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb7-243">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-244">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-245">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-246">    ),</span>
<span id="cb7-247">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y.right =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-248">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb7-249">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-250">      ),</span>
<span id="cb7-251">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-252">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb7-253">    ),</span>
<span id="cb7-254">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-255">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-256">    ),</span>
<span id="cb7-257">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-258">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-259">    ),</span>
<span id="cb7-260">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y.right =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-261">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-262">    ),</span>
<span id="cb7-263">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-264">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-265">    ),</span>
<span id="cb7-266">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y.right =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-267">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-268">    ),</span>
<span id="cb7-269">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-270">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-271">    ),</span>
<span id="cb7-272">    </span>
<span id="cb7-273">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-274">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-275">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-276">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb7-277">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb7-278">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-279">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span>,</span>
<span id="cb7-280">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-281">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb7-282">      ),</span>
<span id="cb7-283">    </span>
<span id="cb7-284">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panel and Legend</span></span>
<span id="cb7-285">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb7-286">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb7-287">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb7-288">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb7-289">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longdash"</span></span>
<span id="cb7-290">     ),</span>
<span id="cb7-291">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb7-292">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-293">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-294">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-295">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-296">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb7-297">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-298">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-299">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb7-300">    ),</span>
<span id="cb7-301">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb7-302">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb7-303">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb7-304">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-305">    ),</span>
<span id="cb7-306">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb7-307">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="adding-qr-code-to-the-plot" class="level3">
<h3 class="anchored" data-anchor-id="adding-qr-code-to-the-plot">Adding QR code to the plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A QR Code for the infographic</span></span>
<span id="cb8-2">url_graphics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb8-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://aditya-dahiya.github.io/projects_presentations/data_vizs/"</span>,</span>
<span id="cb8-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The file name of the current .qmd file</span></span>
<span id="cb8-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_lat_lon_pop_chart"</span>,         </span>
<span id="cb8-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".html"</span></span>
<span id="cb8-7">)</span>
<span id="cb8-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github('coolbutuseless/ggqr')</span></span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggqr)</span></span>
<span id="cb8-10">plot_qr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb8-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> url_graphics)</span>
<span id="cb8-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-14">  ggqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qr</span>(</span>
<span id="cb8-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span></span>
<span id="cb8-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.07</span>,</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scan for complete Code used to make this graphic"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb8-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb8-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb8-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb8-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb8-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb8-38">    ),</span>
<span id="cb8-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb8-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb8-42">    ),</span>
<span id="cb8-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-44">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="combining-the-plots" class="level3">
<h3 class="anchored" data-anchor-id="combining-the-plots">Combining the Plots</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wrap_plots</span>(</span>
<span id="cb9-2">    lat_plot, </span>
<span id="cb9-3">    lon_plot,</span>
<span id="cb9-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb9-6">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb9-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb9-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb9-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb9-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb9-13">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb9-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb9-15">      ),</span>
<span id="cb9-16">    </span>
<span id="cb9-17">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb9-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb9-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb9-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb9-24">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb9-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb9-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb9-27">      ),</span>
<span id="cb9-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-31">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb9-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb9-33">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb9-34">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb9-35">      ),</span>
<span id="cb9-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb9-37">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb9-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-39">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb9-40">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb9-41">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb9-42">      ),</span>
<span id="cb9-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb9-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb9-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb9-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb9-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-53">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-54">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb9-55">      ),</span>
<span id="cb9-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb9-57">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb9-58">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb9-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb9-60">      )</span>
<span id="cb9-61">    )</span>
<span id="cb9-62">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inset_element</span>(</span>
<span id="cb9-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> plot_qr,</span>
<span id="cb9-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>,</span>
<span id="cb9-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb9-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(</span>
<span id="cb9-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">guides =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"collect"</span></span>
<span id="cb9-72">  )</span>
<span id="cb9-73"></span>
<span id="cb9-74"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb9-75">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb9-76">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb9-77">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_world_lat_lon_pop_chart.png"</span></span>
<span id="cb9-78">  ),</span>
<span id="cb9-79">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb9-80">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">297</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-81">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">210</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb9-82">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb9-83">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb9-84">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-graphics" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-graphics">Savings the graphics</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_world_lat_lon_pop_chart.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb10-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb10-6">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"world_lat_lon_pop_chart.png"</span>))</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb11-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb11-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb11-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb11-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb11-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb11-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb11-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb11-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb11-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb11-11">  terra,        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling Rasters in R</span></span>
<span id="cb11-12">  tidyterra,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting Rasters with ggplot2</span></span>
<span id="cb11-13">  sf            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handling geometric objects</span></span>
<span id="cb11-14">)</span>
<span id="cb11-15"></span>
<span id="cb11-16">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-18">  </span>
<span id="cb11-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The attached column is TRUE for packages that were </span></span>
<span id="cb11-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># explicitly loaded with library()</span></span>
<span id="cb11-21">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(attached <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-22">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb11-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb11-24">    date, source</span>
<span id="cb11-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-26">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-27">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb11-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb11-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-30">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-31">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb11-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb11-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb11-34">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="nqmwalgrkz" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#nqmwalgrkz table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nqmwalgrkz thead, #nqmwalgrkz tbody, #nqmwalgrkz tfoot, #nqmwalgrkz tr, #nqmwalgrkz td, #nqmwalgrkz th {
  border-style: none;
}

#nqmwalgrkz p {
  margin: 0;
  padding: 0;
}

#nqmwalgrkz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nqmwalgrkz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nqmwalgrkz .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nqmwalgrkz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nqmwalgrkz .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nqmwalgrkz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nqmwalgrkz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nqmwalgrkz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nqmwalgrkz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nqmwalgrkz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nqmwalgrkz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nqmwalgrkz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nqmwalgrkz .gt_spanner_row {
  border-bottom-style: hidden;
}

#nqmwalgrkz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nqmwalgrkz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nqmwalgrkz .gt_from_md > :first-child {
  margin-top: 0;
}

#nqmwalgrkz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nqmwalgrkz .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nqmwalgrkz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nqmwalgrkz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nqmwalgrkz .gt_row_group_first td {
  border-top-width: 2px;
}

#nqmwalgrkz .gt_row_group_first th {
  border-top-width: 2px;
}

#nqmwalgrkz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nqmwalgrkz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nqmwalgrkz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nqmwalgrkz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nqmwalgrkz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nqmwalgrkz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nqmwalgrkz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nqmwalgrkz .gt_striped {
  background-color: #FAFAFA;
}

#nqmwalgrkz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nqmwalgrkz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nqmwalgrkz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nqmwalgrkz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nqmwalgrkz .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nqmwalgrkz .gt_left {
  text-align: left;
}

#nqmwalgrkz .gt_center {
  text-align: center;
}

#nqmwalgrkz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nqmwalgrkz .gt_font_normal {
  font-weight: normal;
}

#nqmwalgrkz .gt_font_bold {
  font-weight: bold;
}

#nqmwalgrkz .gt_font_italic {
  font-style: italic;
}

#nqmwalgrkz .gt_super {
  font-size: 65%;
}

#nqmwalgrkz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nqmwalgrkz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nqmwalgrkz .gt_indent_1 {
  text-indent: 5px;
}

#nqmwalgrkz .gt_indent_2 {
  text-indent: 10px;
}

#nqmwalgrkz .gt_indent_3 {
  text-indent: 15px;
}

#nqmwalgrkz .gt_indent_4 {
  text-indent: 20px;
}

#nqmwalgrkz .gt_indent_5 {
  text-indent: 25px;
}

#nqmwalgrkz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nqmwalgrkz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="nqmwalgrkz" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="nqmwalgrkz">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["colorspace","dplyr","fontawesome","forcats","ggplot2","ggtext","lubridate","magick","patchwork","purrr","readr","scales","sf","showtext","showtextdb","stringr","sysfonts","terra","tibble","tidyr","tidyterra","tidyverse"],"Version":["2.1-1","1.1.4","0.5.3","1.0.0","4.0.0","0.1.2","1.9.4","2.8.6","1.3.0","1.0.4","2.1.5","1.4.0","1.0-20","0.9-7","3.0","1.5.1","0.8.9","1.8-70","3.2.1","1.3.1","0.7.2","2.0.0"],"Date":["2024-07-26","2023-11-17","2024-11-16","2023-01-29","2025-09-11","2022-09-16","2024-12-08","2025-03-23","2024-09-16","2025-02-05","2024-01-10","2025-04-24","2025-03-24","2024-03-02","2020-06-04","2023-11-14","2024-03-02","2025-09-27","2023-03-20","2024-01-24","2025-04-14","2023-02-22"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"nqmwalgrkz","dataKey":"0c598f5412915973e861628e3412b851"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>World Bank Data</category>
  <category>A4 Size Viz</category>
  <category>Governance</category>
  <category>Demographics</category>
  <category>Public Health</category>
  <category>Geocomputation</category>
  <category>Maps</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/world_lat_lon_pop_chart.html</guid>
  <pubDate>Sat, 01 Nov 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/world_lat_lon_pop_chart.png" medium="image" type="image/png" height="204" width="144"/>
</item>
<item>
  <title>Tree-Maps: The Great Fertility Transition</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/wb_tfr_pop_treemap.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level3">
<h3 class="anchored" data-anchor-id="about-the-data"><strong>About the Data</strong></h3>
<p>Total Fertility Rate (TFR) represents the average number of children a woman would bear during her lifetime based on current age-specific fertility rates. A TFR of 2.1 is considered ‘replacement level’ in developed countries—the rate needed to maintain population stability without immigration, accounting for mortality. The 0.1 above two children compensates for infant and childhood deaths. This analysis uses <a href="https://databank.worldbank.org">World Bank DataBank</a> indicators SP.DYN.TFRT.IN for TFR and SP.POP.TOTL for population, spanning 1960-2024. Data was accessed using the <a href="https://github.com/gshs-ornl/wbstats"><code>wbstats</code></a> R package.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/a4_wb_tfr_pop_treemap.png" class="img-fluid figure-img"></p>
<figcaption>This treemap displays countries as rectangles proportional to population size, arranged by continent. Color intensity indicates Total Fertility Rate, with cooler tones below 2.1 (replacement level) and warmer tones above. Larger countries show both names and flags for clarity. The visualization integrates <code>{ggplot2},</code> <code>{treemapify}</code> for spatial layouts, and <code>{ggflags}</code> for flag graphics, processing World Bank demographic data spanning 1960-2023 to reveal global fertility trends across eight time points.</figcaption>
</figure>
</div>
</section>
<section id="how-i-made-this-graphic" class="level3">
<h3 class="anchored" data-anchor-id="how-i-made-this-graphic"><strong>How I made this graphic?</strong></h3>
<p>Loading required libraries, data import &amp; creating custom functions</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb1-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb1-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb1-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb1-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb1-11">  wbstats,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># World Bank data access</span></span>
<span id="cb1-12">  treemapify    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Making Tree-Maps with ggplot2</span></span>
<span id="cb1-13">)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators &lt;- wbstats::wb_indicators()</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator_id, "SP.DYN.TFRT.Q")) |&gt; </span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(indicator_id) |&gt; </span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   paste0(collapse = ", ")</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(indicator_desc) |&gt;</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull() |&gt;</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   str_wrap(80) |&gt;</span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   str_view()</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator_id, "SP.DYN.TFRT.IN"))</span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   mutate(indicator = str_to_lower(indicator)) |&gt;</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator, "total population")) |&gt;</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   View()</span></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator, "Total population"))</span></span>
<span id="cb1-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator_id, "SP.POP.TOTL"))</span></span>
<span id="cb1-39"></span>
<span id="cb1-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Q1 represents the lowest (poorest) wealth quintile.</span></span>
<span id="cb1-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Q5 represents the highest (richest) wealth quintile.</span></span>
<span id="cb1-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Q2, Q3, and Q4 represent the intermediate wealth quintiles.</span></span>
<span id="cb1-43"></span>
<span id="cb1-44">selected_indicators <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-45">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "SP.DYN.TFRT.Q1", </span></span>
<span id="cb1-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "SP.DYN.TFRT.Q2", </span></span>
<span id="cb1-47">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "SP.DYN.TFRT.Q3", </span></span>
<span id="cb1-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "SP.DYN.TFRT.Q4", </span></span>
<span id="cb1-49">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "SP.DYN.TFRT.Q5",</span></span>
<span id="cb1-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.DYN.TFRT.IN"</span>,</span>
<span id="cb1-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.TOTL"</span></span>
<span id="cb1-52">)</span>
<span id="cb1-53"> </span>
<span id="cb1-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt; </span></span>
<span id="cb1-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   object.size() |&gt; </span></span>
<span id="cb1-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   print(units = "Mb")</span></span>
<span id="cb1-57"></span>
<span id="cb1-58">rawdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wb_data</span>(</span>
<span id="cb1-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator =</span> selected_indicators,</span>
<span id="cb1-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start_date =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>,</span>
<span id="cb1-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end_date =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span></span>
<span id="cb1-62">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-63">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb1-64"> </span>
<span id="cb1-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rawdf |&gt; </span></span>
<span id="cb1-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   object.size() |&gt; </span></span>
<span id="cb1-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   print(units = "Mb")</span></span>
<span id="cb1-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rawdf |&gt; </span></span>
<span id="cb1-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   drop_na() |&gt; </span></span>
<span id="cb1-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   count(date, sort = T)</span></span></code></pre></div>
</details>
</div>
<p>Visualization Parameters</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("calecopal::superbloom2")</span></span>
<span id="cb2-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("fishualize::Etheostoma_spectabile")</span></span>
<span id="cb2-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("lisa::MarcChagall")</span></span>
<span id="cb2-38">mypal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lisa::KazimirMalevich"</span>)</span>
<span id="cb2-39"></span>
<span id="cb2-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-41">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-44">)</span>
<span id="cb2-45">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-46">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-47">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-48">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-49">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-50">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-51">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  World Bank's DataBank"</span>,</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-54">  social_caption_1,</span>
<span id="cb2-55">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-56">  social_caption_2</span>
<span id="cb2-57">)</span>
<span id="cb2-58"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-59">  github, github_username, xtwitter,</span>
<span id="cb2-60">  xtwitter_username, social_caption_1,</span>
<span id="cb2-61">  social_caption_2</span>
<span id="cb2-62">)</span></code></pre></div>
</details>
</div>
<p>Annotation Text for the Plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shrinking Families, Shifting Continents"</span></span>
<span id="cb3-2"></span>
<span id="cb3-3">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global fertility rates have plummeted from over 5 children per woman in 1960 to below 2.5 by 2023. Most developed nations now sit well below the 2.1 replacement level, with Europe and Americas leading this demographic transition. Africa remains the exception, maintaining higher fertility rates that position it for significant population growth."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span>
<span id="cb3-6"></span>
<span id="cb3-7">inset_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..................."</span></span></code></pre></div>
</details>
</div>
<p>Exploratory Data Analysis &amp; Data Wrangling</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rawdf</span></span>
<span id="cb4-2">valid_codes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>codelist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iso3c[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>codelist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iso3c)]</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A Dataset for countries</span></span>
<span id="cb4-5">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rawdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(iso3c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> valid_codes) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> date,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tfr =</span> sp_dyn_tfrt_in,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> sp_pop_totl</span>
<span id="cb4-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso2c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(iso2c)</span>
<span id="cb4-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb4-17">      iso3c,</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span>,</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"continent"</span>,</span>
<span id="cb4-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warn =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-21">    ),</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb4-23">      iso3c,</span>
<span id="cb4-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span>,</span>
<span id="cb4-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span></span>
<span id="cb4-26">    )</span>
<span id="cb4-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(continent)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out ISO codes before plotting for which Flags exist (drop the few wrong ones)</span></span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(iso2c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>lflags)) </span>
<span id="cb4-31"></span>
<span id="cb4-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ISO3C for countries whose names we want to display in the tree map</span></span>
<span id="cb4-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># selected_cons &lt;- df1 |&gt;</span></span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   group_by(year, continent) |&gt;</span></span>
<span id="cb4-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   slice_max(order_by = pop, n = 5) |&gt; </span></span>
<span id="cb4-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(iso3c) |&gt; </span></span>
<span id="cb4-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   unique()</span></span>
<span id="cb4-38"></span>
<span id="cb4-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define desired continent order (bottom-left to top-right)</span></span>
<span id="cb4-40">continent_order <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Africa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Americas"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oceania"</span>)</span>
<span id="cb4-41"></span>
<span id="cb4-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Range of Font Sizes for Country Name and Flag Size in graphic</span></span>
<span id="cb4-43">cfs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb4-44">ffs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb4-45"></span>
<span id="cb4-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Actual data processing and wrangling</span></span>
<span id="cb4-47">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-49"> </span>
<span id="cb4-50">  </span>
<span id="cb4-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent_pop =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(continent, continent_pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.desc =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-56">  </span>
<span id="cb4-57">  </span>
<span id="cb4-58">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now process data to produce coordinates using {treemapify}</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">split</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> {</span>
<span id="cb4-61">    layout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> treemapify<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">treemapify</span>(</span>
<span id="cb4-62">      .x,</span>
<span id="cb4-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">area =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop"</span>,</span>
<span id="cb4-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subgroup =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"continent"</span></span>
<span id="cb4-65">    )</span>
<span id="cb4-66">  }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb4-68">    df1</span>
<span id="cb4-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-70">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Further final improvements in the plot - minor adjustments of text and flag sizes, locations</span></span>
<span id="cb4-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_fs =</span> cfs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (cfs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> cfs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]),</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flag_fs =</span> ffs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (pop <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(pop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (ffs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ffs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb4-77"></span>
<span id="cb4-78">plotdf_grouped <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-79">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-80">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb4-81">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(xmin),</span>
<span id="cb4-82">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(xmax),</span>
<span id="cb4-83">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(ymin),</span>
<span id="cb4-84">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(ymax),</span>
<span id="cb4-85">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb4-86">      )</span>
<span id="cb4-87"></span>
<span id="cb4-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check the ranges</span></span>
<span id="cb4-89"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(plotdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>country_fs)</span>
<span id="cb4-90"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(plotdf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>flag_fs)</span></code></pre></div>
</details>
</div>
<p>The base plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb5-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">area =</span> pop,</span>
<span id="cb5-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> tfr</span>
<span id="cb5-6">    )</span>
<span id="cb5-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-8"></span>
<span id="cb5-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace geom_treemap() with geom_rect():</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb5-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> xmin,</span>
<span id="cb5-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax,</span>
<span id="cb5-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> ymin,</span>
<span id="cb5-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> ymax,</span>
<span id="cb5-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> tfr</span>
<span id="cb5-17">    ),</span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb5-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col,</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb5-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23"></span>
<span id="cb5-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace geom_treemap_subgroup_border() with geom_rect():</span></span>
<span id="cb5-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb5-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf_grouped,</span>
<span id="cb5-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> xmin,</span>
<span id="cb5-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax,</span>
<span id="cb5-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> ymin,</span>
<span id="cb5-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> ymax</span>
<span id="cb5-32">    ),</span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col,</span>
<span id="cb5-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb5-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb5-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-38">  </span>
<span id="cb5-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add Text Labels of the countries above a specific size</span></span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country_fs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb5-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (xmin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xmax)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb5-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ymin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (ymax <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ymin)),</span>
<span id="cb5-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> country,</span>
<span id="cb5-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> country_fs</span>
<span id="cb5-47">    ),</span>
<span id="cb5-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb5-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-54">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb5-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country_fs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb5-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (xmin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xmax)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb5-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> (ymin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ymax)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb5-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> flag_fs,</span>
<span id="cb5-60">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> iso2c</span>
<span id="cb5-61">    ),</span>
<span id="cb5-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_size_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-66"></span>
<span id="cb5-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_treemap_subgroup_text</span>(</span>
<span id="cb5-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">area =</span> pop,</span>
<span id="cb5-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> tfr,</span>
<span id="cb5-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subgroup =</span> continent,</span>
<span id="cb5-72">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> continent</span>
<span id="cb5-73">    ),</span>
<span id="cb5-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">place =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"centre"</span>,</span>
<span id="cb5-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-79">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-80">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb5-81">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Geyser"</span>,</span>
<span id="cb5-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.7</span>),</span>
<span id="cb5-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rescale</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.7</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb5-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb5-87">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-88">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb5-89">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>year,</span>
<span id="cb5-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-91">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(</span>
<span id="cb5-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb5-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb5-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb5-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb5-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Fertility Rate (avg. children / woman)"</span>,</span>
<span id="cb5-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-104">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>(</span>
<span id="cb5-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb5-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inside"</span>,</span>
<span id="cb5-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position.inside =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification.inside =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb5-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb5-122">    ),</span>
<span id="cb5-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb5-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb5-127">    ),</span>
<span id="cb5-128">    </span>
<span id="cb5-129">    </span>
<span id="cb5-130">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb5-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-135">    ),</span>
<span id="cb5-136">    </span>
<span id="cb5-137">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip Labels</span></span>
<span id="cb5-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb5-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb5-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb5-143">    ),</span>
<span id="cb5-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb5-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb5-149">    ),</span>
<span id="cb5-150">    </span>
<span id="cb5-151">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb5-152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb5-161">    ),</span>
<span id="cb5-162">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-170">    ),</span>
<span id="cb5-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb5-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-176">    ),</span>
<span id="cb5-177">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-178">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-179">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-180">  )</span></code></pre></div>
</details>
</div>
<p>Adding annotations to the plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A QR Code for the infographic</span></span>
<span id="cb6-2">url_graphics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb6-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://aditya-dahiya.github.io/projects_presentations/data_vizs/"</span>,</span>
<span id="cb6-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The file name of the current .qmd file</span></span>
<span id="cb6-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb_tfr_pop_treemap"</span>,         </span>
<span id="cb6-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".html"</span></span>
<span id="cb6-7">)</span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github('coolbutuseless/ggqr')</span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggqr)</span></span>
<span id="cb6-10">plot_qr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb6-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> url_graphics)</span>
<span id="cb6-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-14">  ggqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qr</span>(</span>
<span id="cb6-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb6-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb6-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb6-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb6-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.045</span>,</span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scan for complete</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Code used to make</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">this graphic"</span>,</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb6-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb6-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb6-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb6-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb6-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb6-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb6-38">    ),</span>
<span id="cb6-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb6-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb6-42">    ),</span>
<span id="cb6-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb6-44">  )</span>
<span id="cb6-45"></span>
<span id="cb6-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling the plots</span></span>
<span id="cb6-47"></span>
<span id="cb6-48">g_full <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inset_element</span>(</span>
<span id="cb6-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> plot_qr,</span>
<span id="cb6-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.12</span>,</span>
<span id="cb6-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.09</span>,</span>
<span id="cb6-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>,</span>
<span id="cb6-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb6-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb6-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb6-60">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb6-61">      )</span>
<span id="cb6-62">    )</span>
<span id="cb6-63">  )</span>
<span id="cb6-64"></span>
<span id="cb6-65"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb6-66">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-67">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-68">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_wb_tfr_pop_treemap.png"</span></span>
<span id="cb6-69">  ),</span>
<span id="cb6-70">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g_full,</span>
<span id="cb6-71">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">297</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-72">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">210</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-73">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb6-74">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb6-75">)</span></code></pre></div>
</details>
</div>
<p>Savings the graphics</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_wb_tfr_pop_treemap.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb7-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb7-6">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb_tfr_pop_treemap.png"</span>))</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb8-2">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb8-3">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb8-4">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb8-5">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb8-6">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb8-7">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb8-8">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb8-9">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb8-10">  wbstats       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># World Bank data access</span></span>
<span id="cb8-11">)</span>
<span id="cb8-12">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-14">  </span>
<span id="cb8-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The attached column is TRUE for packages that were </span></span>
<span id="cb8-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># explicitly loaded with library()</span></span>
<span id="cb8-17">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(attached <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb8-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb8-20">    date, source</span>
<span id="cb8-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-22">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-23">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb8-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb8-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-26">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb8-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-30">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="eqitkvzjwk" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#eqitkvzjwk table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eqitkvzjwk thead, #eqitkvzjwk tbody, #eqitkvzjwk tfoot, #eqitkvzjwk tr, #eqitkvzjwk td, #eqitkvzjwk th {
  border-style: none;
}

#eqitkvzjwk p {
  margin: 0;
  padding: 0;
}

#eqitkvzjwk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eqitkvzjwk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eqitkvzjwk .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eqitkvzjwk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eqitkvzjwk .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eqitkvzjwk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eqitkvzjwk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eqitkvzjwk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eqitkvzjwk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eqitkvzjwk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eqitkvzjwk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eqitkvzjwk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eqitkvzjwk .gt_spanner_row {
  border-bottom-style: hidden;
}

#eqitkvzjwk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eqitkvzjwk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eqitkvzjwk .gt_from_md > :first-child {
  margin-top: 0;
}

#eqitkvzjwk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eqitkvzjwk .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eqitkvzjwk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eqitkvzjwk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eqitkvzjwk .gt_row_group_first td {
  border-top-width: 2px;
}

#eqitkvzjwk .gt_row_group_first th {
  border-top-width: 2px;
}

#eqitkvzjwk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqitkvzjwk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eqitkvzjwk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eqitkvzjwk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eqitkvzjwk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqitkvzjwk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eqitkvzjwk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eqitkvzjwk .gt_striped {
  background-color: #FAFAFA;
}

#eqitkvzjwk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eqitkvzjwk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eqitkvzjwk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqitkvzjwk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eqitkvzjwk .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eqitkvzjwk .gt_left {
  text-align: left;
}

#eqitkvzjwk .gt_center {
  text-align: center;
}

#eqitkvzjwk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eqitkvzjwk .gt_font_normal {
  font-weight: normal;
}

#eqitkvzjwk .gt_font_bold {
  font-weight: bold;
}

#eqitkvzjwk .gt_font_italic {
  font-style: italic;
}

#eqitkvzjwk .gt_super {
  font-size: 65%;
}

#eqitkvzjwk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eqitkvzjwk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eqitkvzjwk .gt_indent_1 {
  text-indent: 5px;
}

#eqitkvzjwk .gt_indent_2 {
  text-indent: 10px;
}

#eqitkvzjwk .gt_indent_3 {
  text-indent: 15px;
}

#eqitkvzjwk .gt_indent_4 {
  text-indent: 20px;
}

#eqitkvzjwk .gt_indent_5 {
  text-indent: 25px;
}

#eqitkvzjwk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eqitkvzjwk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="eqitkvzjwk" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="eqitkvzjwk">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["colorspace","dplyr","fontawesome","forcats","ggplot2","ggtext","lubridate","magick","patchwork","purrr","readr","scales","showtext","showtextdb","stringr","sysfonts","tibble","tidyr","tidyverse","wbstats"],"Version":["2.1-1","1.1.4","0.5.3","1.0.0","4.0.0","0.1.2","1.9.4","2.8.6","1.3.0","1.0.4","2.1.5","1.4.0","0.9-7","3.0","1.5.1","0.8.9","3.2.1","1.3.1","2.0.0","1.1"],"Date":["2024-07-26","2023-11-17","2024-11-16","2023-01-29","2025-09-11","2022-09-16","2024-12-08","2025-03-23","2024-09-16","2025-02-05","2024-01-10","2025-04-24","2024-03-02","2020-06-04","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2023-02-22","2025-09-14"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"eqitkvzjwk","dataKey":"68f7489cc020bf6a919ce5c3ed9ee5f6"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>

 ]]></description>
  <category>World Bank Data</category>
  <category>A4 Size Viz</category>
  <category>Governance</category>
  <category>Demographics</category>
  <category>Public Health</category>
  <category>{treemapify}</category>
  <category>{ggflags}</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/wb_tfr_pop_treemap.html</guid>
  <pubDate>Fri, 31 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/wb_tfr_pop_treemap.png" medium="image" type="image/png" height="102" width="144"/>
</item>
<item>
  <title>The Global Fertility Transition: By Continents</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/wb_tfr_pop_tree.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level3">
<h3 class="anchored" data-anchor-id="about-the-data"><strong>About the Data</strong></h3>
<p>Total Fertility Rate (TFR) represents the average number of children a woman would bear during her lifetime based on current age-specific fertility rates. A TFR of 2.1 is considered ‘replacement level’ in developed countries—the rate needed to maintain population stability without immigration, accounting for mortality. The 0.1 above two children compensates for infant and childhood deaths. This analysis uses <a href="https://databank.worldbank.org">World Bank DataBank</a> indicators SP.DYN.TFRT.IN for TFR and SP.POP.TOTL for population, spanning 1960-2024. Data was accessed using the <a href="https://github.com/gshs-ornl/wbstats"><code>wbstats</code></a> R package.</p>
<p>Continental averages are calculated as population-weighted means, ensuring larger nations like China, India, Nigeria, and the United States appropriately influence regional trends.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/a4_wb_tfr_pop_tree.png" class="img-fluid figure-img"></p>
<figcaption>This graphic displays Total Fertility Rate (TFR) trends from 1960 to 2024 for 195 countries, grouped by continent. Each thin line represents one country’s fertility journey smoothed using LOESS regression (span=0.5). Bold lines show population-weighted continental averages (span=0.3). The horizontal reference line at 2.1 marks the replacement level fertility. Flags identify the ten most populous countries in 1960 and 2023, plus nations with extreme fertility rates, illustrating both demographic giants and outliers in the global fertility transition.</figcaption>
</figure>
</div>
</section>
<section id="how-i-made-this-graphic" class="level3">
<h3 class="anchored" data-anchor-id="how-i-made-this-graphic"><strong>How I made this graphic?</strong></h3>
<p>Loading required libraries, data import &amp; creating custom functions</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Import and Wrangling Tools</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb1-4">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb1-7">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb1-9">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb1-10">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb1-11">  wbstats       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># World Bank data access</span></span>
<span id="cb1-12">)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators &lt;- wbstats::wb_indicators()</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator, "fertility")) |&gt; </span></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(indicator_desc) |&gt; </span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull() |&gt; </span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   str_wrap(80) |&gt; </span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   str_view()</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt; </span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator_id, "SP.DYN.TFRT.IN")) </span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   </span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt; </span></span>
<span id="cb1-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   mutate(indicator = str_to_lower(indicator)) |&gt; </span></span>
<span id="cb1-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator, "total population")) |&gt; </span></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   View()</span></span>
<span id="cb1-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator, "Total population"))</span></span>
<span id="cb1-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb1-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># indicators |&gt;</span></span>
<span id="cb1-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(str_detect(indicator_id, "SP.POP.TOTL"))</span></span>
<span id="cb1-36"></span>
<span id="cb1-37">selected_indicators <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-38">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.DYN.TFRT.IN"</span>,</span>
<span id="cb1-39">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SP.POP.TOTL"</span></span>
<span id="cb1-40">)</span>
<span id="cb1-41"></span>
<span id="cb1-42">rawdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wb_data</span>(</span>
<span id="cb1-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">indicator =</span> selected_indicators,</span>
<span id="cb1-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start_date =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1900</span>,</span>
<span id="cb1-45">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end_date =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span></span>
<span id="cb1-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb1-47">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</details>
</div>
<p>Exploratory Data Analysis &amp; Data Wrangling</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rawdf |&gt; </span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(date) |&gt; </span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   unique()</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A Dataset for countries</span></span>
<span id="cb2-7">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rawdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_detect</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hong Kong|Macao"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter(</span></span>
<span id="cb2-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   date %in% c(seq(1960, 2024, 5), 2024)</span></span>
<span id="cb2-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ) |&gt; </span></span>
<span id="cb2-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb2-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> date,</span>
<span id="cb2-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tfr =</span> sp_dyn_tfrt_in,</span>
<span id="cb2-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop =</span> sp_pop_totl</span>
<span id="cb2-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso2c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(iso2c)</span>
<span id="cb2-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb2-22">      iso3c,</span>
<span id="cb2-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span>,</span>
<span id="cb2-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"continent"</span>,</span>
<span id="cb2-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">warn =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb2-26">    )</span>
<span id="cb2-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(continent))</span>
<span id="cb2-29"></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A Dataset for continents</span></span>
<span id="cb2-31">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year, continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb2-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tfr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weighted.mean</span>(</span>
<span id="cb2-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> tfr,</span>
<span id="cb2-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">w =</span> pop,</span>
<span id="cb2-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm  =</span> T</span>
<span id="cb2-38">    )</span>
<span id="cb2-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(continent) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tfr_smooth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(</span>
<span id="cb2-44">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">loess</span>(tfr <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cur_data</span>()),</span>
<span id="cb2-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cur_data</span>()</span>
<span id="cb2-46">    )</span>
<span id="cb2-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb2-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-49">  </span>
<span id="cb2-50">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add customized hjust values for adding the labels of continents at the</span></span>
<span id="cb2-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># right place for easy viewing</span></span>
<span id="cb2-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb2-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb2-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Africa"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Americas"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Asia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Oceania"</span>),</span>
<span id="cb2-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.85</span>)</span>
<span id="cb2-56">    )</span>
<span id="cb2-57">  )</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Manually select few coutnries that I want to add flags of in the graph</span></span>
<span id="cb2-60">selected_cons <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-61">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-63">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-64">  ,</span>
<span id="cb2-65">  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-66">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-68">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> pop, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-70">  ,</span>
<span id="cb2-71">  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-72">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-73">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(tfr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-74">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tfr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-75">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-76">  ,</span>
<span id="cb2-77">  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-78">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-79">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(tfr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tfr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-81">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-82">  ,</span>
<span id="cb2-83">  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-84">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-85">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(tfr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-86">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tfr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-87">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-88">  ,</span>
<span id="cb2-89">  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(tfr)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-92">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tfr, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-93">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(iso2c)</span>
<span id="cb2-94">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb2-96"></span>
<span id="cb2-97">df3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(iso2c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> selected_cons) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb2-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb2-102">      year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-103">      year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb2-105">    ),</span>
<span id="cb2-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudgex_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb2-107">      year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb2-108">      year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb2-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb2-110">    )</span>
<span id="cb2-111">  )</span></code></pre></div>
</details>
</div>
<p>Visualization Parameters</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto"</span>,</span>
<span id="cb3-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb3-4">) </span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb3-9">) </span>
<span id="cb3-10"></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb3-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roboto Condensed"</span>,</span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb3-14">) </span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb3-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb3-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb3-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb3-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb3-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb3-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb3-29"></span>
<span id="cb3-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb3-31"></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb3-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("calecopal::superbloom2")</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("fishualize::Etheostoma_spectabile")</span></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mypal &lt;- paletteer::paletteer_d("lisa::MarcChagall")</span></span>
<span id="cb3-38">mypal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lisa::KazimirMalevich"</span>)</span>
<span id="cb3-39"></span>
<span id="cb3-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb3-41">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb3-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb3-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb3-44">)</span>
<span id="cb3-45">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb3-46">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb3-47">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb3-48">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb3-49">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb3-50">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb3-51">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb3-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  World Bank's DataBank"</span>,</span>
<span id="cb3-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb3-54">  social_caption_1,</span>
<span id="cb3-55">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb3-56">  social_caption_2</span>
<span id="cb3-57">)</span>
<span id="cb3-58"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb3-59">  github, github_username, xtwitter,</span>
<span id="cb3-60">  xtwitter_username, social_caption_1,</span>
<span id="cb3-61">  social_caption_2</span>
<span id="cb3-62">)</span>
<span id="cb3-63"></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cols4all::c4a_gui()</span></span></code></pre></div>
</details>
</div>
<p>Annotation Text for the Plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Converging Destinies: How World Fertility Rates Collapsed Since 1960"</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(inset_text)</span>
<span id="cb4-4">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(</span>
<span id="cb4-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Between 1960 and 2024, global fertility rates experienced a dramatic transformation. &lt;span style='color:#436F85FF;'&gt;**Africa**&lt;/span&gt; began its decline from nearly 7 children per woman,&lt;br&gt;</span></span>
<span id="cb4-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  while &lt;span style='color:#DE7A00FF;'&gt;**Asia**&lt;/span&gt;, &lt;span style='color:#416322FF;'&gt;**Europe**&lt;/span&gt;, &lt;span style='color:#860A4DFF;'&gt;**Oceania**&lt;/span&gt; and &lt;span style='color:#432263FF;'&gt;**Americas**&lt;/span&gt; converged toward replacement level. Many countries now hover below 2.1, signaling potential population decline."</span></span>
<span id="cb4-7">)</span>
<span id="cb4-8"></span>
<span id="cb4-9">inset_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Fertility Rate (TFR) represents the average number of children a woman would bear during her lifetime based on current age-specific fertility rates. A TFR of 2.1 is considered 'replacement level'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">in developed countries—the rate needed to maintain population stability without immigration, accounting for mortality. The 0.1 above two children compensates for infant and childhood deaths.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">This analysis uses World Bank DataBank indicators (SP.DYN.TFRT.IN for TFR and SP.POP.TOTL for population) spanning 1960-2024. Continental averages are</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">calculated as population-weighted means, ensuring larger nations appropriately influence regional trends.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">The LOESS smoothing technique reduces annual</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">volatility while preserving long-term</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">patterns. Countries flagged include</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">the ten most populous in both 1960</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and 2023, plus nations with the</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">highest and lowest fertility rates</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">in those years, capturing both</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">demographic powerhouses and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extreme cases in the global</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">fertility transition."</span></span></code></pre></div>
</details>
</div>
<p>The base plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(pop)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb5-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year,</span>
<span id="cb5-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> tfr</span>
<span id="cb5-7">    )</span>
<span id="cb5-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(</span>
<span id="cb5-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> iso3c,</span>
<span id="cb5-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent</span>
<span id="cb5-13">    ),</span>
<span id="cb5-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>, </span>
<span id="cb5-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb5-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">  </span>
<span id="cb5-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add a reference line</span></span>
<span id="cb5-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_hline</span>(</span>
<span id="cb5-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yintercept =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1</span>,</span>
<span id="cb5-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb5-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-27">  </span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(</span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2,</span>
<span id="cb5-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> continent,</span>
<span id="cb5-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent</span>
<span id="cb5-33">    ),</span>
<span id="cb5-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">span =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,</span>
<span id="cb5-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb5-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-39">  geomtextpath<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_textpath</span>(</span>
<span id="cb5-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2,</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> tfr_smooth,</span>
<span id="cb5-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> continent,</span>
<span id="cb5-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> continent,</span>
<span id="cb5-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust_var,</span>
<span id="cb5-46">    ),</span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span>,</span>
<span id="cb5-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text_only =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">spacing =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb5-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb5-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust text size</span></span>
<span id="cb5-54">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-55">  </span>
<span id="cb5-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add flags using {ggflags}</span></span>
<span id="cb5-57">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(pop),</span>
<span id="cb5-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> iso2c),</span>
<span id="cb5-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb5-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-62">  </span>
<span id="cb5-63">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add Text for Country name and TFR</span></span>
<span id="cb5-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb5-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df3,</span>
<span id="cb5-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(tfr, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>),</span>
<span id="cb5-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust_var,</span>
<span id="cb5-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> nudgex_var</span>
<span id="cb5-70">    ),</span>
<span id="cb5-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb5-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb5-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb5-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-76">  </span>
<span id="cb5-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Text Annotation for Stable TFR</span></span>
<span id="cb5-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb5-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1962</span>,</span>
<span id="cb5-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.15</span>,</span>
<span id="cb5-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Replacement Level TFR          2.1 (stable population)"</span>,</span>
<span id="cb5-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position label along the line (0 to 1)</span></span>
<span id="cb5-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position label above the line</span></span>
<span id="cb5-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb5-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-89">  </span>
<span id="cb5-90">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text annotation</span></span>
<span id="cb5-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb5-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>,</span>
<span id="cb5-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.4</span>,</span>
<span id="cb5-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> inset_text,</span>
<span id="cb5-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb5-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-102">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-103">  </span>
<span id="cb5-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb5-105">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># values = paletteer::paletteer_d("ltc::kiss"),</span></span>
<span id="cb5-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PrettyCols::Dark"</span>)</span>
<span id="cb5-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb5-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.03</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>)),</span>
<span id="cb5-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1960</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2020</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-111">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb5-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-115">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb5-118">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-119">  </span>
<span id="cb5-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb5-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb5-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb5-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Fertility Rate"</span></span>
<span id="cb5-128">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb5-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb5-132">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb5-135">    </span>
<span id="cb5-136">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb5-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-141">    ),</span>
<span id="cb5-142">    </span>
<span id="cb5-143">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb5-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb5-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb5-146">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb5-149">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-150">      )</span>
<span id="cb5-151">    ),</span>
<span id="cb5-152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb5-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-155">    ),</span>
<span id="cb5-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb5-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-159">    ),</span>
<span id="cb5-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-163">    ),</span>
<span id="cb5-164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb5-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-168">    ),</span>
<span id="cb5-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-172">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb5-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longdash"</span>,</span>
<span id="cb5-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-176">    ),</span>
<span id="cb5-177">    </span>
<span id="cb5-178">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip Labels</span></span>
<span id="cb5-179">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-180">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb5-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb5-182">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-183">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb5-184">    ),</span>
<span id="cb5-185">    </span>
<span id="cb5-186">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb5-187">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-188">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-189">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-190">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-191">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-192">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-193">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-194">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-195">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb5-196">    ),</span>
<span id="cb5-197">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb5-198">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-199">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-200">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-201">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-202">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-203">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-204">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-205">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb5-206">    ),</span>
<span id="cb5-207">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb5-208">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-209">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-210">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-211">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-212">    ),</span>
<span id="cb5-213">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-214">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-215">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-216">  )</span></code></pre></div>
</details>
</div>
<p>Adding annotations to the plot</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A QR Code for the infographic</span></span>
<span id="cb6-2">url_graphics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb6-3">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://aditya-dahiya.github.io/projects_presentations/data_vizs/"</span>,</span>
<span id="cb6-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The file name of the current .qmd file</span></span>
<span id="cb6-5">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb_tfr_pop_tree"</span>,         </span>
<span id="cb6-6">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".html"</span></span>
<span id="cb6-7">)</span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remotes::install_github('coolbutuseless/ggqr')</span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggqr)</span></span>
<span id="cb6-10">plot_qr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb6-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> url_graphics)</span>
<span id="cb6-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-14">  ggqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_qr</span>(</span>
<span id="cb6-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb6-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb6-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb6-18">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb6-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.075</span>,</span>
<span id="cb6-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scan for complete</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Code used to make</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">this graphic"</span>,</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb6-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb6-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb6-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb6-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,</span>
<span id="cb6-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb6-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_fixed</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, </span>
<span id="cb6-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb6-38">    ),</span>
<span id="cb6-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb6-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb6-42">    ),</span>
<span id="cb6-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb6-44">  )</span>
<span id="cb6-45"></span>
<span id="cb6-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compiling the plots</span></span>
<span id="cb6-47"></span>
<span id="cb6-48">g_full <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> g <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inset_element</span>(</span>
<span id="cb6-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> plot_qr,</span>
<span id="cb6-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,</span>
<span id="cb6-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.04</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb6-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"panel"</span>,</span>
<span id="cb6-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb6-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(</span>
<span id="cb6-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theme =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb6-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb6-59">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb6-60">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb6-61">      )</span>
<span id="cb6-62">    )</span>
<span id="cb6-63">  )</span>
<span id="cb6-64"></span>
<span id="cb6-65"></span>
<span id="cb6-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb6-67">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-68">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-69">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_wb_tfr_pop_tree.png"</span></span>
<span id="cb6-70">  ),</span>
<span id="cb6-71">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g_full,</span>
<span id="cb6-72">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">297</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-73">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">210</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-74">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb6-75">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb6-76">)</span></code></pre></div>
</details>
</div>
<p>Savings the graphics</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a4_wb_tfr_pop_tree.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb7-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb7-6">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb_tfr_pop_tree.png"</span>))</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb8-2">  tidyverse,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data Wrangling and Plotting</span></span>
<span id="cb8-3">  scales,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice scales for ggplot2</span></span>
<span id="cb8-4">  fontawesome,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb8-5">  ggtext,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support ggplot2</span></span>
<span id="cb8-6">  showtext,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb8-7">  colorspace,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and darken colours</span></span>
<span id="cb8-8">  patchwork,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Combining plots together</span></span>
<span id="cb8-9">  magick,       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Image processing and editing</span></span>
<span id="cb8-10">  wbstats       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># World Bank data access</span></span>
<span id="cb8-11">)</span>
<span id="cb8-12">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-14">  </span>
<span id="cb8-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The attached column is TRUE for packages that were </span></span>
<span id="cb8-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># explicitly loaded with library()</span></span>
<span id="cb8-17">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(attached <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb8-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb8-20">    date, source</span>
<span id="cb8-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-22">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-23">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb8-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb8-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-26">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-27">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb8-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb8-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb8-30">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="rnmhsshunn" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#rnmhsshunn table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rnmhsshunn thead, #rnmhsshunn tbody, #rnmhsshunn tfoot, #rnmhsshunn tr, #rnmhsshunn td, #rnmhsshunn th {
  border-style: none;
}

#rnmhsshunn p {
  margin: 0;
  padding: 0;
}

#rnmhsshunn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rnmhsshunn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rnmhsshunn .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rnmhsshunn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rnmhsshunn .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnmhsshunn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnmhsshunn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rnmhsshunn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rnmhsshunn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rnmhsshunn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rnmhsshunn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rnmhsshunn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rnmhsshunn .gt_spanner_row {
  border-bottom-style: hidden;
}

#rnmhsshunn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rnmhsshunn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rnmhsshunn .gt_from_md > :first-child {
  margin-top: 0;
}

#rnmhsshunn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rnmhsshunn .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rnmhsshunn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rnmhsshunn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rnmhsshunn .gt_row_group_first td {
  border-top-width: 2px;
}

#rnmhsshunn .gt_row_group_first th {
  border-top-width: 2px;
}

#rnmhsshunn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnmhsshunn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rnmhsshunn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rnmhsshunn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnmhsshunn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnmhsshunn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rnmhsshunn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rnmhsshunn .gt_striped {
  background-color: #FAFAFA;
}

#rnmhsshunn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rnmhsshunn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnmhsshunn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnmhsshunn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rnmhsshunn .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rnmhsshunn .gt_left {
  text-align: left;
}

#rnmhsshunn .gt_center {
  text-align: center;
}

#rnmhsshunn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rnmhsshunn .gt_font_normal {
  font-weight: normal;
}

#rnmhsshunn .gt_font_bold {
  font-weight: bold;
}

#rnmhsshunn .gt_font_italic {
  font-style: italic;
}

#rnmhsshunn .gt_super {
  font-size: 65%;
}

#rnmhsshunn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rnmhsshunn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rnmhsshunn .gt_indent_1 {
  text-indent: 5px;
}

#rnmhsshunn .gt_indent_2 {
  text-indent: 10px;
}

#rnmhsshunn .gt_indent_3 {
  text-indent: 15px;
}

#rnmhsshunn .gt_indent_4 {
  text-indent: 20px;
}

#rnmhsshunn .gt_indent_5 {
  text-indent: 25px;
}

#rnmhsshunn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rnmhsshunn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="rnmhsshunn" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="rnmhsshunn">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["colorspace","dplyr","fontawesome","forcats","ggplot2","ggtext","lubridate","magick","patchwork","purrr","readr","scales","showtext","showtextdb","stringr","sysfonts","tibble","tidyr","tidyverse","wbstats"],"Version":["2.1-1","1.1.4","0.5.3","1.0.0","4.0.0","0.1.2","1.9.4","2.8.6","1.3.0","1.0.4","2.1.5","1.4.0","0.9-7","3.0","1.5.1","0.8.9","3.2.1","1.3.1","2.0.0","1.1"],"Date":["2024-07-26","2023-11-17","2024-11-16","2023-01-29","2025-09-11","2022-09-16","2024-12-08","2025-03-23","2024-09-16","2025-02-05","2024-01-10","2025-04-24","2024-03-02","2020-06-04","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2023-02-22","2025-09-14"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"rnmhsshunn","dataKey":"1fabea6498e2515fd7fb5836990b18fa"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>

 ]]></description>
  <category>World Bank Data</category>
  <category>A4 Size Viz</category>
  <category>Governance</category>
  <category>Demographics</category>
  <category>Public Health</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/wb_tfr_pop_tree.html</guid>
  <pubDate>Sat, 25 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/wb_tfr_pop_tree.png" medium="image" type="image/png" height="102" width="144"/>
</item>
<item>
  <title>Who Wins British Literary Prizes? A Diversity Analysis</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_british_literary_prizes.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset explores the <a href="https://data.post45.org/posts/british-literary-prizes/">Selected British Literary Prizes (1990-2022)</a> compiled by the <a href="https://data.post45.org/posts/british-literary-prizes/">Post45 Data Collective</a>, examining patterns of diversity and representation in British literary prize culture. The data includes comprehensive information on prize winners and shortlisted authors across multiple categories, including gender, sexuality, UK residency status, ethnicity, and educational background with details about degree institutions and fields of study. The dataset enables exploration of questions around which genres see greater representation of women, Black, Asian, and ethnically diverse writers, whether prizes have improved their diversity records over time, and connections between educational credentials and literary recognition. As the authors note, all information is publicly available, though they emphasize the data is intended for studying broad patterns rather than making definitive claims about individuals. <a href="https://data.post45.org/posts/british-literary-prizes/">Additional metadata discussion</a> provides deeper context on the ethnicity, gender, sexuality, and educational classification variables. The dataset was curated by <a href="https://github.com/jenrichmond">Jen Richmond</a> for <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a>, following a <a href="https://github.com/rfordatascience/tidytuesday/issues/893">suggestion by @gkaramanis</a>, and is accessible through <a href="https://r4ds.hadley.nz/">R</a>, <a href="https://github.com/posit-dev/python-tidytuesday-challenge">Python</a>, and <a href="https://github.com/TidierOrg/TidierTuesday.jl">Julia</a> workflows.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_british_literary_prizes.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Proportional streamgraph showing ethnic diversity trends in British literary prizes across three decades. Each colored stream represents an ethnic group’s share of prize recipients by year, with the top panel showing winners and bottom panel showing other shortlisted persons. The x-axis spans 1990-2022, while the y-axis represents percentage composition (0-100%). Notable findings include decreasing White British dominance and increasing representation of Caribbean, Non-White American, Asian, and other ethnic minority authors, especially post-2015.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<p>This visualization was created using <a href="https://www.r-project.org/">R</a> and the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem for data manipulation and plotting. The graphic employs <a href="https://github.com/davidsjoberg/ggstream">ggstream::geom_stream()</a> to create proportional streamgraphs that elegantly show the changing ethnic composition of British literary prize winners and shortlisted authors over time, with <a href="https://github.com/davidsjoberg/ggstream">ggstream::geom_stream_label()</a> adding labels directly onto the flowing streams. Color palettes were sourced from <a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a> using the “flat_dark” theme from <a href="https://github.com/Mikata-Project/ggthemr">ggthemr</a>, with colors further enhanced using <a href="https://colorspace.r-forge.r-project.org/">colorspace::darken()</a> for better label contrast. Typography was handled through <a href="https://github.com/yixuan/showtext">showtext</a> to incorporate Google Fonts (Saira family), while <a href="https://wilkelab.org/ggtext/">ggtext</a> enabled markdown formatting in plot text elements. The <a href="https://scales.r-lib.org/">scales</a> package provided clean percentage formatting for the y-axis, and <a href="https://patchwork.data-imaginist.com/">patchwork</a> was loaded for potential plot composition. Faceting with custom labels separated winners from other shortlisted individuals, creating a compelling visual narrative of diversity trends in British literary prizes from 1990 to 2022.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13">prizes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-10-28/prizes.csv'</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Jen Richmond, Post45 Data Collective"</span>,</span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-49">  social_caption_1,</span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">)</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-54">  github, github_username, xtwitter,</span>
<span id="cb2-55">  xtwitter_username, social_caption_1,</span>
<span id="cb2-56">  social_caption_2</span>
<span id="cb2-57">)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-60">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ethnic Representation in British Literary Awards"</span></span>
<span id="cb2-61"></span>
<span id="cb2-62">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"While &lt;span style='color:#97A3A6;'&gt;**White British**&lt;/span&gt; authors dominated prize winners in the 1990s and 2000s,&lt;br&gt;ethnic diversity has surged since 2015, with &lt;span style='color:#F39C12;'&gt;**Caribbean**&lt;/span&gt;, &lt;span style='color:#E67E22;'&gt;**Non-White American**&lt;/span&gt;,&lt;br&gt;&lt;span style='color:#16A085;'&gt;**Asian**&lt;/span&gt;, &lt;span style='color:#E74C3C;'&gt;**Jewish**&lt;/span&gt;, and &lt;span style='color:#9B59B6;'&gt;**Black British**&lt;/span&gt; representation reaching historic highs by 2022."</span></span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prizes |&gt;</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt;</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initial Idea</span></span>
<span id="cb3-10">prizes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter(person_role == "winner") |&gt; </span></span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(person_role, prize_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ethnicity_macro) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb3-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> prize_year, </span>
<span id="cb3-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n, </span>
<span id="cb3-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> ethnicity_macro</span>
<span id="cb3-19">    )</span>
<span id="cb3-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-21">  ggchicklet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_chicklet</span>(</span>
<span id="cb3-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_fill</span>()</span>
<span id="cb3-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>person_role, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ordering the ethnicity, and facets</span></span>
<span id="cb3-27">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> prizes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(person_role, prize_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ethnicity_macro) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ethnicity_macro =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(</span>
<span id="cb3-32">      ethnicity_macro,</span>
<span id="cb3-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> prizes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-34">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(ethnicity_macro, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-35">                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(ethnicity_macro)</span>
<span id="cb3-36">    ),</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person_role =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(</span>
<span id="cb3-38">      person_role,</span>
<span id="cb3-39">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"winner"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shortlisted"</span>)</span>
<span id="cb3-40">    )</span>
<span id="cb3-41">  )</span>
<span id="cb3-42"></span>
<span id="cb3-43">facet_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Shortlisted persons"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Winners"</span>)</span>
<span id="cb3-44"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(facet_labels) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>person_role)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> prize_year, </span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> n, </span>
<span id="cb4-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> ethnicity_macro</span>
<span id="cb4-7">    )</span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  ggstream<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_stream</span>(</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportional"</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bw =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16">  ggstream<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_stream_label</span>(</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> ethnicity_macro,</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> ethnicity_macro</span>
<span id="cb4-20">    ),</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"proportional"</span>,</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inward"</span>,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bw =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb4-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-29">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>person_role, </span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labeller</span>(</span>
<span id="cb4-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">person_role =</span> facet_labels</span>
<span id="cb4-33">    )</span>
<span id="cb4-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemr::flat_dark"</span>)</span>
<span id="cb4-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> colorspace<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">darken</span>(</span>
<span id="cb4-40">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggthemr::flat_dark"</span>)), </span>
<span id="cb4-41">      <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-42">    )</span>
<span id="cb4-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1991</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb4-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(),</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb4-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb4-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-71">    </span>
<span id="cb4-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-74">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-77">    ),</span>
<span id="cb4-78">    </span>
<span id="cb4-79">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-83">    ),</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x.bottom =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-88">    ),</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.y.left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longdash"</span>,</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-97">    ),</span>
<span id="cb4-98">    </span>
<span id="cb4-99">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip Labels</span></span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-105">    ),</span>
<span id="cb4-106">    </span>
<span id="cb4-107">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-115">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb4-117">    ),</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb4-127">    ),</span>
<span id="cb4-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-133">    ),</span>
<span id="cb4-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-137">  )</span>
<span id="cb4-138"></span>
<span id="cb4-139"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-140">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-141">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-142">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_british_literary_prizes.png"</span></span>
<span id="cb4-143">  ),</span>
<span id="cb4-144">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-145">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-146">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-147">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-149">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_british_literary_prizes.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_british_literary_prizes.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The attached column is TRUE for packages that were </span></span>
<span id="cb6-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># explicitly loaded with library()</span></span>
<span id="cb6-6">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(attached <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-9">    date, source</span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-16">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-19">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="apaiemkoux" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#apaiemkoux table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#apaiemkoux thead, #apaiemkoux tbody, #apaiemkoux tfoot, #apaiemkoux tr, #apaiemkoux td, #apaiemkoux th {
  border-style: none;
}

#apaiemkoux p {
  margin: 0;
  padding: 0;
}

#apaiemkoux .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#apaiemkoux .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#apaiemkoux .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#apaiemkoux .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#apaiemkoux .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apaiemkoux .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apaiemkoux .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apaiemkoux .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#apaiemkoux .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#apaiemkoux .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#apaiemkoux .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#apaiemkoux .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#apaiemkoux .gt_spanner_row {
  border-bottom-style: hidden;
}

#apaiemkoux .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#apaiemkoux .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#apaiemkoux .gt_from_md > :first-child {
  margin-top: 0;
}

#apaiemkoux .gt_from_md > :last-child {
  margin-bottom: 0;
}

#apaiemkoux .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#apaiemkoux .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#apaiemkoux .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#apaiemkoux .gt_row_group_first td {
  border-top-width: 2px;
}

#apaiemkoux .gt_row_group_first th {
  border-top-width: 2px;
}

#apaiemkoux .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apaiemkoux .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#apaiemkoux .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#apaiemkoux .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apaiemkoux .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apaiemkoux .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#apaiemkoux .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#apaiemkoux .gt_striped {
  background-color: #FAFAFA;
}

#apaiemkoux .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apaiemkoux .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apaiemkoux .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apaiemkoux .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apaiemkoux .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apaiemkoux .gt_left {
  text-align: left;
}

#apaiemkoux .gt_center {
  text-align: center;
}

#apaiemkoux .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#apaiemkoux .gt_font_normal {
  font-weight: normal;
}

#apaiemkoux .gt_font_bold {
  font-weight: bold;
}

#apaiemkoux .gt_font_italic {
  font-style: italic;
}

#apaiemkoux .gt_super {
  font-size: 65%;
}

#apaiemkoux .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#apaiemkoux .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#apaiemkoux .gt_indent_1 {
  text-indent: 5px;
}

#apaiemkoux .gt_indent_2 {
  text-indent: 10px;
}

#apaiemkoux .gt_indent_3 {
  text-indent: 15px;
}

#apaiemkoux .gt_indent_4 {
  text-indent: 20px;
}

#apaiemkoux .gt_indent_5 {
  text-indent: 25px;
}

#apaiemkoux .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#apaiemkoux div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="apaiemkoux" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="apaiemkoux">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["colorspace","dplyr","fontawesome","forcats","ggplot2","ggtext","lubridate","patchwork","purrr","readr","scales","showtext","showtextdb","stringr","sysfonts","tibble","tidyr","tidyverse"],"Version":["2.1-1","1.1.4","0.5.3","1.0.0","4.0.0","0.1.2","1.9.4","1.3.0","1.0.4","2.1.5","1.4.0","0.9-7","3.0","1.5.1","0.8.9","3.2.1","1.3.1","2.0.0"],"Date":["2024-07-26","2023-11-17","2024-11-16","2023-01-29","2025-09-11","2022-09-16","2024-12-08","2024-09-16","2025-02-05","2024-01-10","2025-04-24","2024-03-02","2020-06-04","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2023-02-22"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"apaiemkoux","dataKey":"81c0e94d69e290c4ed69309f77a2acf5"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://data.post45.org/posts/british-literary-prizes/">Selected British Literary Prizes (1990-2022)</a></li>
<li><a href="https://data.post45.org/posts/british-literary-prizes/">Post45 Data Collective</a></li>
<li><a href="https://data.post45.org/posts/british-literary-prizes/">Additional metadata discussion</a></li>
<li><a href="https://github.com/jenrichmond">Jen Richmond</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday/issues/893">suggestion by @gkaramanis</a></li>
<li><a href="https://r4ds.hadley.nz/">R</a></li>
<li><a href="https://github.com/posit-dev/python-tidytuesday-challenge">Python</a></li>
<li><a href="https://github.com/TidierOrg/TidierTuesday.jl">Julia</a></li>
<li><a href="https://www.r-project.org/">R</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://github.com/davidsjoberg/ggstream">ggstream::geom_stream()</a></li>
<li><a href="https://github.com/davidsjoberg/ggstream">ggstream::geom_stream_label()</a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a></li>
<li><a href="https://github.com/Mikata-Project/ggthemr">ggthemr</a></li>
<li><a href="https://colorspace.r-forge.r-project.org/">colorspace::darken()</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
<li><a href="https://scales.r-lib.org/">scales</a></li>
<li><a href="https://patchwork.data-imaginist.com/">patchwork</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>{ggstream}</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_british_literary_prizes.html</guid>
  <pubDate>Fri, 24 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_british_literary_prizes.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>UK Weather Extremes: A Century of Records</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_uk_meteorological_data.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset features historic meteorological data from 37 weather stations across the United Kingdom, curated from the <a href="https://www.metoffice.gov.uk/">UK Met Office</a>‘s <a href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data">historic station data collection</a>. The <a href="https://www.metoffice.gov.uk/">Met Office</a>, established in 1854 as one of the world’s oldest weather services, serves as the UK’s national weather and climate authority. The dataset includes monthly measurements spanning from as early as 1853 to the present, tracking key variables such as maximum and minimum temperatures, air frost days, rainfall, and sunshine duration. Each station’s metadata provides geographic coordinates in <a href="https://epsg.io/4326">EPSG:4326 format</a> and opening dates. The data undergoes basic cleaning with estimated data flags and historical monitoring technique variations removed for simplicity, though these details remain available in the raw source data. Station files are updated monthly, approximately 10 days after month-end, with measurements reflecting the stations’ operational history without adjustments for site changes or instrumentation developments over time. This comprehensive dataset was curated by <a href="https://github.com/jack-davison">Jack Davison</a> for the <a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a> project.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_uk_meteorological_data.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Geographic distribution of UK Met Office weather stations with their record-breaking measurements. Each station marker is labeled with its most extreme climate events: maximum temperature (red), minimum temperature (blue), and highest monthly rainfall (green). Dates in parentheses indicate when these records were set. Station opening years range from 1853 to recent decades, representing one of the most comprehensive historic meteorological datasets in the world and documenting Britain’s climate variability across generations.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9">  sf, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for maps</span></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-14">  sf,</span>
<span id="cb1-15">  ggrepel,</span>
<span id="cb1-16">  ggtext,</span>
<span id="cb1-17">  grid,</span>
<span id="cb1-18">  gridtext</span>
<span id="cb1-19">)</span>
<span id="cb1-20"></span>
<span id="cb1-21">historic_station_met <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-10-21/historic_station_met.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-22">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb1-23"></span>
<span id="cb1-24">station_meta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-10-21/station_meta.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-25">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the actual colors from chosen palette</span></span>
<span id="cb2-36">day_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ghibli::PonyoDark"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb2-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(day_colors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sun"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fri"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sat"</span>)</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Jack Davison, UK Met Office"</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UK Weather Extremes:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">A Century of Records"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visualizing historic meteorological</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">data from 37 UK Met Office weather</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stations (1853-2025).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Created with</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{ggplot2}, {sf}, and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{ggtext} to map</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">extreme temperature</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and rainfall records</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">across Britain and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Ireland."</span></span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># historic_station_met |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-7"></span>
<span id="cb3-8">df_tmax <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> historic_station_met <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(station) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(</span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tmax,</span>
<span id="cb3-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">with_ties =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tmax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(tmax,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"°C"</span>),</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tmax_month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(month.abb[month], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, year),</span>
<span id="cb3-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb3-19">  )</span>
<span id="cb3-20"></span>
<span id="cb3-21">df_tmin <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> historic_station_met <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(station) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> tmin,</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">with_ties =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tmin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(tmin,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"°C"</span>),</span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tmin_month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(month.abb[month], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, year),</span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb3-32">  )</span>
<span id="cb3-33"></span>
<span id="cb3-34">df_rain <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> historic_station_met <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(station) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> rain,</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">with_ties =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rain =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(rain, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" mm"</span>),</span>
<span id="cb3-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rain_month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(month.abb[month], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, year),</span>
<span id="cb3-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.keep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb3-45">  )</span>
<span id="cb3-46"></span>
<span id="cb3-47"></span>
<span id="cb3-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make a map of Stations of UK Met</span></span>
<span id="cb3-49">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> station_meta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(df_tmax) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(df_tmin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(df_rain) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(</span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lng"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lat"</span>),</span>
<span id="cb3-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span></span>
<span id="cb3-56">  )</span>
<span id="cb3-57"></span>
<span id="cb3-58">british_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb3-61">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-63">    iso_a2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IE"</span>)</span>
<span id="cb3-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name, iso_a2, geometry)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">160</span></span>
<span id="cb4-2"></span>
<span id="cb4-3">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> british_map,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name),</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>)</span>
<span id="cb4-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb4-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">  ggtext<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;"</span>,</span>
<span id="cb4-24">        station_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-25">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb4-26">        opened, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;&lt;br&gt;"</span>,</span>
<span id="cb4-27">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#D9565CFF;'&gt;"</span>,</span>
<span id="cb4-28">        tmax, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-29">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb4-30">        tmax_month, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;"</span>,</span>
<span id="cb4-31">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;   |   &lt;/span&gt;"</span>,</span>
<span id="cb4-32">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#1BB6AFFF;'&gt;"</span>,</span>
<span id="cb4-33">        tmin, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-34">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb4-35">        tmin_month, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;&lt;br&gt;"</span>,</span>
<span id="cb4-36">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#0076C0FF;'&gt;"</span>,</span>
<span id="cb4-37">        rain, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-38">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb4-39">        rain_month, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;"</span></span>
<span id="cb4-40">      ),</span>
<span id="cb4-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry</span>
<span id="cb4-42">    ),</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span>,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb4-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.5</span>,</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">51</span>,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-55">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;"</span>,</span>
<span id="cb4-56">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Met Station"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb4-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year Opened"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;&lt;br&gt;"</span>,</span>
<span id="cb4-59">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#D9565CFF;'&gt;"</span>,</span>
<span id="cb4-60">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max. Temp Ever"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-61">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;   |   &lt;/span&gt;"</span>,</span>
<span id="cb4-62">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#1BB6AFFF;'&gt;"</span>,</span>
<span id="cb4-63">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Min. Temp Ever"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb4-64">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;"</span>,</span>
<span id="cb4-65">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#0076C0FF;'&gt;"</span>,</span>
<span id="cb4-66">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max. Recorded Rainfall"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span></span>
<span id="cb4-67">      ),</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  </span>
<span id="cb4-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add plot_title and plot_subtitle</span></span>
<span id="cb4-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.5</span>,</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">60.3</span>,</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_title,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-90">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.1</span>,</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">58.7</span>,</span>
<span id="cb4-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_subtitle,</span>
<span id="cb4-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-102">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-103"></span>
<span id="cb4-104"></span>
<span id="cb4-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:27700"</span>,</span>
<span id="cb4-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb4-111">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-121">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-125">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-128">    </span>
<span id="cb4-129">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-134">    ),</span>
<span id="cb4-135">    </span>
<span id="cb4-136">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grid Lines and Axes Text</span></span>
<span id="cb4-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_hil, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb4-141">    ),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-152">    ),</span>
<span id="cb4-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-156">  )</span>
<span id="cb4-157"></span>
<span id="cb4-158"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-159">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-160">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-161">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_uk_meteorological_data.png"</span></span>
<span id="cb4-162">  ),</span>
<span id="cb4-163">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-164">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-165">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-166">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-167">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-168">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_uk_meteorological_data2.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_uk_meteorological_data.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-5">    date, source</span>
<span id="cb6-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qksnfuryzm" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#qksnfuryzm table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qksnfuryzm thead, #qksnfuryzm tbody, #qksnfuryzm tfoot, #qksnfuryzm tr, #qksnfuryzm td, #qksnfuryzm th {
  border-style: none;
}

#qksnfuryzm p {
  margin: 0;
  padding: 0;
}

#qksnfuryzm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qksnfuryzm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qksnfuryzm .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qksnfuryzm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qksnfuryzm .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qksnfuryzm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qksnfuryzm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qksnfuryzm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qksnfuryzm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qksnfuryzm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qksnfuryzm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qksnfuryzm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qksnfuryzm .gt_spanner_row {
  border-bottom-style: hidden;
}

#qksnfuryzm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qksnfuryzm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qksnfuryzm .gt_from_md > :first-child {
  margin-top: 0;
}

#qksnfuryzm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qksnfuryzm .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qksnfuryzm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qksnfuryzm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qksnfuryzm .gt_row_group_first td {
  border-top-width: 2px;
}

#qksnfuryzm .gt_row_group_first th {
  border-top-width: 2px;
}

#qksnfuryzm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksnfuryzm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qksnfuryzm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qksnfuryzm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qksnfuryzm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksnfuryzm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qksnfuryzm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qksnfuryzm .gt_striped {
  background-color: #FAFAFA;
}

#qksnfuryzm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qksnfuryzm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qksnfuryzm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksnfuryzm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qksnfuryzm .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qksnfuryzm .gt_left {
  text-align: left;
}

#qksnfuryzm .gt_center {
  text-align: center;
}

#qksnfuryzm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qksnfuryzm .gt_font_normal {
  font-weight: normal;
}

#qksnfuryzm .gt_font_bold {
  font-weight: bold;
}

#qksnfuryzm .gt_font_italic {
  font-style: italic;
}

#qksnfuryzm .gt_super {
  font-size: 65%;
}

#qksnfuryzm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qksnfuryzm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qksnfuryzm .gt_indent_1 {
  text-indent: 5px;
}

#qksnfuryzm .gt_indent_2 {
  text-indent: 10px;
}

#qksnfuryzm .gt_indent_3 {
  text-indent: 15px;
}

#qksnfuryzm .gt_indent_4 {
  text-indent: 20px;
}

#qksnfuryzm .gt_indent_5 {
  text-indent: 25px;
}

#qksnfuryzm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qksnfuryzm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="qksnfuryzm" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="qksnfuryzm">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","KernSmooth","R6","RColorBrewer","Rcpp","S7","bit","bit64","class","classInt","cli","colorspace","crayon","curl","dichromat","digest","dplyr","e1071","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggrepel","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","pacman","paletteer","patchwork","pillar","pkgconfig","proxy","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","sf","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","units","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["1.2.3","2.23-26","2.6.1","1.1-3","1.0.14","0.2.0","4.6.0","4.6.0-1","7.3-23","0.4-11","3.6.4","2.1-1","1.5.3","6.2.2","2.0-0.1","0.6.37","1.1.4","1.7-16","1.0.5","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","4.0.0","0.9.6","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.4","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","1.6.0","1.3.0","1.11.1","2.0.3","0.4-27","1.0.4","2.1.5","2.1.2","1.1.6","2.30","0.17.1","1.4.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.8-7","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2025-01-01","2025-02-15","2022-04-03","2025-01-12","2024-11-07","2025-03-06","2025-01-16","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2022-05-02","2024-08-19","2023-11-17","2024-09-16","2025-08-27","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-09-11","2024-09-07","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2025-10-17","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2019-03-11","2024-01-21","2024-09-16","2025-09-17","2019-09-22","2022-06-09","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2025-09-28","2024-10-22","2025-04-24","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2025-03-11","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"qksnfuryzm","dataKey":"f42556072f1c7421838f49fdc5000944"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="attempt-2-add-custom-functions" class="level3">
<h3 class="anchored" data-anchor-id="attempt-2-add-custom-functions">Attempt 2: Add custom functions</h3>
<p>This code defines <code>geom_marquee_repel()</code>, a specialized ggplot2 geom that combines rich text rendering capabilities from the marquee package with intelligent label positioning from ggrepel. The implementation follows a similar architecture to <code>geom_label_repel()</code> but replaces standard text grobs with marquee’s formatted text grobs, allowing users to create plots with richly styled, non-overlapping labels that include features like bold text, colors, and other formatting options. The geom uses the same repulsion algorithm to automatically adjust label positions, preventing overlaps between labels and data points while respecting plot boundaries and user-defined constraints. <strong>Source:</strong> <a href="https://github.com/slowkow/ggrepel/tree/0bbdee8174712929f297da6f0e4170059b0a9344/R">ggrepel R directory</a> <strong>Credits:</strong> <a href="https://github.com/teunbrand">teunbrand</a></p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Name ggplot grid object</span></span>
<span id="cb7-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Convenience function to name grid objects</span></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-5">ggname <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(prefix, grob) {</span>
<span id="cb7-6">  grob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobName</span>(grob, prefix)</span>
<span id="cb7-7">  grob</span>
<span id="cb7-8">}</span>
<span id="cb7-9"></span>
<span id="cb7-10">with_seed_null <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(seed, code) {</span>
<span id="cb7-11">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(seed)) {</span>
<span id="cb7-12">    code</span>
<span id="cb7-13">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-14">    withr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with_seed</span>(seed, code)</span>
<span id="cb7-15">  }</span>
<span id="cb7-16">}</span>
<span id="cb7-17"></span>
<span id="cb7-18">.pt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">72.27</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">25.4</span></span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%||%"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(a, b) {</span>
<span id="cb7-21">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(a)) a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> b</span>
<span id="cb7-22">}</span>
<span id="cb7-23"></span>
<span id="cb7-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Return a boolean vector of non-empty items.</span></span>
<span id="cb7-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param xs Vector with a mix of "expression" items, "character" items,</span></span>
<span id="cb7-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'  and items from other classes.</span></span>
<span id="cb7-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return Boolean vector indicating which items are not empty.</span></span>
<span id="cb7-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-30">not_empty <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(xs) {</span>
<span id="cb7-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(xs), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-32">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.expression</span>(xs[i])) {</span>
<span id="cb7-33">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(xs[i])) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb7-34">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-35">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(xs[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb7-36">    }</span>
<span id="cb7-37">  })</span>
<span id="cb7-38">}</span>
<span id="cb7-39"></span>
<span id="cb7-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Return a unit version of the argument.</span></span>
<span id="cb7-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param x Number or unit object.</span></span>
<span id="cb7-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return unit(x, "lines") if number or the unchanged argument if it's already</span></span>
<span id="cb7-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'  a unit object.</span></span>
<span id="cb7-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-46">to_unit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb7-47">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># don't change arg if already unit</span></span>
<span id="cb7-48">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x)) {</span>
<span id="cb7-49">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(x)</span>
<span id="cb7-50">  }</span>
<span id="cb7-51">  </span>
<span id="cb7-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># NA used to exclude points from repulsion calculations</span></span>
<span id="cb7-53">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x)) {</span>
<span id="cb7-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb7-55">  }</span>
<span id="cb7-56">  </span>
<span id="cb7-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb7-58">}</span>
<span id="cb7-59"></span>
<span id="cb7-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Parse takes a vector of n lines and returns m expressions.</span></span>
<span id="cb7-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' See https://github.com/tidyverse/ggplot2/issues/2864 for discussion.</span></span>
<span id="cb7-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' parse(text = c("alpha", "", "gamma"))</span></span>
<span id="cb7-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' #&gt; expression(alpha, gamma)</span></span>
<span id="cb7-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' parse_safe(text = c("alpha", "", "gamma"))</span></span>
<span id="cb7-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' #&gt; expression(alpha, NA, gamma)</span></span>
<span id="cb7-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-70">parse_safe <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(text) {</span>
<span id="cb7-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(text))</span>
<span id="cb7-72">  out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"expression"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(text))</span>
<span id="cb7-73">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(text)) {</span>
<span id="cb7-74">    expr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> text[[i]])</span>
<span id="cb7-75">    out[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(expr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> expr[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb7-76">  }</span>
<span id="cb7-77">  out</span>
<span id="cb7-78">}</span>
<span id="cb7-79"></span>
<span id="cb7-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Exclude data points outside the panel ranges</span></span>
<span id="cb7-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-82">exclude_outside <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(data, panel_scales) {</span>
<span id="cb7-83">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x.range"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(panel_scales)) {</span>
<span id="cb7-84">    xr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> panel_scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x.range</span>
<span id="cb7-85">    yr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> panel_scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y.range</span>
<span id="cb7-86">    ix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inside</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, xr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inside</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, yr)</span>
<span id="cb7-87">    data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[ix,,drop<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-88">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x_range"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(panel_scales)) {</span>
<span id="cb7-89">    xr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> panel_scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x_range</span>
<span id="cb7-90">    yr <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> panel_scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y_range</span>
<span id="cb7-91">    ix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inside</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, xr) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inside</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, yr)</span>
<span id="cb7-92">    data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[ix,,drop<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-93">  }</span>
<span id="cb7-94">  data</span>
<span id="cb7-95">}</span>
<span id="cb7-96"></span>
<span id="cb7-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Exclude data points outside the panel ranges</span></span>
<span id="cb7-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-99">inside <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, bounds) {</span>
<span id="cb7-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-101">}</span>
<span id="cb7-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @rdname geom_text_repel</span></span>
<span id="cb7-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param label.padding Amount of padding around label, as unit or number.</span></span>
<span id="cb7-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   Defaults to 0.25. (Default unit is lines, but other units can be specified</span></span>
<span id="cb7-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   by passing \code{unit(x, "units")}).</span></span>
<span id="cb7-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param label.r Radius of rounded corners, as unit or number. Defaults</span></span>
<span id="cb7-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   to 0.15. (Default unit is lines, but other units can be specified by</span></span>
<span id="cb7-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   passing \code{unit(x, "units")}).</span></span>
<span id="cb7-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param label.size Size of label border, in mm.</span></span>
<span id="cb7-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-111">geom_label_repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>,</span>
<span id="cb7-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-114">    ...,</span>
<span id="cb7-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,</span>
<span id="cb7-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb7-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel.max.overlaps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb7-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-132">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>),</span>
<span id="cb7-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb7-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-137">) {</span>
<span id="cb7-138">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_y)) {</span>
<span id="cb7-139">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(position)) {</span>
<span id="cb7-140">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Specify either `position` or `nudge_x`/`nudge_y`"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">call. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-141">    }</span>
<span id="cb7-142">    position <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge_repel</span>(nudge_x, nudge_y)</span>
<span id="cb7-143">  }</span>
<span id="cb7-144">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Warn about limitations of the algorithm</span></span>
<span id="cb7-145">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) {</span>
<span id="cb7-146">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-147">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: Repulsion works correctly only for rotation angles multiple of 90 degrees"</span></span>
<span id="cb7-148">    )</span>
<span id="cb7-149">  }</span>
<span id="cb7-150">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layer</span>(</span>
<span id="cb7-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> mapping,</span>
<span id="cb7-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> stat,</span>
<span id="cb7-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> GeomLabelRepel,</span>
<span id="cb7-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> position,</span>
<span id="cb7-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> show.legend,</span>
<span id="cb7-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> inherit.aes,</span>
<span id="cb7-158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> parse,</span>
<span id="cb7-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(label.padding),</span>
<span id="cb7-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding  =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(label.r),</span>
<span id="cb7-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> label.size,</span>
<span id="cb7-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow,</span>
<span id="cb7-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> na.rm,</span>
<span id="cb7-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force,</span>
<span id="cb7-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-170">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time,</span>
<span id="cb7-171">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter,</span>
<span id="cb7-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> nudge_x,</span>
<span id="cb7-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> nudge_y,</span>
<span id="cb7-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> xlim,</span>
<span id="cb7-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> ylim,</span>
<span id="cb7-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match.arg</span>(direction),</span>
<span id="cb7-178">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed,</span>
<span id="cb7-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-180">      ...</span>
<span id="cb7-181">    )</span>
<span id="cb7-182">  )</span>
<span id="cb7-183">}</span>
<span id="cb7-184"></span>
<span id="cb7-185"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' GeomLabelRepel</span></span>
<span id="cb7-186"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @rdname ggrepel</span></span>
<span id="cb7-187"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @format NULL</span></span>
<span id="cb7-188"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @usage NULL</span></span>
<span id="cb7-189"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @seealso \link[ggplot2]{GeomLabel} from the ggplot2 package.</span></span>
<span id="cb7-190"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @keywords internal</span></span>
<span id="cb7-191"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-192">GeomLabelRepel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggproto</span>(</span>
<span id="cb7-193">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GeomLabelRepel"</span>, Geom,</span>
<span id="cb7-194">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>),</span>
<span id="cb7-195">  </span>
<span id="cb7-196">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-197">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.88</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-198">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb7-199">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-200">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-201">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-202">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-203">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-204">  ),</span>
<span id="cb7-205">  </span>
<span id="cb7-206">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_panel =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-207">    data, panel_scales, coord,</span>
<span id="cb7-208">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-209">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-210">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-211">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-212">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-213">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,</span>
<span id="cb7-214">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-215">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-216">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-217">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-218">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-219">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-220">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb7-221">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-222">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-223">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-224">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-225">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-226">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>,</span>
<span id="cb7-227">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-228">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-229">  ) {</span>
<span id="cb7-230">    </span>
<span id="cb7-231">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (parse) {</span>
<span id="cb7-232">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_safe</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label))</span>
<span id="cb7-233">    }</span>
<span id="cb7-234">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label)))) {</span>
<span id="cb7-235">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>()</span>
<span id="cb7-236">    }</span>
<span id="cb7-237">    </span>
<span id="cb7-238">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if needed rename columns using our convention</span></span>
<span id="cb7-239">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (this_dim <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) {</span>
<span id="cb7-240">      this_orig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_orig"</span>, this_dim)</span>
<span id="cb7-241">      this_nudge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nudge_%s"</span>, this_dim)</span>
<span id="cb7-242">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>this_nudge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-243">        data[[this_nudge]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_dim]]</span>
<span id="cb7-244">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (this_orig <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-245">          data[[this_dim]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_orig]]</span>
<span id="cb7-246">          data[[this_orig]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-247">        }</span>
<span id="cb7-248">      }</span>
<span id="cb7-249">    }</span>
<span id="cb7-250">    </span>
<span id="cb7-251">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the nudges to the panel scales.</span></span>
<span id="cb7-252">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y)</span>
<span id="cb7-253">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(nudges, panel_scales)</span>
<span id="cb7-254">    </span>
<span id="cb7-255">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the raw data to the panel scales.</span></span>
<span id="cb7-256">    data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(data, panel_scales)</span>
<span id="cb7-257">    </span>
<span id="cb7-258">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The nudge is relative to the data.</span></span>
<span id="cb7-259">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb7-260">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb7-261">    </span>
<span id="cb7-262">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform limits to panel scales.</span></span>
<span id="cb7-263">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xlim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ylim)</span>
<span id="cb7-264">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(limits, panel_scales)</span>
<span id="cb7-265">    </span>
<span id="cb7-266">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allow Inf.</span></span>
<span id="cb7-267">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(xlim)) {</span>
<span id="cb7-268">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> xlim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)]</span>
<span id="cb7-269">    }</span>
<span id="cb7-270">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ylim)) {</span>
<span id="cb7-271">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ylim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)]</span>
<span id="cb7-272">    }</span>
<span id="cb7-273">    </span>
<span id="cb7-274">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill NAs with defaults.</span></span>
<span id="cb7-275">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb7-276">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)]</span>
<span id="cb7-277">    </span>
<span id="cb7-278">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert hjust and vjust to numeric if character</span></span>
<span id="cb7-279">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)) {</span>
<span id="cb7-280">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span>
<span id="cb7-281">    }</span>
<span id="cb7-282">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust)) {</span>
<span id="cb7-283">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)</span>
<span id="cb7-284">    }</span>
<span id="cb7-285">    </span>
<span id="cb7-286">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggname</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geom_label_repel"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gTree</span>(</span>
<span id="cb7-287">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> limits,</span>
<span id="cb7-288">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-289">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lab =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label,</span>
<span id="cb7-290">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-291">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(label.padding),</span>
<span id="cb7-292">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-293">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(label.r),</span>
<span id="cb7-294">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> label.size,</span>
<span id="cb7-295">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-296">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow,</span>
<span id="cb7-297">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force,</span>
<span id="cb7-298">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-299">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time,</span>
<span id="cb7-300">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter,</span>
<span id="cb7-301">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-302">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> direction,</span>
<span id="cb7-303">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed,</span>
<span id="cb7-304">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-305">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"labelrepeltree"</span></span>
<span id="cb7-306">    ))</span>
<span id="cb7-307">  },</span>
<span id="cb7-308">  </span>
<span id="cb7-309">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_key =</span> draw_key_label</span>
<span id="cb7-310">)</span>
<span id="cb7-311"></span>
<span id="cb7-312"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' grid::makeContent function for the grobTree of textRepelGrob objects</span></span>
<span id="cb7-313"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param x A grid grobTree.</span></span>
<span id="cb7-314"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-315"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-316">makeContent.labelrepeltree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb7-317">  </span>
<span id="cb7-318">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each bounding box.</span></span>
<span id="cb7-319">  box_padding_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-320">  box_padding_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-321">  </span>
<span id="cb7-322">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each point.</span></span>
<span id="cb7-323">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding)) {</span>
<span id="cb7-324">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb7-325">  }</span>
<span id="cb7-326">  </span>
<span id="cb7-327">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do not create text labels for empty strings.</span></span>
<span id="cb7-328">  valid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab))</span>
<span id="cb7-329">  invalid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab))</span>
<span id="cb7-330">  ix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(valid_strings, invalid_strings)</span>
<span id="cb7-331">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[ix,]</span>
<span id="cb7-332">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[ix]</span>
<span id="cb7-333">  </span>
<span id="cb7-334">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dataframe with x1 y1 x2 y2</span></span>
<span id="cb7-335">  boxes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-336">    row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-337">    t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textGrob</span>(</span>
<span id="cb7-338">      x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[i],</span>
<span id="cb7-339">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.padding,</span>
<span id="cb7-340">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.padding,</span>
<span id="cb7-341">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-342">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize   =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-343">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontfamily =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-344">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface   =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fontface,</span>
<span id="cb7-345">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight</span>
<span id="cb7-346">      ),</span>
<span id="cb7-347">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span></span>
<span id="cb7-348">    )</span>
<span id="cb7-349">    r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roundrectGrob</span>(</span>
<span id="cb7-350">      row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-351">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.padding,</span>
<span id="cb7-352">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.padding,</span>
<span id="cb7-353">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.r,</span>
<span id="cb7-354">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt),</span>
<span id="cb7-355">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"box"</span></span>
<span id="cb7-356">    )</span>
<span id="cb7-357">    gw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-358">    gh <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-359">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-360">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-361">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y,</span>
<span id="cb7-362">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-363">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y</span>
<span id="cb7-364">    )</span>
<span id="cb7-365">  })</span>
<span id="cb7-366">  </span>
<span id="cb7-367">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the repulsion reproducible if desired.</span></span>
<span id="cb7-368">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed)) {</span>
<span id="cb7-369">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample.int</span>(.Machine<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>integer.max, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L)</span>
<span id="cb7-370">  }</span>
<span id="cb7-371">  </span>
<span id="cb7-372">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The points are represented by circles.</span></span>
<span id="cb7-373">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-374">  </span>
<span id="cb7-375">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Beware the magic numbers. I do not understand them.</span></span>
<span id="cb7-376">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I just accept them as necessary to get the code to work.</span></span>
<span id="cb7-377">  p_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-378">  p_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-379">  p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (p_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> p_height)</span>
<span id="cb7-380">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb7-381">    p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_ratio))</span>
<span id="cb7-382">  }</span>
<span id="cb7-383">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-384">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-385">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-386">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-387">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-388">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-389">  </span>
<span id="cb7-390">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Repel overlapping bounding boxes away from each other.</span></span>
<span id="cb7-391">  repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with_seed_null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">repel_boxes2</span>(</span>
<span id="cb7-392">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_points     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]),</span>
<span id="cb7-393">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_size      =</span> point_size,</span>
<span id="cb7-394">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_x =</span> point_padding,</span>
<span id="cb7-395">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_y =</span> point_padding,</span>
<span id="cb7-396">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boxes           =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, boxes),</span>
<span id="cb7-397">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb7-398">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y),</span>
<span id="cb7-399">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-400">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-401">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_push      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-402">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force_pull <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>,</span>
<span id="cb7-403">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_time        =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.time,</span>
<span id="cb7-404">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_iter        =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e9</span>, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter),</span>
<span id="cb7-405">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_overlaps    =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.overlaps,</span>
<span id="cb7-406">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction       =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>direction,</span>
<span id="cb7-407">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose         =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose</span>
<span id="cb7-408">  ))</span>
<span id="cb7-409">  </span>
<span id="cb7-410">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-411">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-412">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(</span>
<span id="cb7-413">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: %s unlabeled data points (too many overlaps). Consider increasing 'max.overlaps'"</span>,</span>
<span id="cb7-414">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)</span>
<span id="cb7-415">      )</span>
<span id="cb7-416">    )</span>
<span id="cb7-417">  }</span>
<span id="cb7-418">  </span>
<span id="cb7-419">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-420">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb7-421">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-422">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs))</span>
<span id="cb7-423">  }</span>
<span id="cb7-424">  </span>
<span id="cb7-425">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-426">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps[i]) {</span>
<span id="cb7-427">      row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-428">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeLabelRepelGrobs</span>(</span>
<span id="cb7-429">        i,</span>
<span id="cb7-430">        x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[i],</span>
<span id="cb7-431">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of text bounding boxes.</span></span>
<span id="cb7-432">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-433">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-434">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-435">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb7-436">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb7-437">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-438">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>],</span>
<span id="cb7-439">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>],</span>
<span id="cb7-440">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding,</span>
<span id="cb7-441">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.padding,</span>
<span id="cb7-442">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> point_size[i],</span>
<span id="cb7-443">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding,</span>
<span id="cb7-444">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.curvature,</span>
<span id="cb7-445">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle     =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.angle,</span>
<span id="cb7-446">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp       =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.ncp,</span>
<span id="cb7-447">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.shape,</span>
<span id="cb7-448">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.square,</span>
<span id="cb7-449">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.squareShape,</span>
<span id="cb7-450">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.inflect,</span>
<span id="cb7-451">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.debug,</span>
<span id="cb7-452">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.r,</span>
<span id="cb7-453">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-454">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-455">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-456">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontfamily =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-457">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fontface,</span>
<span id="cb7-458">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight</span>
<span id="cb7-459">        ),</span>
<span id="cb7-460">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-461">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-462">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fill, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-463">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt</span>
<span id="cb7-464">        ),</span>
<span id="cb7-465">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-466">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.colour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-467">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-468">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.linetype <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-469">        ),</span>
<span id="cb7-470">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>arrow,</span>
<span id="cb7-471">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>min.segment.length,</span>
<span id="cb7-472">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust,</span>
<span id="cb7-473">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust</span>
<span id="cb7-474">      )</span>
<span id="cb7-475">    }</span>
<span id="cb7-476">  })</span>
<span id="cb7-477">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Put segment grobs before text grobs, rect grobs before text grobs.</span></span>
<span id="cb7-478">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-479">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Negate</span>(is.null), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(grobs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>)),</span>
<span id="cb7-480">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(</span>
<span id="cb7-481">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Negate</span>(is.null), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(grobs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"textbox"</span>)),</span>
<span id="cb7-482">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">recursive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-483">    )</span>
<span id="cb7-484">  )</span>
<span id="cb7-485">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-486">  </span>
<span id="cb7-487">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs)</span>
<span id="cb7-488">}</span>
<span id="cb7-489"></span>
<span id="cb7-490">makeLabelRepelGrobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-491">    i,</span>
<span id="cb7-492">    label,</span>
<span id="cb7-493">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-494">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-495">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-496">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-497">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-498">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-499">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-500">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-501">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>,</span>
<span id="cb7-502">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-503">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-504">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-505">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-506">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-507">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb7-508">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-509">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-510">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-511">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-512">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-513">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-514">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-515">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-516">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>),</span>
<span id="cb7-517">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"snpc"</span>),</span>
<span id="cb7-518">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-519">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-520">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-521">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-522">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-523">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-524">) {</span>
<span id="cb7-525">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-526">  </span>
<span id="cb7-527">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x))</span>
<span id="cb7-528">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, default.units)</span>
<span id="cb7-529">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(y))</span>
<span id="cb7-530">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(y, default.units)</span>
<span id="cb7-531">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.width))</span>
<span id="cb7-532">    box.width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.width, default.units)</span>
<span id="cb7-533">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.height))</span>
<span id="cb7-534">    box.height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.height, default.units)</span>
<span id="cb7-535">  </span>
<span id="cb7-536">  t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textGrob</span>(</span>
<span id="cb7-537">    label,</span>
<span id="cb7-538">    x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box.width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust),</span>
<span id="cb7-539">    y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box.height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust),</span>
<span id="cb7-540">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust,</span>
<span id="cb7-541">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust,</span>
<span id="cb7-542">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> text.gp,</span>
<span id="cb7-543">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"textrepelgrob%s"</span>, i)</span>
<span id="cb7-544">  )</span>
<span id="cb7-545">  </span>
<span id="cb7-546">  r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">roundrectGrob</span>(</span>
<span id="cb7-547">    x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box.width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> label.padding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust),</span>
<span id="cb7-548">    y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box.height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> label.padding <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust),</span>
<span id="cb7-549">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-550">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> label.padding,</span>
<span id="cb7-551">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> label.padding,</span>
<span id="cb7-552">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">just =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(hjust, vjust),</span>
<span id="cb7-553">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> r,</span>
<span id="cb7-554">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> rect.gp,</span>
<span id="cb7-555">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rectrepelgrob%s"</span>, i)</span>
<span id="cb7-556">  )</span>
<span id="cb7-557">  </span>
<span id="cb7-558">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-559">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-560">  y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-561">  y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(r), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-562">  </span>
<span id="cb7-563">  point_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x.orig, y.orig)</span>
<span id="cb7-564">  </span>
<span id="cb7-565">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinates of the intersection between the line from the</span></span>
<span id="cb7-566">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original data point to the centroid and the rectangle's edges.</span></span>
<span id="cb7-567">  text_box <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x1, y1, x2, y2)</span>
<span id="cb7-568">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#int &lt;- intersect_line_rectangle(point_pos, center, c(x1, y1, x2, y2))</span></span>
<span id="cb7-569">  int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_line_connection</span>(point_pos, text_box)</span>
<span id="cb7-570">  </span>
<span id="cb7-571">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the data point is inside the label box.</span></span>
<span id="cb7-572">  point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-573">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-574">      text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]) {</span>
<span id="cb7-575">    point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-576">  }</span>
<span id="cb7-577">  </span>
<span id="cb7-578">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This seems just fine.</span></span>
<span id="cb7-579">  point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-580">  </span>
<span id="cb7-581">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect_line_circle</span>(int, point_pos, (point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point.padding))</span>
<span id="cb7-582">  </span>
<span id="cb7-583">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance between the data point and the edge of the text box.</span></span>
<span id="cb7-584">  dx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-585">  dy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb7-586">  d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy)</span>
<span id="cb7-587">  </span>
<span id="cb7-588">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale the unit vector by the minimum segment length.</span></span>
<span id="cb7-589">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb7-590">    mx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-591">    my <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-592">    min.segment.length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>((mx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (my <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-593">  }</span>
<span id="cb7-594">  </span>
<span id="cb7-595">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">textbox =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect =</span> r, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> t))</span>
<span id="cb7-596">  </span>
<span id="cb7-597">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (</span>
<span id="cb7-598">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>point_inside_text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-599">    d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-600">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is greater than minimum.</span></span>
<span id="cb7-601">    (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-602">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is less than from label to point center.</span></span>
<span id="cb7-603">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-604">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than point size.</span></span>
<span id="cb7-605">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-606">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than from point edge to point center.</span></span>
<span id="cb7-607">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(point_int, point_pos)</span>
<span id="cb7-608">  ) {</span>
<span id="cb7-609">    s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curveGrob</span>(</span>
<span id="cb7-610">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-611">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-612">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-613">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-614">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-615">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> segment.curvature,</span>
<span id="cb7-616">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> segment.angle,</span>
<span id="cb7-617">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> segment.ncp,</span>
<span id="cb7-618">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> segment.shape,</span>
<span id="cb7-619">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">square =</span> segment.square,</span>
<span id="cb7-620">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squareShape =</span> segment.squareShape,</span>
<span id="cb7-621">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inflect =</span> segment.inflect,</span>
<span id="cb7-622">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> segment.debug,</span>
<span id="cb7-623">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> segment.gp,</span>
<span id="cb7-624">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segmentrepelgrob%s"</span>, i),</span>
<span id="cb7-625">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow</span>
<span id="cb7-626">    )</span>
<span id="cb7-627">    grobs[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s</span>
<span id="cb7-628">  }</span>
<span id="cb7-629">  </span>
<span id="cb7-630">  grobs</span>
<span id="cb7-631">}</span>
<span id="cb7-632"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @rdname geom_text_repel</span></span>
<span id="cb7-633"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-634">geom_marquee_repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-635">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>,</span>
<span id="cb7-636">    ...,</span>
<span id="cb7-637">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-638">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-639">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-640">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-641">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-642">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-643">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb7-644">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel.max.overlaps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb7-645">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-646">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-647">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-648">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-649">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-650">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-651">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>),</span>
<span id="cb7-652">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-653">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb7-654">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-655">) {</span>
<span id="cb7-656">  rlang<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">check_installed</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marquee"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"for rendering rich text."</span>)</span>
<span id="cb7-657">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_y)) {</span>
<span id="cb7-658">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(position)) {</span>
<span id="cb7-659">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Specify either `position` or `nudge_x`/`nudge_y`"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">call. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-660">    }</span>
<span id="cb7-661">    position <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge_repel</span>(nudge_x, nudge_y)</span>
<span id="cb7-662">  }</span>
<span id="cb7-663">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Warn about limitations of the algorithm</span></span>
<span id="cb7-664">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) {</span>
<span id="cb7-665">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-666">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: Repulsion works correctly only for rotation angles multiple of 90 degrees"</span></span>
<span id="cb7-667">    )</span>
<span id="cb7-668">  }</span>
<span id="cb7-669">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layer</span>(</span>
<span id="cb7-670">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-671">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> mapping,</span>
<span id="cb7-672">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> stat,</span>
<span id="cb7-673">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> GeomMarqueeRepel,</span>
<span id="cb7-674">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> position,</span>
<span id="cb7-675">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> show.legend,</span>
<span id="cb7-676">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> inherit.aes,</span>
<span id="cb7-677">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-678">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding   =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-679">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-680">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-681">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow,</span>
<span id="cb7-682">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> na.rm,</span>
<span id="cb7-683">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force,</span>
<span id="cb7-684">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-685">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time,</span>
<span id="cb7-686">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter,</span>
<span id="cb7-687">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-688">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> nudge_x,</span>
<span id="cb7-689">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> nudge_y,</span>
<span id="cb7-690">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> xlim,</span>
<span id="cb7-691">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> ylim,</span>
<span id="cb7-692">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match.arg</span>(direction),</span>
<span id="cb7-693">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed,</span>
<span id="cb7-694">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-695">      ...</span>
<span id="cb7-696">    )</span>
<span id="cb7-697">  )</span>
<span id="cb7-698">}</span>
<span id="cb7-699"></span>
<span id="cb7-700"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' GeomMarqueeRepel</span></span>
<span id="cb7-701"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @format NULL</span></span>
<span id="cb7-702"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @usage NULL</span></span>
<span id="cb7-703"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @keywords internal</span></span>
<span id="cb7-704"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-705">GeomMarqueeRepel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggproto</span>(</span>
<span id="cb7-706">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GeomMarqueeRepel"</span>, Geom,</span>
<span id="cb7-707">  </span>
<span id="cb7-708">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>),</span>
<span id="cb7-709">  </span>
<span id="cb7-710">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-711">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.88</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-712">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb7-713">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># marquee specific</span></span>
<span id="cb7-714">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-715">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># repel specific</span></span>
<span id="cb7-716">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-717">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-718">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-719">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-720">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-721">  ),</span>
<span id="cb7-722">  </span>
<span id="cb7-723">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_panel =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-724">    data, panel_params, coord,</span>
<span id="cb7-725">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># repel specific</span></span>
<span id="cb7-726">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-727">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-728">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-729">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-730">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-731">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-732">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-733">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-734">  ) {</span>
<span id="cb7-735">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label)))) {</span>
<span id="cb7-736">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>()</span>
<span id="cb7-737">    }</span>
<span id="cb7-738">    </span>
<span id="cb7-739">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Marquee specific processing</span></span>
<span id="cb7-740">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>style</span>
<span id="cb7-741">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(styles)) {</span>
<span id="cb7-742">      default <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(</span>
<span id="cb7-743">        marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">classic_style</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>,</span>
<span id="cb7-744">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trbl</span>(marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rem</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span>
<span id="cb7-745">      )</span>
<span id="cb7-746">      styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(default, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(data))</span>
<span id="cb7-747">    }</span>
<span id="cb7-748">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inherits</span>(styles, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marquee_style_set"</span>)) {</span>
<span id="cb7-749">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`style` must be a marquee_style_set object."</span>)</span>
<span id="cb7-750">    }</span>
<span id="cb7-751">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(styles,</span>
<span id="cb7-752">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base"</span>,</span>
<span id="cb7-753">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-754">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size   =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-755">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight,</span>
<span id="cb7-756">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha)</span>
<span id="cb7-757">    )</span>
<span id="cb7-758">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(styles,</span>
<span id="cb7-759">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>,</span>
<span id="cb7-760">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">background =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skip_inherit</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fill),</span>
<span id="cb7-761">    )</span>
<span id="cb7-762">    </span>
<span id="cb7-763">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggrepel specific processing</span></span>
<span id="cb7-764">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if needed rename columns using our convention</span></span>
<span id="cb7-765">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (this_dim <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) {</span>
<span id="cb7-766">      this_orig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_orig"</span>, this_dim)</span>
<span id="cb7-767">      this_nudge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nudge_%s"</span>, this_dim)</span>
<span id="cb7-768">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>this_nudge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-769">        data[[this_nudge]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_dim]]</span>
<span id="cb7-770">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (this_orig <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-771">          data[[this_dim]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_orig]]</span>
<span id="cb7-772">          data[[this_orig]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-773">        }</span>
<span id="cb7-774">      }</span>
<span id="cb7-775">    }</span>
<span id="cb7-776">    </span>
<span id="cb7-777">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the nudges to the panel scales.</span></span>
<span id="cb7-778">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y)</span>
<span id="cb7-779">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(nudges, panel_params)</span>
<span id="cb7-780">    </span>
<span id="cb7-781">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the raw data to the panel scales.</span></span>
<span id="cb7-782">    data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(data, panel_params)</span>
<span id="cb7-783">    </span>
<span id="cb7-784">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The nudge is relative to the data.</span></span>
<span id="cb7-785">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb7-786">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb7-787">    </span>
<span id="cb7-788">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform limits to panel scales.</span></span>
<span id="cb7-789">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xlim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ylim)</span>
<span id="cb7-790">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(limits, panel_params)</span>
<span id="cb7-791">    </span>
<span id="cb7-792">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allow Inf.</span></span>
<span id="cb7-793">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(xlim)) {</span>
<span id="cb7-794">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> xlim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)]</span>
<span id="cb7-795">    }</span>
<span id="cb7-796">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ylim)) {</span>
<span id="cb7-797">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ylim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)]</span>
<span id="cb7-798">    }</span>
<span id="cb7-799">    </span>
<span id="cb7-800">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill NAs with defaults.</span></span>
<span id="cb7-801">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb7-802">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)]</span>
<span id="cb7-803">    </span>
<span id="cb7-804">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert hjust and vjust to numeric if character</span></span>
<span id="cb7-805">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)) {</span>
<span id="cb7-806">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span>
<span id="cb7-807">    }</span>
<span id="cb7-808">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust)) {</span>
<span id="cb7-809">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)</span>
<span id="cb7-810">    }</span>
<span id="cb7-811">    </span>
<span id="cb7-812">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(data))</span>
<span id="cb7-813">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label))) {</span>
<span id="cb7-814">      grobs[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">marquee_grob</span>(</span>
<span id="cb7-815">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> styles[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_body_margin =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-816">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width[i],</span>
<span id="cb7-817">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-818">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle[i]</span>
<span id="cb7-819">      )</span>
<span id="cb7-820">    }</span>
<span id="cb7-821">    </span>
<span id="cb7-822">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggname</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geom_marquee_repel"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gTree</span>(</span>
<span id="cb7-823">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> limits, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-824">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grobs =</span> grobs,</span>
<span id="cb7-825">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-826">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-827">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-828">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-829">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-830">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> direction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-831">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marqueerepeltree"</span></span>
<span id="cb7-832">    ))</span>
<span id="cb7-833">  },</span>
<span id="cb7-834">  </span>
<span id="cb7-835">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_key =</span> draw_key_label</span>
<span id="cb7-836">)</span>
<span id="cb7-837"></span>
<span id="cb7-838"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-839">makeContent.marqueerepeltree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb7-840">  </span>
<span id="cb7-841">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each bounding box.</span></span>
<span id="cb7-842">  box_padding_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>( x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-843">  box_padding_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-844">  </span>
<span id="cb7-845">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each point.</span></span>
<span id="cb7-846">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding)) {</span>
<span id="cb7-847">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb7-848">  }</span>
<span id="cb7-849">  </span>
<span id="cb7-850">  valid_strings   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb7-851">  invalid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-852">  ord <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(valid_strings, invalid_strings)</span>
<span id="cb7-853">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[ord, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-854">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[ord]</span>
<span id="cb7-855">  </span>
<span id="cb7-856">  justification <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotate_just</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)</span>
<span id="cb7-857">  hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> justification<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust</span>
<span id="cb7-858">  vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> justification<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust</span>
<span id="cb7-859">  </span>
<span id="cb7-860">  boxes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-861">    row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-862">    grob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[[i]]</span>
<span id="cb7-863">    gw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(grob),  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-864">    gh <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(grob), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-865">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-866">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       hjust[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-867">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       vjust[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y,</span>
<span id="cb7-868">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-869">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y</span>
<span id="cb7-870">    )</span>
<span id="cb7-871">  })</span>
<span id="cb7-872">  </span>
<span id="cb7-873">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the repulsion reproducible if desired.</span></span>
<span id="cb7-874">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed)) {</span>
<span id="cb7-875">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample.int</span>(.Machine<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>integer.max, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L)</span>
<span id="cb7-876">  }</span>
<span id="cb7-877">  </span>
<span id="cb7-878">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The points are represented by circles.</span></span>
<span id="cb7-879">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-880">  </span>
<span id="cb7-881">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Beware the magic numbers. I do not understand them.</span></span>
<span id="cb7-882">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I just accept them as necessary to get the code to work.</span></span>
<span id="cb7-883">  p_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-884">  p_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-885">  p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (p_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> p_height)</span>
<span id="cb7-886">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb7-887">    p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_ratio))</span>
<span id="cb7-888">  }</span>
<span id="cb7-889">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-890">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-891">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-892">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-893">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-894">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-895">  </span>
<span id="cb7-896">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Repel overlapping bounding boxes away from each other.</span></span>
<span id="cb7-897">  repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with_seed_null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">repel_boxes2</span>(</span>
<span id="cb7-898">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_points     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]),</span>
<span id="cb7-899">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_size      =</span> point_size,</span>
<span id="cb7-900">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_x =</span> point_padding,</span>
<span id="cb7-901">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_y =</span> point_padding,</span>
<span id="cb7-902">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boxes           =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, boxes),</span>
<span id="cb7-903">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb7-904">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y),</span>
<span id="cb7-905">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-906">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-907">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_push      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-908">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force_pull <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>,</span>
<span id="cb7-909">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_time        =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.time,</span>
<span id="cb7-910">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_iter        =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e9</span>, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter),</span>
<span id="cb7-911">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_overlaps    =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.overlaps,</span>
<span id="cb7-912">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction       =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>direction,</span>
<span id="cb7-913">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose         =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose</span>
<span id="cb7-914">  ))</span>
<span id="cb7-915">  </span>
<span id="cb7-916">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-917">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-918">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(</span>
<span id="cb7-919">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: %s unlabeled data points (too many overlaps). Consider increasing 'max.overlaps'"</span>,</span>
<span id="cb7-920">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)</span>
<span id="cb7-921">      )</span>
<span id="cb7-922">    )</span>
<span id="cb7-923">  }</span>
<span id="cb7-924">  </span>
<span id="cb7-925">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-926">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb7-927">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-928">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs))</span>
<span id="cb7-929">  }</span>
<span id="cb7-930">  </span>
<span id="cb7-931">  width  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-932">  height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-933">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> .stroke <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb7-934">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-935">  </span>
<span id="cb7-936">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-937">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps[i]) {</span>
<span id="cb7-938">      row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-939">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeMarqueeRepelGrobs</span>(</span>
<span id="cb7-940">        i,</span>
<span id="cb7-941">        x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[[i]],</span>
<span id="cb7-942">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of text bounding boxes.</span></span>
<span id="cb7-943">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-944">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-945">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-946">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb7-947">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb7-948">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-949">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>],</span>
<span id="cb7-950">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>],</span>
<span id="cb7-951">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding,</span>
<span id="cb7-952">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> point_size[i],</span>
<span id="cb7-953">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> point_padding,</span>
<span id="cb7-954">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.curvature,</span>
<span id="cb7-955">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.angle,</span>
<span id="cb7-956">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.ncp,</span>
<span id="cb7-957">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.shape,</span>
<span id="cb7-958">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.square,</span>
<span id="cb7-959">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.squareShape,</span>
<span id="cb7-960">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.inflect,</span>
<span id="cb7-961">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.debug,</span>
<span id="cb7-962">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-963">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.colour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-964">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-965">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.linetype <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-966">        ),</span>
<span id="cb7-967">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>arrow,</span>
<span id="cb7-968">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>min.segment.length,</span>
<span id="cb7-969">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust,</span>
<span id="cb7-970">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust,</span>
<span id="cb7-971">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(width, height)</span>
<span id="cb7-972">      )</span>
<span id="cb7-973">    }</span>
<span id="cb7-974">  })</span>
<span id="cb7-975">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(grobs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">recursive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-976">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-977">  </span>
<span id="cb7-978">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs)</span>
<span id="cb7-979">}</span>
<span id="cb7-980"></span>
<span id="cb7-981">makeMarqueeRepelGrobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-982">    i,</span>
<span id="cb7-983">    label,</span>
<span id="cb7-984">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-985">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-986">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-987">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-988">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-989">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-990">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-991">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-992">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>,</span>
<span id="cb7-993">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-994">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-995">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-996">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-997">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb7-998">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-999">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1000">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-1001">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1002">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1003">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1004">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1005">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-1006">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1007">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1008">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1009">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1010">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1011">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-1012">) {</span>
<span id="cb7-1013">  </span>
<span id="cb7-1014">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x))</span>
<span id="cb7-1015">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, default.units)</span>
<span id="cb7-1016">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(y))</span>
<span id="cb7-1017">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(y, default.units)</span>
<span id="cb7-1018">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.width))</span>
<span id="cb7-1019">    box.width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.width, default.units)</span>
<span id="cb7-1020">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.height))</span>
<span id="cb7-1021">    box.height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.height, default.units)</span>
<span id="cb7-1022">  </span>
<span id="cb7-1023">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># browser()</span></span>
<span id="cb7-1024">  </span>
<span id="cb7-1025">  label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">editGrob</span>(label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)</span>
<span id="cb7-1026">  </span>
<span id="cb7-1027">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1028">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1029">  y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1030">  y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1031">  </span>
<span id="cb7-1032">  point_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x.orig, y.orig)</span>
<span id="cb7-1033">  </span>
<span id="cb7-1034">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinates of the intersection between the line from the</span></span>
<span id="cb7-1035">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original data point to the centroid and the rectangle's edges.</span></span>
<span id="cb7-1036">  text_box <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x1, y1, x2, y2)</span>
<span id="cb7-1037">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#int &lt;- intersect_line_rectangle(point_pos, center, c(x1, y1, x2, y2))</span></span>
<span id="cb7-1038">  int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_line_connection</span>(point_pos, text_box)</span>
<span id="cb7-1039">  </span>
<span id="cb7-1040">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the data point is inside the label box.</span></span>
<span id="cb7-1041">  point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-1042">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1043">      text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]) {</span>
<span id="cb7-1044">    point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1045">  }</span>
<span id="cb7-1046">  </span>
<span id="cb7-1047">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This seems just fine.</span></span>
<span id="cb7-1048">  point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-1049">  </span>
<span id="cb7-1050">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect_line_circle</span>(int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, point_pos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, (point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point.padding))</span>
<span id="cb7-1051">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> point_int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dim</span>
<span id="cb7-1052">  </span>
<span id="cb7-1053">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance between the data point and the edge of the text box.</span></span>
<span id="cb7-1054">  dx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-1055">  dy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb7-1056">  d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy)</span>
<span id="cb7-1057">  </span>
<span id="cb7-1058">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale the unit vector by the minimum segment length.</span></span>
<span id="cb7-1059">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb7-1060">    mx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1061">    my <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1062">    min.segment.length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>((mx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (my <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-1063">  }</span>
<span id="cb7-1064">  </span>
<span id="cb7-1065">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">textbox =</span> label)</span>
<span id="cb7-1066">  </span>
<span id="cb7-1067">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (</span>
<span id="cb7-1068">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>point_inside_text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1069">    d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1070">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is greater than minimum.</span></span>
<span id="cb7-1071">    (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1072">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is less than from label to point center.</span></span>
<span id="cb7-1073">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1074">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than point size.</span></span>
<span id="cb7-1075">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, point_pos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1076">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than from point edge to point center.</span></span>
<span id="cb7-1077">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(point_int, point_pos)</span>
<span id="cb7-1078">  ) {</span>
<span id="cb7-1079">    s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curveGrob</span>(</span>
<span id="cb7-1080">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-1081">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-1082">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-1083">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-1084">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-1085">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> segment.curvature,</span>
<span id="cb7-1086">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> segment.angle,</span>
<span id="cb7-1087">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> segment.ncp,</span>
<span id="cb7-1088">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> segment.shape,</span>
<span id="cb7-1089">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">square =</span> segment.square,</span>
<span id="cb7-1090">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squareShape =</span> segment.squareShape,</span>
<span id="cb7-1091">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inflect =</span> segment.inflect,</span>
<span id="cb7-1092">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> segment.debug,</span>
<span id="cb7-1093">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> segment.gp,</span>
<span id="cb7-1094">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segmentrepelgrob%s"</span>, i),</span>
<span id="cb7-1095">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow</span>
<span id="cb7-1096">    )</span>
<span id="cb7-1097">    grobs[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s</span>
<span id="cb7-1098">  }</span>
<span id="cb7-1099">  </span>
<span id="cb7-1100">  grobs</span>
<span id="cb7-1101">}</span>
<span id="cb7-1102"></span>
<span id="cb7-1103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># similar to ggplot2:::rotate_just</span></span>
<span id="cb7-1104">rotate_just <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) {</span>
<span id="cb7-1105">  angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span></span>
<span id="cb7-1106">  </span>
<span id="cb7-1107">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(hjust)) {</span>
<span id="cb7-1108">    hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(hjust, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-1109">    hjust[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(hjust)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-1110">  }</span>
<span id="cb7-1111">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(vjust)) {</span>
<span id="cb7-1112">    vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(vjust, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-1113">    vjust[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(vjust)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-1114">  }</span>
<span id="cb7-1115">  </span>
<span id="cb7-1116">  size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(angle), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(hjust), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(vjust))</span>
<span id="cb7-1117">  angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(angle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1118">  hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(hjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1119">  vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(vjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1120">  </span>
<span id="cb7-1121">  case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findInterval</span>(angle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>))</span>
<span id="cb7-1122">  </span>
<span id="cb7-1123">  hnew <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hjust</span>
<span id="cb7-1124">  vnew <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vjust</span>
<span id="cb7-1125">  </span>
<span id="cb7-1126">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 90 &lt;= x &lt; 180</span></span>
<span id="cb7-1127">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[is_case]</span>
<span id="cb7-1128">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hjust[is_case]</span>
<span id="cb7-1129">  </span>
<span id="cb7-1130">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 180 &lt;= x &lt; 270</span></span>
<span id="cb7-1131">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[is_case]</span>
<span id="cb7-1132">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[is_case]</span>
<span id="cb7-1133">  </span>
<span id="cb7-1134">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 270 &lt;= x &lt; 360</span></span>
<span id="cb7-1135">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vjust[is_case]</span>
<span id="cb7-1136">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[is_case]</span>
<span id="cb7-1137">  </span>
<span id="cb7-1138">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hnew, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vnew)</span>
<span id="cb7-1139">}</span>
<span id="cb7-1140"></span>
<span id="cb7-1141">GeomMarqueeRepel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggproto</span>(</span>
<span id="cb7-1142">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GeomMarqueeRepel"</span>, Geom,</span>
<span id="cb7-1143">  </span>
<span id="cb7-1144">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>),</span>
<span id="cb7-1145">  </span>
<span id="cb7-1146">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-1147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.88</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb7-1149">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># marquee specific</span></span>
<span id="cb7-1150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-1151">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># repel specific</span></span>
<span id="cb7-1152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-1157">  ),</span>
<span id="cb7-1158">  </span>
<span id="cb7-1159">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_panel =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-1160">    data, panel_params, coord,</span>
<span id="cb7-1161">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># repel specific</span></span>
<span id="cb7-1162">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-1163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-1166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-1168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-1169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-1170">  ) {</span>
<span id="cb7-1171">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label)))) {</span>
<span id="cb7-1172">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>()</span>
<span id="cb7-1173">    }</span>
<span id="cb7-1174">    </span>
<span id="cb7-1175">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Marquee specific processing</span></span>
<span id="cb7-1176">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>style</span>
<span id="cb7-1177">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(styles)) {</span>
<span id="cb7-1178">      default <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(</span>
<span id="cb7-1179">        marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">classic_style</span>(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>,</span>
<span id="cb7-1180">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trbl</span>(marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rem</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span>
<span id="cb7-1181">      )</span>
<span id="cb7-1182">      styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(default, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(data))</span>
<span id="cb7-1183">    }</span>
<span id="cb7-1184">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inherits</span>(styles, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marquee_style_set"</span>)) {</span>
<span id="cb7-1185">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`style` must be a marquee_style_set object."</span>)</span>
<span id="cb7-1186">    }</span>
<span id="cb7-1187">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(styles,</span>
<span id="cb7-1188">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"base"</span>,</span>
<span id="cb7-1189">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-1190">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size   =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-1191">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight,</span>
<span id="cb7-1192">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha)</span>
<span id="cb7-1193">    )</span>
<span id="cb7-1194">    styles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modify_style</span>(styles,</span>
<span id="cb7-1195">                                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body"</span>,</span>
<span id="cb7-1196">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">background =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">skip_inherit</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fill),</span>
<span id="cb7-1197">    )</span>
<span id="cb7-1198">    </span>
<span id="cb7-1199">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ggrepel specific processing</span></span>
<span id="cb7-1200">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if needed rename columns using our convention</span></span>
<span id="cb7-1201">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (this_dim <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) {</span>
<span id="cb7-1202">      this_orig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_orig"</span>, this_dim)</span>
<span id="cb7-1203">      this_nudge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nudge_%s"</span>, this_dim)</span>
<span id="cb7-1204">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>this_nudge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-1205">        data[[this_nudge]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_dim]]</span>
<span id="cb7-1206">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (this_orig <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-1207">          data[[this_dim]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_orig]]</span>
<span id="cb7-1208">          data[[this_orig]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-1209">        }</span>
<span id="cb7-1210">      }</span>
<span id="cb7-1211">    }</span>
<span id="cb7-1212">    </span>
<span id="cb7-1213">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the nudges to the panel scales.</span></span>
<span id="cb7-1214">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y)</span>
<span id="cb7-1215">    nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(nudges, panel_params)</span>
<span id="cb7-1216">    </span>
<span id="cb7-1217">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the raw data to the panel scales.</span></span>
<span id="cb7-1218">    data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(data, panel_params)</span>
<span id="cb7-1219">    </span>
<span id="cb7-1220">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The nudge is relative to the data.</span></span>
<span id="cb7-1221">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb7-1222">    data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb7-1223">    </span>
<span id="cb7-1224">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform limits to panel scales.</span></span>
<span id="cb7-1225">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xlim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ylim)</span>
<span id="cb7-1226">    limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(limits, panel_params)</span>
<span id="cb7-1227">    </span>
<span id="cb7-1228">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allow Inf.</span></span>
<span id="cb7-1229">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(xlim)) {</span>
<span id="cb7-1230">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> xlim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)]</span>
<span id="cb7-1231">    }</span>
<span id="cb7-1232">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ylim)) {</span>
<span id="cb7-1233">      limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ylim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)]</span>
<span id="cb7-1234">    }</span>
<span id="cb7-1235">    </span>
<span id="cb7-1236">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill NAs with defaults.</span></span>
<span id="cb7-1237">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb7-1238">    limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)]</span>
<span id="cb7-1239">    </span>
<span id="cb7-1240">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert hjust and vjust to numeric if character</span></span>
<span id="cb7-1241">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)) {</span>
<span id="cb7-1242">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span>
<span id="cb7-1243">    }</span>
<span id="cb7-1244">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust)) {</span>
<span id="cb7-1245">      data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)</span>
<span id="cb7-1246">    }</span>
<span id="cb7-1247">    </span>
<span id="cb7-1248">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(data))</span>
<span id="cb7-1249">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label))) {</span>
<span id="cb7-1250">      grobs[[i]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">marquee_grob</span>(</span>
<span id="cb7-1251">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> styles[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_body_margin =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-1252">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>width[i],</span>
<span id="cb7-1253">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1254">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle[i]</span>
<span id="cb7-1255">      )</span>
<span id="cb7-1256">    }</span>
<span id="cb7-1257">    </span>
<span id="cb7-1258">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggname</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geom_marquee_repel"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gTree</span>(</span>
<span id="cb7-1259">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> limits, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-1260">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grobs =</span> grobs,</span>
<span id="cb7-1261">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-1262">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-1263">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-1264">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-1265">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-1266">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> direction, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-1267">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"marqueerepeltree"</span></span>
<span id="cb7-1268">    ))</span>
<span id="cb7-1269">  },</span>
<span id="cb7-1270">  </span>
<span id="cb7-1271">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_key =</span> draw_key_label</span>
<span id="cb7-1272">)</span>
<span id="cb7-1273"></span>
<span id="cb7-1274"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-1275">makeContent.marqueerepeltree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb7-1276">  </span>
<span id="cb7-1277">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each bounding box.</span></span>
<span id="cb7-1278">  box_padding_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>( x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1279">  box_padding_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1280">  </span>
<span id="cb7-1281">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each point.</span></span>
<span id="cb7-1282">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding)) {</span>
<span id="cb7-1283">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb7-1284">  }</span>
<span id="cb7-1285">  </span>
<span id="cb7-1286">  valid_strings   <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb7-1287">  invalid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lengths</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-1288">  ord <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(valid_strings, invalid_strings)</span>
<span id="cb7-1289">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[ord, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-1290">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[ord]</span>
<span id="cb7-1291">  </span>
<span id="cb7-1292">  justification <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rotate_just</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)</span>
<span id="cb7-1293">  hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> justification<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust</span>
<span id="cb7-1294">  vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> justification<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust</span>
<span id="cb7-1295">  </span>
<span id="cb7-1296">  boxes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-1297">    row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-1298">    grob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[[i]]</span>
<span id="cb7-1299">    gw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(grob),  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1300">    gh <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(grob), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1301">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-1302">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       hjust[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-1303">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>       vjust[i] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y,</span>
<span id="cb7-1304">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-1305">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gh <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[i]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y</span>
<span id="cb7-1306">    )</span>
<span id="cb7-1307">  })</span>
<span id="cb7-1308">  </span>
<span id="cb7-1309">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the repulsion reproducible if desired.</span></span>
<span id="cb7-1310">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed)) {</span>
<span id="cb7-1311">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample.int</span>(.Machine<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>integer.max, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L)</span>
<span id="cb7-1312">  }</span>
<span id="cb7-1313">  </span>
<span id="cb7-1314">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The points are represented by circles.</span></span>
<span id="cb7-1315">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-1316">  </span>
<span id="cb7-1317">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Beware the magic numbers. I do not understand them.</span></span>
<span id="cb7-1318">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I just accept them as necessary to get the code to work.</span></span>
<span id="cb7-1319">  p_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1320">  p_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1321">  p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (p_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> p_height)</span>
<span id="cb7-1322">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb7-1323">    p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_ratio))</span>
<span id="cb7-1324">  }</span>
<span id="cb7-1325">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-1326">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1327">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-1328">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-1329">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1330">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-1331">  </span>
<span id="cb7-1332">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Repel overlapping bounding boxes away from each other.</span></span>
<span id="cb7-1333">  repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with_seed_null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">repel_boxes2</span>(</span>
<span id="cb7-1334">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_points     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]),</span>
<span id="cb7-1335">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_size      =</span> point_size,</span>
<span id="cb7-1336">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_x =</span> point_padding,</span>
<span id="cb7-1337">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_y =</span> point_padding,</span>
<span id="cb7-1338">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boxes           =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, boxes),</span>
<span id="cb7-1339">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb7-1340">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y),</span>
<span id="cb7-1341">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1342">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1343">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_push      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-1344">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force_pull <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>,</span>
<span id="cb7-1345">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_time        =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.time,</span>
<span id="cb7-1346">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_iter        =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e9</span>, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter),</span>
<span id="cb7-1347">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_overlaps    =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.overlaps,</span>
<span id="cb7-1348">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction       =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>direction,</span>
<span id="cb7-1349">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose         =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose</span>
<span id="cb7-1350">  ))</span>
<span id="cb7-1351">  </span>
<span id="cb7-1352">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-1353">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-1354">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(</span>
<span id="cb7-1355">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: %s unlabeled data points (too many overlaps). Consider increasing 'max.overlaps'"</span>,</span>
<span id="cb7-1356">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)</span>
<span id="cb7-1357">      )</span>
<span id="cb7-1358">    )</span>
<span id="cb7-1359">  }</span>
<span id="cb7-1360">  </span>
<span id="cb7-1361">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-1362">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb7-1363">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-1364">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs))</span>
<span id="cb7-1365">  }</span>
<span id="cb7-1366">  </span>
<span id="cb7-1367">  width  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1368">  height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1369">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> .stroke <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb7-1370">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1371">  </span>
<span id="cb7-1372">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-1373">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps[i]) {</span>
<span id="cb7-1374">      row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-1375">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeMarqueeRepelGrobs</span>(</span>
<span id="cb7-1376">        i,</span>
<span id="cb7-1377">        x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>grobs[[i]],</span>
<span id="cb7-1378">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of text bounding boxes.</span></span>
<span id="cb7-1379">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-1380">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-1381">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-1382">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb7-1383">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb7-1384">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-1385">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>],</span>
<span id="cb7-1386">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> boxes[[i]][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>],</span>
<span id="cb7-1387">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding,</span>
<span id="cb7-1388">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> point_size[i],</span>
<span id="cb7-1389">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> point_padding,</span>
<span id="cb7-1390">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.curvature,</span>
<span id="cb7-1391">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.angle,</span>
<span id="cb7-1392">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.ncp,</span>
<span id="cb7-1393">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.shape,</span>
<span id="cb7-1394">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.square,</span>
<span id="cb7-1395">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.squareShape,</span>
<span id="cb7-1396">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.inflect,</span>
<span id="cb7-1397">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.debug,</span>
<span id="cb7-1398">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-1399">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.colour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-1400">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-1401">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.linetype <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-1402">        ),</span>
<span id="cb7-1403">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>arrow,</span>
<span id="cb7-1404">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>min.segment.length,</span>
<span id="cb7-1405">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust,</span>
<span id="cb7-1406">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust,</span>
<span id="cb7-1407">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(width, height)</span>
<span id="cb7-1408">      )</span>
<span id="cb7-1409">    }</span>
<span id="cb7-1410">  })</span>
<span id="cb7-1411">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(grobs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">recursive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-1412">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-1413">  </span>
<span id="cb7-1414">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs)</span>
<span id="cb7-1415">}</span>
<span id="cb7-1416"></span>
<span id="cb7-1417">makeMarqueeRepelGrobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-1418">    i,</span>
<span id="cb7-1419">    label,</span>
<span id="cb7-1420">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-1421">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-1422">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-1423">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1424">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1425">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Width and height of text boxes.</span></span>
<span id="cb7-1426">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1427">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1428">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>,</span>
<span id="cb7-1429">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-1430">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1431">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-1432">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1433">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb7-1434">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1435">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1436">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-1437">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1438">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1439">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1440">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1441">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-1442">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1443">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1444">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1445">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1446">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1447">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-1448">) {</span>
<span id="cb7-1449">  </span>
<span id="cb7-1450">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x))</span>
<span id="cb7-1451">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, default.units)</span>
<span id="cb7-1452">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(y))</span>
<span id="cb7-1453">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(y, default.units)</span>
<span id="cb7-1454">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.width))</span>
<span id="cb7-1455">    box.width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.width, default.units)</span>
<span id="cb7-1456">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(box.height))</span>
<span id="cb7-1457">    box.height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(box.height, default.units)</span>
<span id="cb7-1458">  </span>
<span id="cb7-1459">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># browser()</span></span>
<span id="cb7-1460">  </span>
<span id="cb7-1461">  label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">editGrob</span>(label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y)</span>
<span id="cb7-1462">  </span>
<span id="cb7-1463">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1464">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobWidth</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1465">  y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1466">  y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobHeight</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1467">  </span>
<span id="cb7-1468">  point_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x.orig, y.orig)</span>
<span id="cb7-1469">  </span>
<span id="cb7-1470">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinates of the intersection between the line from the</span></span>
<span id="cb7-1471">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original data point to the centroid and the rectangle's edges.</span></span>
<span id="cb7-1472">  text_box <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x1, y1, x2, y2)</span>
<span id="cb7-1473">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#int &lt;- intersect_line_rectangle(point_pos, center, c(x1, y1, x2, y2))</span></span>
<span id="cb7-1474">  int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_line_connection</span>(point_pos, text_box)</span>
<span id="cb7-1475">  </span>
<span id="cb7-1476">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the data point is inside the label box.</span></span>
<span id="cb7-1477">  point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-1478">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1479">      text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]) {</span>
<span id="cb7-1480">    point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1481">  }</span>
<span id="cb7-1482">  </span>
<span id="cb7-1483">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This seems just fine.</span></span>
<span id="cb7-1484">  point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-1485">  </span>
<span id="cb7-1486">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect_line_circle</span>(int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, point_pos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, (point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point.padding))</span>
<span id="cb7-1487">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> point_int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> dim</span>
<span id="cb7-1488">  </span>
<span id="cb7-1489">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance between the data point and the edge of the text box.</span></span>
<span id="cb7-1490">  dx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-1491">  dy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb7-1492">  d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy)</span>
<span id="cb7-1493">  </span>
<span id="cb7-1494">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale the unit vector by the minimum segment length.</span></span>
<span id="cb7-1495">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb7-1496">    mx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1497">    my <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1498">    min.segment.length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>((mx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (my <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-1499">  }</span>
<span id="cb7-1500">  </span>
<span id="cb7-1501">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">textbox =</span> label)</span>
<span id="cb7-1502">  </span>
<span id="cb7-1503">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (</span>
<span id="cb7-1504">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>point_inside_text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1505">    d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1506">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is greater than minimum.</span></span>
<span id="cb7-1507">    (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1508">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is less than from label to point center.</span></span>
<span id="cb7-1509">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1510">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than point size.</span></span>
<span id="cb7-1511">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim, point_pos <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dim) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-1512">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than from point edge to point center.</span></span>
<span id="cb7-1513">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(point_int, point_pos)</span>
<span id="cb7-1514">  ) {</span>
<span id="cb7-1515">    s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curveGrob</span>(</span>
<span id="cb7-1516">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-1517">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-1518">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-1519">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-1520">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-1521">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> segment.curvature,</span>
<span id="cb7-1522">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> segment.angle,</span>
<span id="cb7-1523">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> segment.ncp,</span>
<span id="cb7-1524">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> segment.shape,</span>
<span id="cb7-1525">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">square =</span> segment.square,</span>
<span id="cb7-1526">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squareShape =</span> segment.squareShape,</span>
<span id="cb7-1527">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inflect =</span> segment.inflect,</span>
<span id="cb7-1528">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> segment.debug,</span>
<span id="cb7-1529">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> segment.gp,</span>
<span id="cb7-1530">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segmentrepelgrob%s"</span>, i),</span>
<span id="cb7-1531">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow</span>
<span id="cb7-1532">    )</span>
<span id="cb7-1533">    grobs[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s</span>
<span id="cb7-1534">  }</span>
<span id="cb7-1535">  </span>
<span id="cb7-1536">  grobs</span>
<span id="cb7-1537">}</span>
<span id="cb7-1538"></span>
<span id="cb7-1539"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># similar to ggplot2:::rotate_just</span></span>
<span id="cb7-1540">rotate_just <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) {</span>
<span id="cb7-1541">  angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span></span>
<span id="cb7-1542">  </span>
<span id="cb7-1543">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(hjust)) {</span>
<span id="cb7-1544">    hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(hjust, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-1545">    hjust[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(hjust)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-1546">  }</span>
<span id="cb7-1547">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(vjust)) {</span>
<span id="cb7-1548">    vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match</span>(vjust, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-1549">    vjust[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(vjust)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-1550">  }</span>
<span id="cb7-1551">  </span>
<span id="cb7-1552">  size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(angle), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(hjust), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(vjust))</span>
<span id="cb7-1553">  angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(angle, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1554">  hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(hjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1555">  vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(vjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> size)</span>
<span id="cb7-1556">  </span>
<span id="cb7-1557">  case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">findInterval</span>(angle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>))</span>
<span id="cb7-1558">  </span>
<span id="cb7-1559">  hnew <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hjust</span>
<span id="cb7-1560">  vnew <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vjust</span>
<span id="cb7-1561">  </span>
<span id="cb7-1562">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 90 &lt;= x &lt; 180</span></span>
<span id="cb7-1563">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[is_case]</span>
<span id="cb7-1564">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> hjust[is_case]</span>
<span id="cb7-1565">  </span>
<span id="cb7-1566">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 180 &lt;= x &lt; 270</span></span>
<span id="cb7-1567">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[is_case]</span>
<span id="cb7-1568">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust[is_case]</span>
<span id="cb7-1569">  </span>
<span id="cb7-1570">  is_case <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(case <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 270 &lt;= x &lt; 360</span></span>
<span id="cb7-1571">  hnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> vjust[is_case]</span>
<span id="cb7-1572">  vnew[is_case] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust[is_case]</span>
<span id="cb7-1573">  </span>
<span id="cb7-1574">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hnew, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vnew)</span>
<span id="cb7-1575">}</span>
<span id="cb7-1576"></span>
<span id="cb7-1577"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Repulsive textual annotations.</span></span>
<span id="cb7-1578"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1579"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' \code{geom_text_repel} adds text directly to the plot.</span></span>
<span id="cb7-1580"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' \code{geom_label_repel} draws a rectangle underneath the text, making it</span></span>
<span id="cb7-1581"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' easier to read. The text labels repel away from each other and away from</span></span>
<span id="cb7-1582"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' the data points.</span></span>
<span id="cb7-1583"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1584"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' These geoms are based on \code{\link[ggplot2]{geom_text}} and</span></span>
<span id="cb7-1585"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' \code{\link[ggplot2]{geom_label}}. See the documentation for those</span></span>
<span id="cb7-1586"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' functions for more details. Differences from those functions are noted</span></span>
<span id="cb7-1587"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' here.</span></span>
<span id="cb7-1588"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1589"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Text labels have height and width, but they are physical units, not data</span></span>
<span id="cb7-1590"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' units. The amount of space they occupy on that plot is not constant in data</span></span>
<span id="cb7-1591"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' units: when you resize a plot, labels stay the same size, but the size of</span></span>
<span id="cb7-1592"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' the axes changes. The text labels are repositioned after resizing a plot.</span></span>
<span id="cb7-1593"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1594"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @section \code{geom_label_repel}:</span></span>
<span id="cb7-1595"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Currently \code{geom_label_repel} does not support the \code{rot} argument</span></span>
<span id="cb7-1596"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' and is considerably slower than \code{geom_text_repel}. The \code{fill}</span></span>
<span id="cb7-1597"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' aesthetic controls the background colour of the label.</span></span>
<span id="cb7-1598"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1599"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @section Alignment with \code{hjust} or \code{vjust}:</span></span>
<span id="cb7-1600"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' The arguments \code{hjust} and \code{vjust} are supported, but they only</span></span>
<span id="cb7-1601"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' control the initial positioning, so repulsive forces may disrupt alignment.</span></span>
<span id="cb7-1602"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Alignment with \code{hjust} will be preserved if labels only move up and down</span></span>
<span id="cb7-1603"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' by using \code{direction="y"}. For \code{vjust}, use \code{direction="x"}.</span></span>
<span id="cb7-1604"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1605"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param mapping Set of aesthetic mappings created by \code{\link[ggplot2]{aes}} or</span></span>
<span id="cb7-1606"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{\link[ggplot2]{aes_}}. If specified and \code{inherit.aes = TRUE} (the</span></span>
<span id="cb7-1607"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   default), is combined with the default mapping at the top level of the</span></span>
<span id="cb7-1608"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   plot. You only need to supply \code{mapping} if there isn't a mapping</span></span>
<span id="cb7-1609"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   defined for the plot.</span></span>
<span id="cb7-1610"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param data A data frame. If specified, overrides the default data frame</span></span>
<span id="cb7-1611"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   defined at the top level of the plot.</span></span>
<span id="cb7-1612"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param stat The statistical transformation to use on the data for this</span></span>
<span id="cb7-1613"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'    layer, as a string.</span></span>
<span id="cb7-1614"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param position Position adjustment, either as a string, or the result of</span></span>
<span id="cb7-1615"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'  a call to a position adjustment function.</span></span>
<span id="cb7-1616"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param parse If TRUE, the labels will be parsed into expressions and</span></span>
<span id="cb7-1617"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   displayed as described in ?plotmath</span></span>
<span id="cb7-1618"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param na.rm If \code{FALSE} (the default), removes missing values with</span></span>
<span id="cb7-1619"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'    a warning.  If \code{TRUE} silently removes missing values.</span></span>
<span id="cb7-1620"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param show.legend logical. Should this layer be included in the legends?</span></span>
<span id="cb7-1621"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{NA}, the default, includes if any aesthetics are mapped.</span></span>
<span id="cb7-1622"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{FALSE} never includes, and \code{TRUE} always includes.</span></span>
<span id="cb7-1623"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param inherit.aes If \code{FALSE}, overrides the default aesthetics,</span></span>
<span id="cb7-1624"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   rather than combining with them. This is most useful for helper functions</span></span>
<span id="cb7-1625"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   that define both data and aesthetics and shouldn't inherit behaviour from</span></span>
<span id="cb7-1626"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   the default plot specification, e.g. \code{\link[ggplot2]{borders}}.</span></span>
<span id="cb7-1627"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param ... other arguments passed on to \code{\link[ggplot2]{layer}}. There are</span></span>
<span id="cb7-1628"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   three types of arguments you can use here:</span></span>
<span id="cb7-1629"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1630"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \itemize{</span></span>
<span id="cb7-1631"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     \item Aesthetics: to set an aesthetic to a fixed value, like</span></span>
<span id="cb7-1632"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'        \code{colour = "red"} or \code{size = 3}.</span></span>
<span id="cb7-1633"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     \item Other arguments to the layer, for example you override the</span></span>
<span id="cb7-1634"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'       default \code{stat} associated with the layer.</span></span>
<span id="cb7-1635"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     \item Other arguments passed on to the stat.</span></span>
<span id="cb7-1636"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   }</span></span>
<span id="cb7-1637"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param nudge_x,nudge_y Horizontal and vertical adjustments to nudge the</span></span>
<span id="cb7-1638"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   starting position of each text label. The units for \code{nudge_x} and</span></span>
<span id="cb7-1639"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{nudge_y} are the same as for the data units on the x-axis and y-axis.</span></span>
<span id="cb7-1640"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param xlim,ylim Limits for the x and y axes. Text labels will be constrained</span></span>
<span id="cb7-1641"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   to these limits. By default, text labels are constrained to the entire plot</span></span>
<span id="cb7-1642"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   area.</span></span>
<span id="cb7-1643"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param box.padding Amount of padding around bounding box, as unit or number.</span></span>
<span id="cb7-1644"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   Defaults to 0.25. (Default unit is lines, but other units can be specified</span></span>
<span id="cb7-1645"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   by passing \code{unit(x, "units")}).</span></span>
<span id="cb7-1646"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param point.padding Amount of padding around labeled point, as unit or</span></span>
<span id="cb7-1647"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   number. Defaults to 0. (Default unit is lines, but other units can be</span></span>
<span id="cb7-1648"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   specified by passing \code{unit(x, "units")}).</span></span>
<span id="cb7-1649"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param min.segment.length Skip drawing segments shorter than this, as unit or</span></span>
<span id="cb7-1650"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   number. Defaults to 0.5. (Default unit is lines, but other units can be</span></span>
<span id="cb7-1651"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   specified by passing \code{unit(x, "units")}).</span></span>
<span id="cb7-1652"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param arrow specification for arrow heads, as created by \code{\link[grid]{arrow}}</span></span>
<span id="cb7-1653"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force Force of repulsion between overlapping text labels. Defaults</span></span>
<span id="cb7-1654"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   to 1.</span></span>
<span id="cb7-1655"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force_pull Force of attraction between a text label and its</span></span>
<span id="cb7-1656"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   corresponding data point. Defaults to 1.</span></span>
<span id="cb7-1657"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param max.time Maximum number of seconds to try to resolve overlaps.</span></span>
<span id="cb7-1658"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   Defaults to 0.5.</span></span>
<span id="cb7-1659"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param max.iter Maximum number of iterations to try to resolve overlaps.</span></span>
<span id="cb7-1660"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   Defaults to 10000.</span></span>
<span id="cb7-1661"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param max.overlaps Exclude text labels when they overlap too many other</span></span>
<span id="cb7-1662"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   things. For each text label, we count how many other text labels or other</span></span>
<span id="cb7-1663"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   data points it overlaps, and exclude the text label if it has too many overlaps.</span></span>
<span id="cb7-1664"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   Defaults to 10.</span></span>
<span id="cb7-1665"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param direction "both", "x", or "y" -- direction in which to adjust position of labels</span></span>
<span id="cb7-1666"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param seed Random seed passed to \code{\link[base]{set.seed}}. Defaults to</span></span>
<span id="cb7-1667"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{NA}, which means that \code{set.seed} will not be called.</span></span>
<span id="cb7-1668"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param verbose If \code{TRUE}, some diagnostics of the repel algorithm are printed</span></span>
<span id="cb7-1669"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1670"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @examples</span></span>
<span id="cb7-1671"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1672"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p &lt;- ggplot(mtcars,</span></span>
<span id="cb7-1673"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   aes(wt, mpg, label = rownames(mtcars), colour = factor(cyl))) +</span></span>
<span id="cb7-1674"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   geom_point()</span></span>
<span id="cb7-1675"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1676"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Avoid overlaps by repelling text labels</span></span>
<span id="cb7-1677"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel()</span></span>
<span id="cb7-1678"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Labels with background</span></span>
<span id="cb7-1679"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_label_repel()</span></span>
<span id="cb7-1680"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1681"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' \dontrun{</span></span>
<span id="cb7-1682"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(family = "Times New Roman",</span></span>
<span id="cb7-1683"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   box.padding = 0.5)</span></span>
<span id="cb7-1684"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1685"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Add aesthetic mappings</span></span>
<span id="cb7-1686"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(aes(alpha=wt, size=mpg))</span></span>
<span id="cb7-1687"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_label_repel(aes(fill=factor(cyl)), colour="white", segment.colour="black")</span></span>
<span id="cb7-1688"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1689"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Draw all line segments</span></span>
<span id="cb7-1690"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(min.segment.length = 0)</span></span>
<span id="cb7-1691"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1692"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Omit short line segments (default behavior)</span></span>
<span id="cb7-1693"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(min.segment.length = 0.5)</span></span>
<span id="cb7-1694"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1695"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Omit all line segments</span></span>
<span id="cb7-1696"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(segment.colour = NA)</span></span>
<span id="cb7-1697"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1698"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Repel just the labels and totally ignore the data points</span></span>
<span id="cb7-1699"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(point.size = NA)</span></span>
<span id="cb7-1700"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1701"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Hide some of the labels, but repel from all data points</span></span>
<span id="cb7-1702"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' mtcars$label &lt;- rownames(mtcars)</span></span>
<span id="cb7-1703"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' mtcars$label[1:15] &lt;- ""</span></span>
<span id="cb7-1704"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(data = mtcars, aes(wt, mpg, label = label))</span></span>
<span id="cb7-1705"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1706"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Nudge the starting positions</span></span>
<span id="cb7-1707"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(nudge_x = ifelse(mtcars$cyl == 6, 1, 0),</span></span>
<span id="cb7-1708"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'                     nudge_y = ifelse(mtcars$cyl == 6, 8, 0))</span></span>
<span id="cb7-1709"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1710"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Change the text size</span></span>
<span id="cb7-1711"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(aes(size = wt))</span></span>
<span id="cb7-1712"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Scale height of text, rather than sqrt(height)</span></span>
<span id="cb7-1713"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(aes(size = wt)) + scale_radius(range = c(3,6))</span></span>
<span id="cb7-1714"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1715"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # You can display expressions by setting parse = TRUE.  The</span></span>
<span id="cb7-1716"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # details of the display are described in ?plotmath, but note that</span></span>
<span id="cb7-1717"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # geom_text_repel uses strings, not expressions.</span></span>
<span id="cb7-1718"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p + geom_text_repel(aes(label = paste(wt, "^(", cyl, ")", sep = "")),</span></span>
<span id="cb7-1719"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   parse = TRUE)</span></span>
<span id="cb7-1720"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1721"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Add a text annotation</span></span>
<span id="cb7-1722"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p +</span></span>
<span id="cb7-1723"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   geom_text_repel() +</span></span>
<span id="cb7-1724"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   annotate(</span></span>
<span id="cb7-1725"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     "text", label = "plot mpg vs. wt",</span></span>
<span id="cb7-1726"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     x = 2, y = 15, size = 8, colour = "red"</span></span>
<span id="cb7-1727"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   )</span></span>
<span id="cb7-1728"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1729"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' # Add arrows</span></span>
<span id="cb7-1730"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' p +</span></span>
<span id="cb7-1731"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   geom_point(colour = "red") +</span></span>
<span id="cb7-1732"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   geom_text_repel(</span></span>
<span id="cb7-1733"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     arrow = arrow(length = unit(0.02, "npc")),</span></span>
<span id="cb7-1734"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'     box.padding = 1</span></span>
<span id="cb7-1735"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   )</span></span>
<span id="cb7-1736"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-1737"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' }</span></span>
<span id="cb7-1738"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-1739">geom_text_repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-1740">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>,</span>
<span id="cb7-1741">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1742">    ...,</span>
<span id="cb7-1743">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-1744">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-1745">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1746">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1747">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1748">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1749">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1750">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb7-1751">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel.max.overlaps"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb7-1752">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1753">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1754">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-1755">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-1756">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1757">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-1758">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>),</span>
<span id="cb7-1759">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-1760">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb7-1761">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1762">) {</span>
<span id="cb7-1763">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(nudge_y)) {</span>
<span id="cb7-1764">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">missing</span>(position)) {</span>
<span id="cb7-1765">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Specify either `position` or `nudge_x`/`nudge_y`"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">call. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-1766">    }</span>
<span id="cb7-1767">    position <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge_repel</span>(nudge_x, nudge_y)</span>
<span id="cb7-1768">  }</span>
<span id="cb7-1769">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Warn about limitations of the algorithm</span></span>
<span id="cb7-1770">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) {</span>
<span id="cb7-1771">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-1772">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: Repulsion works correctly only for rotation angles multiple of 90 degrees"</span></span>
<span id="cb7-1773">    )</span>
<span id="cb7-1774">  }</span>
<span id="cb7-1775">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">layer</span>(</span>
<span id="cb7-1776">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-1777">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> mapping,</span>
<span id="cb7-1778">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> stat,</span>
<span id="cb7-1779">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> GeomTextRepel,</span>
<span id="cb7-1780">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> position,</span>
<span id="cb7-1781">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> show.legend,</span>
<span id="cb7-1782">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> inherit.aes,</span>
<span id="cb7-1783">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">params =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb7-1784">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> parse,</span>
<span id="cb7-1785">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> na.rm,</span>
<span id="cb7-1786">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-1787">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-1788">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-1789">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow,</span>
<span id="cb7-1790">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force,</span>
<span id="cb7-1791">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-1792">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time,</span>
<span id="cb7-1793">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter,</span>
<span id="cb7-1794">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-1795">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> nudge_x,</span>
<span id="cb7-1796">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> nudge_y,</span>
<span id="cb7-1797">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> xlim,</span>
<span id="cb7-1798">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> ylim,</span>
<span id="cb7-1799">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">match.arg</span>(direction),</span>
<span id="cb7-1800">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed,</span>
<span id="cb7-1801">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-1802">      ...</span>
<span id="cb7-1803">    )</span>
<span id="cb7-1804">  )</span>
<span id="cb7-1805">}</span>
<span id="cb7-1806"></span>
<span id="cb7-1807"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' GeomTextRepel</span></span>
<span id="cb7-1808"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @rdname ggrepel</span></span>
<span id="cb7-1809"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @format NULL</span></span>
<span id="cb7-1810"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @usage NULL</span></span>
<span id="cb7-1811"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @seealso \link[ggplot2]{GeomText} from the ggplot2 package.</span></span>
<span id="cb7-1812"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @keywords internal</span></span>
<span id="cb7-1813"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-1814">GeomTextRepel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggproto</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GeomTextRepel"</span>, Geom,</span>
<span id="cb7-1815">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">required_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>),</span>
<span id="cb7-1816">                         </span>
<span id="cb7-1817">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-1818">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.88</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1819">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb7-1820">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1821">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.alpha =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1822">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1823">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1824">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1825">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.r =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb7-1826">                         ),</span>
<span id="cb7-1827">                         </span>
<span id="cb7-1828">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_panel =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-1829">    data, panel_scales, coord,</span>
<span id="cb7-1830">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parse =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1831">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-1832">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-1833">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-1834">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1835">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-1836">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1837">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-1838">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-1839">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>,</span>
<span id="cb7-1840">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb7-1841">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1842">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-1843">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-1844">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb7-1845">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>,</span>
<span id="cb7-1846">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-1847">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">getOption</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"verbose"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-1848">                         ) {</span>
<span id="cb7-1849">                           </span>
<span id="cb7-1850">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (parse) {</span>
<span id="cb7-1851">                             data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_safe</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label))</span>
<span id="cb7-1852">                           }</span>
<span id="cb7-1853">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">||</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label)))) {</span>
<span id="cb7-1854">                             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>()</span>
<span id="cb7-1855">                           }</span>
<span id="cb7-1856">                           </span>
<span id="cb7-1857">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if needed rename columns using our convention</span></span>
<span id="cb7-1858">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (this_dim <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)) {</span>
<span id="cb7-1859">                             this_orig <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%s_orig"</span>, this_dim)</span>
<span id="cb7-1860">                             this_nudge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nudge_%s"</span>, this_dim)</span>
<span id="cb7-1861">                             <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>this_nudge <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-1862">                               data[[this_nudge]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_dim]]</span>
<span id="cb7-1863">                               <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (this_orig <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data)) {</span>
<span id="cb7-1864">                                 data[[this_dim]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data[[this_orig]]</span>
<span id="cb7-1865">                                 data[[this_orig]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-1866">                               }</span>
<span id="cb7-1867">                             }</span>
<span id="cb7-1868">                           }</span>
<span id="cb7-1869">                           </span>
<span id="cb7-1870">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the nudges to the panel scales.</span></span>
<span id="cb7-1871">                           nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y)</span>
<span id="cb7-1872">                           nudges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(nudges, panel_scales)</span>
<span id="cb7-1873">                           </span>
<span id="cb7-1874">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the raw data to the panel scales.</span></span>
<span id="cb7-1875">                           data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(data, panel_scales)</span>
<span id="cb7-1876">                           </span>
<span id="cb7-1877">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The nudge is relative to the data.</span></span>
<span id="cb7-1878">                           data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x</span>
<span id="cb7-1879">                           data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nudges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y</span>
<span id="cb7-1880">                           </span>
<span id="cb7-1881">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform limits to panel scales.</span></span>
<span id="cb7-1882">                           limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xlim, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ylim)</span>
<span id="cb7-1883">                           limits <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> coord<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transform</span>(limits, panel_scales)</span>
<span id="cb7-1884">                           </span>
<span id="cb7-1885">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Allow Inf.</span></span>
<span id="cb7-1886">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(xlim)) {</span>
<span id="cb7-1887">                             limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> xlim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(xlim)]</span>
<span id="cb7-1888">                           }</span>
<span id="cb7-1889">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(ylim)) {</span>
<span id="cb7-1890">                             limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ylim[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(ylim)]</span>
<span id="cb7-1891">                           }</span>
<span id="cb7-1892">                           </span>
<span id="cb7-1893">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill NAs with defaults.</span></span>
<span id="cb7-1894">                           limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb7-1895">                           limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)]</span>
<span id="cb7-1896">                           </span>
<span id="cb7-1897">                           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert hjust and vjust to numeric if character</span></span>
<span id="cb7-1898">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust)) {</span>
<span id="cb7-1899">                             data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle)</span>
<span id="cb7-1900">                           }</span>
<span id="cb7-1901">                           <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.character</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust)) {</span>
<span id="cb7-1902">                             data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_just</span>(data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle)</span>
<span id="cb7-1903">                           }</span>
<span id="cb7-1904">                           </span>
<span id="cb7-1905">                           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggname</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geom_text_repel"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gTree</span>(</span>
<span id="cb7-1906">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> limits,</span>
<span id="cb7-1907">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> data,</span>
<span id="cb7-1908">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lab =</span> data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label,</span>
<span id="cb7-1909">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(box.padding),</span>
<span id="cb7-1910">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding),</span>
<span id="cb7-1911">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(min.segment.length),</span>
<span id="cb7-1912">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow,</span>
<span id="cb7-1913">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> force,</span>
<span id="cb7-1914">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> force_pull,</span>
<span id="cb7-1915">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.time =</span> max.time,</span>
<span id="cb7-1916">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.iter =</span> max.iter,</span>
<span id="cb7-1917">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max.overlaps =</span> max.overlaps,</span>
<span id="cb7-1918">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> direction,</span>
<span id="cb7-1919">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> seed,</span>
<span id="cb7-1920">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> verbose,</span>
<span id="cb7-1921">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cl =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"textrepeltree"</span></span>
<span id="cb7-1922">                           ))</span>
<span id="cb7-1923">                         },</span>
<span id="cb7-1924">    </span>
<span id="cb7-1925">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">draw_key =</span> draw_key_text</span>
<span id="cb7-1926">)</span>
<span id="cb7-1927"></span>
<span id="cb7-1928"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' grid::makeContent function for the grobTree of textRepelGrob objects</span></span>
<span id="cb7-1929"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param x A grid grobTree.</span></span>
<span id="cb7-1930"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @export</span></span>
<span id="cb7-1931"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-1932">makeContent.textrepeltree <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb7-1933">  </span>
<span id="cb7-1934">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each bounding box.</span></span>
<span id="cb7-1935">  box_padding_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1936">  box_padding_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1937">  </span>
<span id="cb7-1938">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The padding around each point.</span></span>
<span id="cb7-1939">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding)) {</span>
<span id="cb7-1940">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb7-1941">  }</span>
<span id="cb7-1942">  </span>
<span id="cb7-1943">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do not create text labels for empty strings.</span></span>
<span id="cb7-1944">  valid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab))</span>
<span id="cb7-1945">  invalid_strings <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">not_empty</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab))</span>
<span id="cb7-1946">  ix <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(valid_strings, invalid_strings)</span>
<span id="cb7-1947">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[ix,]</span>
<span id="cb7-1948">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[ix]</span>
<span id="cb7-1949">  </span>
<span id="cb7-1950">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a dataframe with x1 y1 x2 y2</span></span>
<span id="cb7-1951">  boxes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-1952">    row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-1953">    tg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textGrob</span>(</span>
<span id="cb7-1954">      x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[i],</span>
<span id="cb7-1955">      row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-1956">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle,</span>
<span id="cb7-1957">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust,</span>
<span id="cb7-1958">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust,</span>
<span id="cb7-1959">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-1960">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize   =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-1961">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontfamily =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-1962">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface   =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fontface,</span>
<span id="cb7-1963">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight</span>
<span id="cb7-1964">      )</span>
<span id="cb7-1965">    )</span>
<span id="cb7-1966">    x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobX</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1967">    x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobX</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1968">    y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobY</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1969">    y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobY</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1970">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-1971">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-1972">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y,</span>
<span id="cb7-1973">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_x,</span>
<span id="cb7-1974">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> box_padding_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>nudge_y</span>
<span id="cb7-1975">    )</span>
<span id="cb7-1976">  })</span>
<span id="cb7-1977">  </span>
<span id="cb7-1978">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the repulsion reproducible if desired.</span></span>
<span id="cb7-1979">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed)) {</span>
<span id="cb7-1980">    x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample.int</span>(.Machine<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>integer.max, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L)</span>
<span id="cb7-1981">  }</span>
<span id="cb7-1982">  </span>
<span id="cb7-1983">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The points are represented by circles.</span></span>
<span id="cb7-1984">  x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size)] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-1985">  </span>
<span id="cb7-1986">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Beware the magic numbers. I do not understand them.</span></span>
<span id="cb7-1987">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I just accept them as necessary to get the code to work.</span></span>
<span id="cb7-1988">  p_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1989">  p_height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inch"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-1990">  p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (p_width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> p_height)</span>
<span id="cb7-1991">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb7-1992">    p_ratio <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.15</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p_ratio))</span>
<span id="cb7-1993">  }</span>
<span id="cb7-1994">  point_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-1995">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.size), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1996">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-1997">  point_padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> p_ratio <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(</span>
<span id="cb7-1998">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valueOnly =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-1999">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span></span>
<span id="cb7-2000">  </span>
<span id="cb7-2001">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Repel overlapping bounding boxes away from each other.</span></span>
<span id="cb7-2002">  repel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with_seed_null</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>seed, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">repel_boxes2</span>(</span>
<span id="cb7-2003">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data_points     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]),</span>
<span id="cb7-2004">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_size      =</span> point_size,</span>
<span id="cb7-2005">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_x =</span> point_padding,</span>
<span id="cb7-2006">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_padding_y =</span> point_padding,</span>
<span id="cb7-2007">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">boxes           =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind, boxes),</span>
<span id="cb7-2008">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x),</span>
<span id="cb7-2009">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim            =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>limits<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y),</span>
<span id="cb7-2010">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2011">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust           =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2012">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_push      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-2013">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull      =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>force_pull <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>,</span>
<span id="cb7-2014">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_time        =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.time,</span>
<span id="cb7-2015">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_iter        =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.infinite</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e9</span>, x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.iter),</span>
<span id="cb7-2016">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_overlaps    =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>max.overlaps,</span>
<span id="cb7-2017">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction       =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>direction,</span>
<span id="cb7-2018">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose         =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose</span>
<span id="cb7-2019">  ))</span>
<span id="cb7-2020">  </span>
<span id="cb7-2021">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>verbose <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-2022">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">message</span>(</span>
<span id="cb7-2023">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(</span>
<span id="cb7-2024">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggrepel: %s unlabeled data points (too many overlaps). Consider increasing 'max.overlaps'"</span>,</span>
<span id="cb7-2025">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)</span>
<span id="cb7-2026">      )</span>
<span id="cb7-2027">    )</span>
<span id="cb7-2028">  }</span>
<span id="cb7-2029">  </span>
<span id="cb7-2030">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps)) {</span>
<span id="cb7-2031">    grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>()</span>
<span id="cb7-2032">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-2033">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs))</span>
<span id="cb7-2034">  }</span>
<span id="cb7-2035">  </span>
<span id="cb7-2036">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(valid_strings), <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-2037">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>too_many_overlaps[i]) {</span>
<span id="cb7-2038">      row <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>data[i, , drop <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>]</span>
<span id="cb7-2039">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">makeTextRepelGrobs</span>(</span>
<span id="cb7-2040">        i,</span>
<span id="cb7-2041">        x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lab[i],</span>
<span id="cb7-2042">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of text bounding boxes.</span></span>
<span id="cb7-2043">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-2044">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(repel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[i], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>),</span>
<span id="cb7-2045">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-2046">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,</span>
<span id="cb7-2047">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y,</span>
<span id="cb7-2048">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>angle,</span>
<span id="cb7-2049">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>box.padding,</span>
<span id="cb7-2050">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> point_size[i],</span>
<span id="cb7-2051">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point.padding,</span>
<span id="cb7-2052">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.curvature,</span>
<span id="cb7-2053">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle     =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.angle,</span>
<span id="cb7-2054">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp       =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.ncp,</span>
<span id="cb7-2055">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.shape,</span>
<span id="cb7-2056">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.square,</span>
<span id="cb7-2057">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.squareShape,</span>
<span id="cb7-2058">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.inflect,</span>
<span id="cb7-2059">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.debug,</span>
<span id="cb7-2060">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-2061">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-2062">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontsize =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-2063">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontfamily =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>family,</span>
<span id="cb7-2064">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fontface,</span>
<span id="cb7-2065">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>lineheight</span>
<span id="cb7-2066">        ),</span>
<span id="cb7-2067">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(</span>
<span id="cb7-2068">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.colour <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-2069">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .pt,</span>
<span id="cb7-2070">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lty =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>segment.linetype <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%||%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-2071">        ),</span>
<span id="cb7-2072">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>arrow,</span>
<span id="cb7-2073">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>min.segment.length,</span>
<span id="cb7-2074">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hjust,</span>
<span id="cb7-2075">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vjust,</span>
<span id="cb7-2076">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>bg.colour, row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>alpha),</span>
<span id="cb7-2077">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.r =</span> row<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>bg.r</span>
<span id="cb7-2078">      )</span>
<span id="cb7-2079">    }</span>
<span id="cb7-2080">  })</span>
<span id="cb7-2081">  </span>
<span id="cb7-2082">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unlist</span>(grobs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">recursive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb7-2083">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">class</span>(grobs) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gList"</span></span>
<span id="cb7-2084">  </span>
<span id="cb7-2085">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Put segment grobs before text grobs.</span></span>
<span id="cb7-2086">  grob_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sapply</span>(grobs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[["</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>)</span>
<span id="cb7-2087">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grobs[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^segment"</span>, grob_names))]</span>
<span id="cb7-2088">  </span>
<span id="cb7-2089">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setChildren</span>(x, grobs)</span>
<span id="cb7-2090">}</span>
<span id="cb7-2091"></span>
<span id="cb7-2092">makeTextRepelGrobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-2093">    i,</span>
<span id="cb7-2094">    label,</span>
<span id="cb7-2095">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of text bounding boxes.</span></span>
<span id="cb7-2096">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-2097">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-2098">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position of original data points.</span></span>
<span id="cb7-2099">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x.orig =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y.orig =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-2102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>,</span>
<span id="cb7-2103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb7-2104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-2105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>,</span>
<span id="cb7-2106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.curvature =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-2107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb7-2108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-2109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.shape =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.square =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb7-2111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.squareShape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-2112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.inflect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-2113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.debug =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-2114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-2116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(),</span>
<span id="cb7-2117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb7-2122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-2123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.r =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-2124">) {</span>
<span id="cb7-2125">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stopifnot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(label) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-2126">  </span>
<span id="cb7-2127">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x))</span>
<span id="cb7-2128">    x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, default.units)</span>
<span id="cb7-2129">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(y))</span>
<span id="cb7-2130">    y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(y, default.units)</span>
<span id="cb7-2131">  </span>
<span id="cb7-2132">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># support any angle by converting to -360..360</span></span>
<span id="cb7-2133">  rot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span></span>
<span id="cb7-2134">  </span>
<span id="cb7-2135">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instead of the width and height of the Grob we use the dimensions of the</span></span>
<span id="cb7-2136">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># character string which are independent of rotation, matching those of</span></span>
<span id="cb7-2137">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a textGrob built with rot = 0.</span></span>
<span id="cb7-2138">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To support rotation height and width need to be expressed in units that</span></span>
<span id="cb7-2139">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># are consistent on x and y axes, such as "char".</span></span>
<span id="cb7-2140">  string.height <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stringHeight</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"char"</span>)</span>
<span id="cb7-2141">  string.width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stringWidth</span>(label), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"char"</span>)</span>
<span id="cb7-2142">  </span>
<span id="cb7-2143">  rot_radians <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rot <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span></span>
<span id="cb7-2144">  </span>
<span id="cb7-2145">  x_adj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(rot_radians) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> string.width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-2146">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(rot_radians) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> string.height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust)</span>
<span id="cb7-2147">  y_adj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(rot_radians) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> string.height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> vjust) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb7-2148">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(rot_radians) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> string.width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> hjust)</span>
<span id="cb7-2149">  </span>
<span id="cb7-2150">  grobs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shadowtextGrob</span>(</span>
<span id="cb7-2151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label,</span>
<span id="cb7-2152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_adj,</span>
<span id="cb7-2153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_adj,</span>
<span id="cb7-2154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> rot,</span>
<span id="cb7-2155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-2156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust,</span>
<span id="cb7-2157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust,</span>
<span id="cb7-2158">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> text.gp,</span>
<span id="cb7-2159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"textrepelgrob%s"</span>, i),</span>
<span id="cb7-2160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.colour =</span> bg.colour,</span>
<span id="cb7-2161">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.r =</span> bg.r</span>
<span id="cb7-2162">  )</span>
<span id="cb7-2163">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the regular textgrob will always be the last one</span></span>
<span id="cb7-2164">  tg <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> grobs[[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(grobs)]]</span>
<span id="cb7-2165">  </span>
<span id="cb7-2166">  x1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobX</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2167">  x2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobX</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2168">  y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobY</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2169">  y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grobY</span>(tg, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2170">  </span>
<span id="cb7-2171">  point_pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x.orig, y.orig)</span>
<span id="cb7-2172">  </span>
<span id="cb7-2173">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinates of the intersection between the line from the</span></span>
<span id="cb7-2174">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># original data point to the centroid and the rectangle's edges.</span></span>
<span id="cb7-2175">  extra_padding_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-2176">  extra_padding_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-2177">  text_box <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb7-2178">    x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> extra_padding_x, y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> extra_padding_y,</span>
<span id="cb7-2179">    x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> extra_padding_x, y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> extra_padding_y</span>
<span id="cb7-2180">  )</span>
<span id="cb7-2181">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#int &lt;- intersect_line_rectangle(point_pos, center, text_box)</span></span>
<span id="cb7-2182">  int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_line_connection</span>(point_pos, text_box)</span>
<span id="cb7-2183">  </span>
<span id="cb7-2184">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the data point is inside the label box.</span></span>
<span id="cb7-2185">  point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb7-2186">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2187">      text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> point_pos[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> text_box[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]) {</span>
<span id="cb7-2188">    point_inside_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-2189">  }</span>
<span id="cb7-2190">  </span>
<span id="cb7-2191">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This seems just fine.</span></span>
<span id="cb7-2192">  point.padding <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_unit</span>(point.padding), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb7-2193">  </span>
<span id="cb7-2194">  point_int <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">intersect_line_circle</span>(int, point_pos, (point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point.padding))</span>
<span id="cb7-2195">  </span>
<span id="cb7-2196">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute the distance between the data point and the edge of the text box.</span></span>
<span id="cb7-2197">  dx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb7-2198">  dy <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb7-2199">  d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy)</span>
<span id="cb7-2200">  </span>
<span id="cb7-2201">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale the unit vector by the minimum segment length.</span></span>
<span id="cb7-2202">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb7-2203">    mx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertWidth</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2204">    my <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convertHeight</span>(min.segment.length, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb7-2205">    min.segment.length <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>((mx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (my <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> dy <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-2206">  }</span>
<span id="cb7-2207">  </span>
<span id="cb7-2208">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (</span>
<span id="cb7-2209">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>point_inside_text <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2210">    d <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2211">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is greater than minimum.</span></span>
<span id="cb7-2212">    (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> min.segment.length) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2213">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point edge is less than from label to point center.</span></span>
<span id="cb7-2214">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_int) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2215">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than point size.</span></span>
<span id="cb7-2216">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> point.size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span></span>
<span id="cb7-2217">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Distance from label to point center is greater than from point edge to point center.</span></span>
<span id="cb7-2218">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(int, point_pos) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">euclid</span>(point_int, point_pos)</span>
<span id="cb7-2219">  ) {</span>
<span id="cb7-2220">    s <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curveGrob</span>(</span>
<span id="cb7-2221">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-2222">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-2223">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb7-2224">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> point_int[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb7-2225">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"native"</span>,</span>
<span id="cb7-2226">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">curvature =</span> segment.curvature,</span>
<span id="cb7-2227">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> segment.angle,</span>
<span id="cb7-2228">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> segment.ncp,</span>
<span id="cb7-2229">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> segment.shape,</span>
<span id="cb7-2230">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">square =</span> segment.square,</span>
<span id="cb7-2231">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">squareShape =</span> segment.squareShape,</span>
<span id="cb7-2232">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inflect =</span> segment.inflect,</span>
<span id="cb7-2233">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">debug =</span> segment.debug,</span>
<span id="cb7-2234">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> segment.gp,</span>
<span id="cb7-2235">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segmentrepelgrob%s"</span>, i),</span>
<span id="cb7-2236">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> arrow</span>
<span id="cb7-2237">    )</span>
<span id="cb7-2238">    grobs[[s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name]] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> s</span>
<span id="cb7-2239">  }</span>
<span id="cb7-2240">  </span>
<span id="cb7-2241">  grobs</span>
<span id="cb7-2242">}</span>
<span id="cb7-2243"></span>
<span id="cb7-2244"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># copied from ggplot2</span></span>
<span id="cb7-2245">compute_just <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(just, a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> a, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb7-2246">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  As justification direction is relative to the text, not the plotting area</span></span>
<span id="cb7-2247">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  we need to swap x and y if text direction is rotated so that hjust is</span></span>
<span id="cb7-2248">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  applied along y and vjust along x.</span></span>
<span id="cb7-2249">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outward|inward"</span>, just))) {</span>
<span id="cb7-2250">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure all angles are in -360...+360</span></span>
<span id="cb7-2251">    angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span></span>
<span id="cb7-2252">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ensure correct behaviour for angles in -360...+360</span></span>
<span id="cb7-2253">    angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, angle)</span>
<span id="cb7-2254">    angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, angle)</span>
<span id="cb7-2255">    rotated_forward <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb7-2256">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outward|inward"</span>, just) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span>)</span>
<span id="cb7-2257">    rotated_backwards <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb7-2258">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outward|inward"</span>, just) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> angle <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span>)</span>
<span id="cb7-2259">    </span>
<span id="cb7-2260">    ab <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(rotated_forward <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> rotated_backwards, b, a)</span>
<span id="cb7-2261">    just_swap <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rotated_backwards <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span></span>
<span id="cb7-2262">    inward <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb7-2263">      (just <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inward"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>just_swap <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> just <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outward"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> just_swap)</span>
<span id="cb7-2264">    just[inward] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"middle"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">just_dir</span>(ab[inward])]</span>
<span id="cb7-2265">    outward <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb7-2266">      (just <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"outward"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>just_swap) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> (just <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inward"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> just_swap)</span>
<span id="cb7-2267">    just[outward] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"middle"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">just_dir</span>(ab[outward])]</span>
<span id="cb7-2268">    </span>
<span id="cb7-2269">  }</span>
<span id="cb7-2270">  </span>
<span id="cb7-2271">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unname</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">left =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">right =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb7-2272">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bottom =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">middle =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[just])</span>
<span id="cb7-2273">}</span>
<span id="cb7-2274"></span>
<span id="cb7-2275"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># copied from ggplot2</span></span>
<span id="cb7-2276">just_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tol =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) {</span>
<span id="cb7-2277">  out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>L, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x))</span>
<span id="cb7-2278">  out[x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> tol] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>L</span>
<span id="cb7-2279">  out[x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> tol] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>L</span>
<span id="cb7-2280">  out</span>
<span id="cb7-2281">}</span>
<span id="cb7-2282"></span>
<span id="cb7-2283"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adapted from shadowtext, at the time of writing located at:</span></span>
<span id="cb7-2284"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://github.com/GuangchuangYu/shadowtext/blob/325d25919b28ccd4184c6363c11c8c26e822dd95/R/shadowtext-grob.R#L28</span></span>
<span id="cb7-2285"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This function was modified to always return a gList,</span></span>
<span id="cb7-2286"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># whether bg.colour is NA or not.</span></span>
<span id="cb7-2287"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Each background textgrob is made to have a unique name, otherwise</span></span>
<span id="cb7-2288"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># it can mess up the plotting order.</span></span>
<span id="cb7-2289">shadowtextGrob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(</span>
<span id="cb7-2290">    label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>),</span>
<span id="cb7-2291">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb7-2292">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gpar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb7-2293">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg.r =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb7-2294">) {</span>
<span id="cb7-2295">  upperGrob <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textGrob</span>(</span>
<span id="cb7-2296">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust,</span>
<span id="cb7-2297">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> rot, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> default.units,</span>
<span id="cb7-2298">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.overlap =</span> check.overlap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> name, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> gp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> vp</span>
<span id="cb7-2299">  )</span>
<span id="cb7-2300">  </span>
<span id="cb7-2301">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(bg.colour)) {</span>
<span id="cb7-2302">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gList</span>(upperGrob)</span>
<span id="cb7-2303">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-2304">    gp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bg.colour</span>
<span id="cb7-2305">    </span>
<span id="cb7-2306">    theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb7-2307">    char <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span></span>
<span id="cb7-2308">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># char &lt;- substring(label[1], 1, 1)</span></span>
<span id="cb7-2309">    r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bg.r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb7-2310">    </span>
<span id="cb7-2311">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(x)) {</span>
<span id="cb7-2312">      x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(x, default.units)</span>
<span id="cb7-2313">    }</span>
<span id="cb7-2314">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.unit</span>(y)) {</span>
<span id="cb7-2315">      y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(y, default.units)</span>
<span id="cb7-2316">    }</span>
<span id="cb7-2317">    </span>
<span id="cb7-2318">    bgList <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(theta, <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb7-2319">      x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(i) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"strheight"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> char)</span>
<span id="cb7-2320">      y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(i) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> r, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"strheight"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> char)</span>
<span id="cb7-2321">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">textGrob</span>(</span>
<span id="cb7-2322">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> hjust,</span>
<span id="cb7-2323">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rot =</span> rot, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default.units =</span> default.units,</span>
<span id="cb7-2324">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check.overlap =</span> check.overlap, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-shadowtext"</span>, i), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gp =</span> gp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vp =</span> vp</span>
<span id="cb7-2325">      )</span>
<span id="cb7-2326">    })</span>
<span id="cb7-2327">    </span>
<span id="cb7-2328">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(gList, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bgList, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(upperGrob)))</span>
<span id="cb7-2329">  }</span>
<span id="cb7-2330">}</span>
<span id="cb7-2331"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generated by using Rcpp::compileAttributes() -&gt; do not edit by hand</span></span>
<span id="cb7-2332"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393</span></span>
<span id="cb7-2333"></span>
<span id="cb7-2334"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Euclidean distance between two points.</span></span>
<span id="cb7-2335"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A point.</span></span>
<span id="cb7-2336"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A point.</span></span>
<span id="cb7-2337"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return The distance between two points.</span></span>
<span id="cb7-2338"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2339"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2340"></span>
<span id="cb7-2341"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Squared Euclidean distance between two points.</span></span>
<span id="cb7-2342"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A point.</span></span>
<span id="cb7-2343"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A point.</span></span>
<span id="cb7-2344"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return The distance between two points.</span></span>
<span id="cb7-2345"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2346"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2347"></span>
<span id="cb7-2348"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Move a box into the area specificied by x limits and y limits.</span></span>
<span id="cb7-2349"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2350"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param xlim A Point with limits on the x axis like \code{c(xmin, xmax)}</span></span>
<span id="cb7-2351"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param ylim A Point with limits on the y axis like \code{c(xmin, xmax)}</span></span>
<span id="cb7-2352"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force Magnitude of the force (defaults to \code{1e-6})</span></span>
<span id="cb7-2353"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2354"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2355"></span>
<span id="cb7-2356"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Get the coordinates of the center of a box.</span></span>
<span id="cb7-2357"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2358"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2359"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2360"></span>
<span id="cb7-2361"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Test if a box overlaps another box.</span></span>
<span id="cb7-2362"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2363"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2364"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2365"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2366"></span>
<span id="cb7-2367"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Test if a box overlaps another box.</span></span>
<span id="cb7-2368"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2369"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2370"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2371"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2372"></span>
<span id="cb7-2373"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Compute the repulsion force upon point \code{a} from point \code{b}.</span></span>
<span id="cb7-2374"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-2375"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' The force decays with the squared distance between the points, similar</span></span>
<span id="cb7-2376"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' to the force of repulsion between magnets.</span></span>
<span id="cb7-2377"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-2378"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A point like \code{c(x, y)}</span></span>
<span id="cb7-2379"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A point like \code{c(x, y)}</span></span>
<span id="cb7-2380"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force Magnitude of the force (defaults to \code{1e-6})</span></span>
<span id="cb7-2381"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param direction direction in which to exert force, either "both", "x", or "y"</span></span>
<span id="cb7-2382"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2383"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2384"></span>
<span id="cb7-2385"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Compute the spring force upon point \code{a} from point \code{b}.</span></span>
<span id="cb7-2386"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-2387"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' The force increases with the distance between the points, similar</span></span>
<span id="cb7-2388"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' to Hooke's law for springs.</span></span>
<span id="cb7-2389"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'</span></span>
<span id="cb7-2390"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A point like \code{c(x, y)}</span></span>
<span id="cb7-2391"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A point like \code{c(x, y)}</span></span>
<span id="cb7-2392"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force Magnitude of the force (defaults to \code{1e-6})</span></span>
<span id="cb7-2393"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param direction direction in which to exert force, either "both", "x", or "y"</span></span>
<span id="cb7-2394"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2395"><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb7-2396"></span>
<span id="cb7-2397"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Euclidean distance between two points.</span></span>
<span id="cb7-2398"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param a A numeric vector.</span></span>
<span id="cb7-2399"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A numeric vector.</span></span>
<span id="cb7-2400"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @return The distance between two points.</span></span>
<span id="cb7-2401"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2402">euclid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(a, b) {</span>
<span id="cb7-2403">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_euclid'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, a, b)</span>
<span id="cb7-2404">}</span>
<span id="cb7-2405"></span>
<span id="cb7-2406"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Get the coordinates of the center of a box.</span></span>
<span id="cb7-2407"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A box like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2408"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2409">centroid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(b, hjust, vjust) {</span>
<span id="cb7-2410">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_centroid'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, b, hjust, vjust)</span>
<span id="cb7-2411">}</span>
<span id="cb7-2412"></span>
<span id="cb7-2413"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Find the intersections between a line and a rectangle.</span></span>
<span id="cb7-2414"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param c A circle like \code{c(x, y, r)}</span></span>
<span id="cb7-2415"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param r A rectangle like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2416"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2417">intersect_circle_rectangle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(c, r) {</span>
<span id="cb7-2418">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_intersect_circle_rectangle'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, c, r)</span>
<span id="cb7-2419">}</span>
<span id="cb7-2420"></span>
<span id="cb7-2421"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Find the intersection between a line and a circle.</span></span>
<span id="cb7-2422"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param p1 A point on the line like \code{c(x, y)}</span></span>
<span id="cb7-2423"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param p2 A point at the circle's center</span></span>
<span id="cb7-2424"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param r The circle's radius</span></span>
<span id="cb7-2425"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2426">intersect_line_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(p1, p2, r) {</span>
<span id="cb7-2427">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_intersect_line_circle'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, p1, p2, r)</span>
<span id="cb7-2428">}</span>
<span id="cb7-2429"></span>
<span id="cb7-2430"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Find the intersections between a line and a rectangle.</span></span>
<span id="cb7-2431"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param p1 A point like \code{c(x, y)}</span></span>
<span id="cb7-2432"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param p2 A point like \code{c(x, y)}</span></span>
<span id="cb7-2433"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param b A rectangle like \code{c(x1, y1, x2, y2)}</span></span>
<span id="cb7-2434"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2435">intersect_line_rectangle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(p1, p2, b) {</span>
<span id="cb7-2436">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_intersect_line_rectangle'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, p1, p2, b)</span>
<span id="cb7-2437">}</span>
<span id="cb7-2438"></span>
<span id="cb7-2439">select_line_connection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(p1, b) {</span>
<span id="cb7-2440">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_select_line_connection'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, p1, b)</span>
<span id="cb7-2441">}</span>
<span id="cb7-2442"></span>
<span id="cb7-2443">approximately_equal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x1, x2) {</span>
<span id="cb7-2444">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_approximately_equal'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, x1, x2)</span>
<span id="cb7-2445">}</span>
<span id="cb7-2446"></span>
<span id="cb7-2447"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' Adjust the layout of a list of potentially overlapping boxes.</span></span>
<span id="cb7-2448"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param data_points A numeric matrix with rows representing points like</span></span>
<span id="cb7-2449"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{rbind(c(x, y), c(x, y), ...)}</span></span>
<span id="cb7-2450"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param point_size A numeric vector representing the sizes of data points.</span></span>
<span id="cb7-2451"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param point_padding_x Padding around each data point on the x axis.</span></span>
<span id="cb7-2452"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param point_padding_y Padding around each data point on the y axis.</span></span>
<span id="cb7-2453"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param boxes A numeric matrix with rows representing boxes like</span></span>
<span id="cb7-2454"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{rbind(c(x1, y1, x2, y2), c(x1, y1, x2, y2), ...)}</span></span>
<span id="cb7-2455"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param xlim A numeric vector representing the limits on the x axis like</span></span>
<span id="cb7-2456"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{c(xmin, xmax)}</span></span>
<span id="cb7-2457"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param ylim A numeric vector representing the limits on the y axis like</span></span>
<span id="cb7-2458"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   \code{c(ymin, ymax)}</span></span>
<span id="cb7-2459"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param force Magnitude of the force (defaults to \code{1e-6})</span></span>
<span id="cb7-2460"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param max_time Maximum number of seconds to try to resolve overlaps</span></span>
<span id="cb7-2461"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   (defaults to 0.1)</span></span>
<span id="cb7-2462"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @param max_iter Maximum number of iterations to try to resolve overlaps</span></span>
<span id="cb7-2463"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#'   (defaults to 2000)</span></span>
<span id="cb7-2464"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#' @noRd</span></span>
<span id="cb7-2465">repel_boxes2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(data_points, point_size, point_padding_x, point_padding_y, boxes, xlim, ylim, hjust, vjust, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_push =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_time =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_overlaps =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">max_iter =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>L) {</span>
<span id="cb7-2466">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">.Call</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_ggrepel_repel_boxes2'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PACKAGE =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ggrepel'</span>, data_points, point_size, point_padding_x, point_padding_y, boxes, xlim, ylim, hjust, vjust, force_push, force_pull, max_time, max_overlaps, max_iter, direction, verbose)</span>
<span id="cb7-2467">}</span></code></pre></div>
</details>
</div>
</section>
<section id="create-repelled-marquee-text-plot" class="level3">
<h3 class="anchored" data-anchor-id="create-repelled-marquee-text-plot">Create repelled marquee text plot</h3>
<p>This map leverages <a href="https://github.com/slowkow/ggrepel"><code>geom_marquee_repel()</code></a> to create richly formatted, non-overlapping labels for 37 UK Met Office weather stations, each displaying the station name, opening year, and three color-coded climate extremes (maximum temperature in red, minimum temperature in teal, and maximum rainfall in blue). The implementation uses <a href="https://github.com/r-lib/marquee"><code>marquee::marquee_glue()</code></a> to construct markdown-formatted labels with custom colors and bold text, while the repulsion algorithm (controlled by <code>force = 5</code> and <code>force_pull = 0.5</code> parameters) automatically positions these labels to avoid overlaps with both the data points and each other. The styling is managed through <a href="https://github.com/r-lib/marquee"><code>marquee::classic_style()</code></a>, which sets a condensed, lightweight font with custom line height and center alignment, while <a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>ggplot2::geom_sf()</code></a> renders the base map and weather station points. Additional annotations are added using <a href="https://github.com/wilkelab/ggtext"><code>ggtext::element_markdown()</code></a> for the caption and <a href="https://ggplot2.tidyverse.org/reference/annotate.html"><code>annotate()</code></a> with <code>geom = "richtext"</code> for the legend. This combination of <a href="https://github.com/r-lib/marquee"><strong>{marquee}</strong></a>’s rich text capabilities and <a href="https://github.com/slowkow/ggrepel"><strong>{ggrepel}</strong></a>’s intelligent positioning creates a clean, readable visualization that would be difficult to achieve with standard <a href="https://ggplot2.tidyverse.org/"><strong>{ggplot2}</strong></a> text geoms, especially given the density of information and the geographic constraints of the map.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span></span>
<span id="cb8-2">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Visualizing historic meteorological</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">data from 37 UK Met Office weather</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">stations (1853-2025).</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Created by combining</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{ggplot2}, {ggrepel}, and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">{marquee} + {ggtext} to</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">display extreme</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">temperature and</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">rainfall records</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">across Britain."</span></span>
<span id="cb8-3">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> british_map,</span>
<span id="cb8-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> name),</span>
<span id="cb8-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb8-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb8-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb8-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>)</span>
<span id="cb8-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb8-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb8-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,</span>
<span id="cb8-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_marquee_repel</span>(</span>
<span id="cb8-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb8-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">marquee_glue</span>(</span>
<span id="cb8-24">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"### {#4d4d4d {station_name}} "</span>,</span>
<span id="cb8-25">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{#4d4d4d ({opened})} </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> "</span>,</span>
<span id="cb8-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{#D9565CFF **{tmax}**} ({tmax_month}) </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  "</span>,</span>
<span id="cb8-27">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{#1BB6AFFF **{tmin}**} ({tmin_month})  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb8-28">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{#0076C0FF **{rain}**} ({rain_month})"</span></span>
<span id="cb8-29">      ),</span>
<span id="cb8-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry</span>
<span id="cb8-31">    ),</span>
<span id="cb8-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span>,</span>
<span id="cb8-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb8-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>,</span>
<span id="cb8-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.colour =</span> text_col,         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change segment color</span></span>
<span id="cb8-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust line thickness</span></span>
<span id="cb8-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust transparency</span></span>
<span id="cb8-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">box.padding =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, </span>
<span id="cb8-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">style =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">classic_style</span>(</span>
<span id="cb8-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight      =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"light"</span>,</span>
<span id="cb8-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width       =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"condensed"</span>,</span>
<span id="cb8-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size   =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,</span>
<span id="cb8-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight  =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color       =</span> text_hil,</span>
<span id="cb8-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">background  =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">align       =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"center"</span>,</span>
<span id="cb8-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin      =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trbl</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb8-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">padding     =</span> marquee<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">trbl</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb8-52">    )</span>
<span id="cb8-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-54">  </span>
<span id="cb8-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb8-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">8.3</span>,</span>
<span id="cb8-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">51.5</span>,</span>
<span id="cb8-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb8-60">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;"</span>,</span>
<span id="cb8-61">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Met Station"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb8-62">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt; ("</span>, </span>
<span id="cb8-63">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year Opened"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")&lt;/span&gt;&lt;br&gt;"</span>,</span>
<span id="cb8-64">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#D9565CFF;'&gt;"</span>,</span>
<span id="cb8-65">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max. Recorded Temp."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;&lt;br&gt;"</span>,</span>
<span id="cb8-66">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt;'&gt;&lt;/span&gt;"</span>,</span>
<span id="cb8-67">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#1BB6AFFF;'&gt;"</span>,</span>
<span id="cb8-68">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Min. Recorded Temp."</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span>,</span>
<span id="cb8-69">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;"</span>,</span>
<span id="cb8-70">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;b style='font-size:"</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt; color:#0076C0FF;'&gt;"</span>,</span>
<span id="cb8-71">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Max. Recorded Rainfall"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/b&gt;"</span></span>
<span id="cb8-72">      ),</span>
<span id="cb8-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb8-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb8-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb8-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb8-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-81">  </span>
<span id="cb8-82">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add plot_title and plot_subtitle</span></span>
<span id="cb8-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.5</span>,</span>
<span id="cb8-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">60.3</span>,</span>
<span id="cb8-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_title,</span>
<span id="cb8-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span>,</span>
<span id="cb8-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb8-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb8-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb8-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">59</span>,</span>
<span id="cb8-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb8-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_subtitle,</span>
<span id="cb8-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,</span>
<span id="cb8-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb8-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb8-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-109"></span>
<span id="cb8-110"></span>
<span id="cb8-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb8-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:27700"</span>,</span>
<span id="cb8-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb8-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb8-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb8-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb8-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">48</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb8-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb8-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb8-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb8-127">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb8-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-131">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb8-134">    </span>
<span id="cb8-135">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb8-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb8-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb8-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb8-140">    ),</span>
<span id="cb8-141">    </span>
<span id="cb8-142">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grid Lines and Axes Text</span></span>
<span id="cb8-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb8-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb8-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_hil, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb8-147">    ),</span>
<span id="cb8-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb8-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb8-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb8-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb8-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb8-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb8-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-158">    ),</span>
<span id="cb8-159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb8-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb8-161">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb8-162">  )</span>
<span id="cb8-163"></span>
<span id="cb8-164"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb8-165">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb8-166">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb8-167">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_uk_meteorological_data2.png"</span></span>
<span id="cb8-168">  ),</span>
<span id="cb8-169">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb8-170">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb8-171">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb8-172">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb8-173">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb8-174">)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_uk_meteorological_data2.png" class="img-fluid figure-img"></p>
<figcaption>This map displays historic meteorological data from 37 UK Met Office weather stations spanning 1853-2025. Each station is labeled with its name and opening year, followed by three key climate extremes: the highest temperature ever recorded (shown in red), the lowest temperature ever recorded (shown in teal), and the maximum rainfall in a 24-hour period (shown in blue). Notable patterns emerge across the geography: southern England recorded the hottest temperatures (exceeding 40°C at Heathrow in 2022), Scotland’s highlands experienced the coldest conditions (below -27°C at Braemar and Altnaharra), and western coastal regions saw the highest rainfall totals (over 300mm in places like Seathwaite). This visualization demonstrates how modern R packages—{ggplot2}, {ggrepel}, {marquee}, and {ggtext}—can be combined to create information-dense yet readable maps that reveal spatial patterns in long-term climate data.</figcaption>
</figure>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.metoffice.gov.uk/">UK Met Office</a></li>
<li><a href="https://www.metoffice.gov.uk/research/climate/maps-and-data/historic-station-data">historic station data collection</a></li>
<li><a href="https://www.metoffice.gov.uk/">Met Office</a></li>
<li><a href="https://epsg.io/4326">EPSG:4326 format</a></li>
<li><a href="https://github.com/jack-davison">Jack Davison</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a></li>
<li><a href="https://github.com/slowkow/ggrepel/tree/0bbdee8174712929f297da6f0e4170059b0a9344/R">ggrepel R directory</a></li>
<li><a href="https://github.com/teunbrand">teunbrand</a></li>
<li><a href="https://github.com/slowkow/ggrepel"><code>geom_marquee_repel()</code></a></li>
<li><a href="https://github.com/r-lib/marquee"><code>marquee::marquee_glue()</code></a></li>
<li><a href="https://github.com/r-lib/marquee"><code>marquee::classic_style()</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>ggplot2::geom_sf()</code></a></li>
<li><a href="https://github.com/wilkelab/ggtext"><code>ggtext::element_markdown()</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/annotate.html"><code>annotate()</code></a></li>
<li><a href="https://github.com/r-lib/marquee"><strong>{marquee}</strong></a></li>
<li><a href="https://github.com/slowkow/ggrepel"><strong>{ggrepel}</strong></a></li>
<li><a href="https://ggplot2.tidyverse.org/"><strong>{ggplot2}</strong></a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>{ggrepel}</category>
  <category>Maps</category>
  <category>Repel richtext</category>
  <category>{marquee}</category>
  <category>{ggtext}</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_uk_meteorological_data.html</guid>
  <pubDate>Mon, 20 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_uk_meteorological_data.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Obesity Trajectories Across 85 Nations</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_world_food_day.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This week’s dataset celebrates <a href="https://en.wikipedia.org/wiki/World_Food_Day">World Food Day</a> and the 80th anniversary of the <a href="https://en.wikipedia.org/wiki/Food_and_Agriculture_Organization">Food and Agriculture Organization of the United Nations (FAO)</a>. The data comes from the FAO’s <a href="https://www.fao.org/faostat/en/#data/FS">Suite of Food Security Indicators</a>, a comprehensive collection developed following recommendations from the Committee on World Food Security. These indicators capture various dimensions of food insecurity using expert judgment and data with sufficient coverage to enable meaningful comparisons across regions and over time. The dataset includes measurements across multiple indicators, regions, and time periods, with confidence intervals provided for many observations to reflect measurement uncertainty. Values are expressed in diverse units including grams per capita per day, kilocalories per capita per day, international dollars, percentages, and indices, allowing for a multifaceted assessment of global food security trends.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_world_food_day.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Each panel represents a country, ranked by 2022 obesity rates from highest (top-left) to lowest (bottom-right). The x-axis shows years from 2005 to 2022, while the y-axis displays the prevalence of obesity in the adult population as a percentage. Lines trace each country’s trajectory over time, with values labeled at the beginning and end of the period.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9">  sf, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for maps</span></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(geofacet)</span>
<span id="cb1-13"></span>
<span id="cb1-14">food_security <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-10-14/food_security.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-15">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the actual colors from chosen palette</span></span>
<span id="cb2-36">day_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ghibli::PonyoDark"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb2-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(day_colors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sun"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fri"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sat"</span>)</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Carl Börstell; The Food and Agriculture&lt;br&gt;Organization of the United Nations (FAO)"</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;**Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;**Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Obesity Trajectories in 85 Nations"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Countries displayed by 2022 obesity rates. Red identifies the top 10 nations experiencing the most dramatic obesity increases since 2005, while green signals those with lesser increases. Most countries in grey show moderate or mixed trends over nearly two decades."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">135</span>)</span>
<span id="cb2-68"></span>
<span id="cb2-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># food_security |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(!is.na(value)) |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   summarytools::dfSummary() |&gt; </span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   summarytools::view()</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># region_names &lt;- c(</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   "Africa", "Antarctica", "Asia", "Europe", </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   "North America", "Oceania", "South America")</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># food_security |&gt; </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(area %in% region_names) |&gt; </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(area)</span></span>
<span id="cb3-15"></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># region_names &lt;- food_security |&gt; </span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(area) |&gt; </span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   slice(207:209, 211:212, 216, 218:221, 223:225, 227:229, 231:232, 237:240) |&gt; </span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(area)</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># region_codes &lt;- tibble(</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   area = c(</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "Northern America", "Northern Europe", "Caribbean", "Western Europe", </span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "Eastern Europe", "Western Asia", "Eastern Asia", "Central Asia", </span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "Central America", "Southern Europe", "South-eastern Asia", "Southern Asia", </span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "South America", "Western Africa", "Northern Africa", "Eastern Africa", </span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "Micronesia", "Middle Africa", "Southern Africa", "Australia and New Zealand", </span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "Polynesia", "Melanesia"),</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   code = c(</span></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "NA", "NE", "CB", "WE", "EE", "WA", "EA", "CA", "CM", "SE", "SA", "SIA", </span></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "SMA", "WAF", "NAF", "EAF", "MIC", "MAF", "SAF", "ANZ", "POL", "MEL"</span></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># )</span></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df1 &lt;- food_security |&gt;</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(!is.na(value)) |&gt;</span></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(</span></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     item == "Prevalence of obesity in the adult population (18 years and older) (percent)"</span></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     ) |&gt;</span></span>
<span id="cb3-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   mutate(</span></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     code = countrycode::countrycode(</span></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       sourcevar = area,</span></span>
<span id="cb3-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       origin = "country.name.en",</span></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       destination = "iso3c"</span></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) |&gt;</span></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(code %in% world_86countries_grid$code) |&gt;</span></span>
<span id="cb3-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   left_join(</span></span>
<span id="cb3-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     world_86countries_grid</span></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) |&gt;</span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(year_start, area, code, value, name, row, col)</span></span>
<span id="cb3-52"></span>
<span id="cb3-53">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> food_security <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-56">    item <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prevalence of obesity in the adult population (18 years and older) (percent)"</span></span>
<span id="cb3-57">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-60">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sourcevar =</span> area,</span>
<span id="cb3-61">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span>,</span>
<span id="cb3-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span></span>
<span id="cb3-63">    )</span>
<span id="cb3-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> world_86countries_grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-67">    world_86countries_grid</span>
<span id="cb3-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(area) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value_2005 =</span> value[year_start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>],</span>
<span id="cb3-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value_2022 =</span> value[year_start <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2022</span>],</span>
<span id="cb3-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_increase =</span> ((value_2022 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> value_2005) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> value_2005) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb3-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb3-76">  </span>
<span id="cb3-77">ranks_countries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(name, pct_increase) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pct_increase_rank =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rank</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>pct_increase, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ties.method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first"</span>))</span>
<span id="cb3-80"></span>
<span id="cb3-81"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(ranks_countries<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>pct_increase_rank)</span>
<span id="cb3-82"></span>
<span id="cb3-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify top &amp; bottom 10 countries by pct_increase (for colour_var)</span></span>
<span id="cb3-84">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(ranks_countries) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-88">      pct_increase_rank <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BF092F"</span>,</span>
<span id="cb3-89">      pct_increase <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">77</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#016B61"</span>,</span>
<span id="cb3-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb3-91">    )</span>
<span id="cb3-92">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(name, value_2022, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.desc =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(name, year_start) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sourcevar =</span> name,</span>
<span id="cb3-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span>,</span>
<span id="cb3-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso2c"</span></span>
<span id="cb3-104">    ),</span>
<span id="cb3-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(country),</span>
<span id="cb3-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-107">      value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb3-108">      value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,</span>
<span id="cb3-109">      value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb3-111">    )</span>
<span id="cb3-112">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> value, </span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year_start</span>
<span id="cb4-6">    )</span>
<span id="cb4-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  </span>
<span id="cb4-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Background graphics</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group_var =</span> name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>name),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group_var),</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb4-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16"></span>
<span id="cb4-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Actual Geoms and Text</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb4-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> year_start),</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb4-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-29">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::Earth"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-30">  </span>
<span id="cb4-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-33">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> year_start) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-34">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>(),</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(value, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>),</span>
<span id="cb4-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust</span>
<span id="cb4-38">    ),</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>,</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2686A0FF"</span></span>
<span id="cb4-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-48">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_min</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> year_start) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-49">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>(),</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(value, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>),</span>
<span id="cb4-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> vjust</span>
<span id="cb4-53">    ),</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#A36B2BFF"</span></span>
<span id="cb4-60">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-63">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>(),</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> name,</span>
<span id="cb4-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2010</span>,</span>
<span id="cb4-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb4-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> colour_var</span>
<span id="cb4-69">    ),</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-77">  </span>
<span id="cb4-78">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add country flag</span></span>
<span id="cb4-79">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(name) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-81">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>(),</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> country,</span>
<span id="cb4-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2007</span>,</span>
<span id="cb4-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span></span>
<span id="cb4-86">    ),</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb4-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-89">  </span>
<span id="cb4-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-91">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>name,</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span></span>
<span id="cb4-94">    </span>
<span id="cb4-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-96">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># geofacet::facet_geo(</span></span>
<span id="cb4-97">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   grid = "world_countries_grid1",</span></span>
<span id="cb4-98">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   facets = ~code,</span></span>
<span id="cb4-99">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   move_axes = FALSE,</span></span>
<span id="cb4-100">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   label = "name"</span></span>
<span id="cb4-101">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ) +</span></span>
<span id="cb4-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-105">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-106">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb4-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Prevalence of obesity in the adult population (18 years and older) %)"</span></span>
<span id="cb4-117">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb4-121">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-124">    </span>
<span id="cb4-125">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-130">    ),</span>
<span id="cb4-131">    </span>
<span id="cb4-132">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grid Lines and Axes Text</span></span>
<span id="cb4-133">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_hil, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb4-136">    ),</span>
<span id="cb4-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-141">    ),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-146">    ),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, </span>
<span id="cb4-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-153">    ),</span>
<span id="cb4-154">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb4-164">    ),</span>
<span id="cb4-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb4-170">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-171">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-173">    ),</span>
<span id="cb4-174">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-178">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-180">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb4-182">    ),</span>
<span id="cb4-183">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-184">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-185">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-186">    </span>
<span id="cb4-187">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip Text</span></span>
<span id="cb4-188">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-189">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-190">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-191">  )</span>
<span id="cb4-192"></span>
<span id="cb4-193"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-194">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-195">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-196">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_world_food_day.png"</span></span>
<span id="cb4-197">  ),</span>
<span id="cb4-198">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-199">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-200">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-201">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-202">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-203">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_world_food_day.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_world_food_day.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-5">    date, source</span>
<span id="cb6-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bxsjpddate" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#bxsjpddate table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bxsjpddate thead, #bxsjpddate tbody, #bxsjpddate tfoot, #bxsjpddate tr, #bxsjpddate td, #bxsjpddate th {
  border-style: none;
}

#bxsjpddate p {
  margin: 0;
  padding: 0;
}

#bxsjpddate .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bxsjpddate .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bxsjpddate .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bxsjpddate .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bxsjpddate .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxsjpddate .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxsjpddate .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxsjpddate .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bxsjpddate .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bxsjpddate .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bxsjpddate .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bxsjpddate .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bxsjpddate .gt_spanner_row {
  border-bottom-style: hidden;
}

#bxsjpddate .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bxsjpddate .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bxsjpddate .gt_from_md > :first-child {
  margin-top: 0;
}

#bxsjpddate .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bxsjpddate .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bxsjpddate .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bxsjpddate .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bxsjpddate .gt_row_group_first td {
  border-top-width: 2px;
}

#bxsjpddate .gt_row_group_first th {
  border-top-width: 2px;
}

#bxsjpddate .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxsjpddate .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bxsjpddate .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bxsjpddate .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxsjpddate .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxsjpddate .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bxsjpddate .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bxsjpddate .gt_striped {
  background-color: #FAFAFA;
}

#bxsjpddate .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxsjpddate .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxsjpddate .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxsjpddate .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxsjpddate .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxsjpddate .gt_left {
  text-align: left;
}

#bxsjpddate .gt_center {
  text-align: center;
}

#bxsjpddate .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bxsjpddate .gt_font_normal {
  font-weight: normal;
}

#bxsjpddate .gt_font_bold {
  font-weight: bold;
}

#bxsjpddate .gt_font_italic {
  font-style: italic;
}

#bxsjpddate .gt_super {
  font-size: 65%;
}

#bxsjpddate .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bxsjpddate .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bxsjpddate .gt_indent_1 {
  text-indent: 5px;
}

#bxsjpddate .gt_indent_2 {
  text-indent: 10px;
}

#bxsjpddate .gt_indent_3 {
  text-indent: 15px;
}

#bxsjpddate .gt_indent_4 {
  text-indent: 20px;
}

#bxsjpddate .gt_indent_5 {
  text-indent: 25px;
}

#bxsjpddate .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bxsjpddate div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="bxsjpddate" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="bxsjpddate">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","KernSmooth","R6","RColorBrewer","Rcpp","S7","bit","bit64","class","classInt","cli","codetools","colorspace","crayon","curl","dichromat","digest","dplyr","e1071","evaluate","farver","fastmap","fontawesome","forcats","generics","geofacet","geogrid","ggplot2","ggrepel","ggtext","glue","gridExtra","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","httr","httr2","janitor","jsonlite","knitr","lattice","lifecycle","lubridate","magrittr","pacman","paletteer","patchwork","pillar","pkgconfig","png","proxy","purrr","rappdirs","readr","rematch2","rlang","rmarkdown","rnaturalearth","rstudioapi","scales","sessioninfo","sf","showtext","showtextdb","snakecase","sp","stringi","stringr","sysfonts","terra","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","units","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["1.2.3","2.23-26","2.6.1","1.1-3","1.0.14","0.2.0","4.6.0","4.6.0-1","7.3-23","0.4-11","3.6.4","0.2-20","2.1-1","1.5.3","6.2.2","2.0-0.1","0.6.37","1.1.4","1.7-16","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.3","0.2.4","0.1.2","4.0.0","0.6.7","0.1.2","1.8.0","2.3","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","1.4.7","1.1.2","2.2.1","2.0.0","1.50","0.22-7","1.0.4","1.9.4","2.0.3","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","0.1-8","0.4-27","1.0.4","0.3.3","2.1.5","2.1.2","1.1.6","2.29","1.0.1","0.17.1","1.4.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","2.2-0","1.8.7","1.5.1","0.8.9","1.8-42","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.8-7","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2025-01-01","2025-02-15","2022-04-03","2025-01-12","2024-11-07","2025-03-06","2025-01-16","2025-01-01","2025-01-08","2025-02-13","2024-03-31","2024-07-26","2024-06-20","2025-03-24","2022-05-02","2024-08-19","2023-11-17","2024-09-16","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2022-07-05","2025-06-28","2023-08-19","2025-09-11","2025-10-07","2022-09-16","2024-09-30","2017-09-09","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2023-08-15","2025-03-26","2024-12-22","2025-03-27","2025-03-16","2025-04-02","2023-11-07","2024-12-08","2022-03-30","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2022-11-29","2022-06-09","2025-02-05","2021-01-31","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2023-12-15","2024-10-22","2025-04-24","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-02-01","2025-03-27","2023-11-14","2024-03-02","2025-04-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2025-03-11","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","Github (zachcp/ggrepel@8a7191df3a4767b047296b046332dc07235e1af0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"bxsjpddate","dataKey":"143d234040d56c5e603502e9edbd6bd1"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://en.wikipedia.org/wiki/World_Food_Day">World Food Day</a></li>
<li><a href="https://en.wikipedia.org/wiki/Food_and_Agriculture_Organization">Food and Agriculture Organization of the United Nations (FAO)</a></li>
<li><a href="https://www.fao.org/faostat/en/#data/FS">Suite of Food Security Indicators</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Facet Graph</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_world_food_day.html</guid>
  <pubDate>Sun, 19 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_world_food_day.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Mapping Europe’s Elite Basketball Arenas</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_euroleague_basketball.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<section id="about-the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data-1">About the Data</h2>
<p>This dataset explores <strong>EuroLeague Basketball</strong>, the top-tier European professional basketball club competition widely regarded as the most prestigious in European basketball. The data includes information on EuroLeague teams such as their country, home city, arena, seating capacity, and historical performance metrics including Final Four appearances and championship titles won. The dataset was curated from publicly available sources including <a href="https://en.wikipedia.org/wiki/EuroLeague">Wikipedia</a> and <a href="https://www.euroleaguebasketball.net/">official EuroLeague records</a>, and is available through the <a href="https://github.com/natanast/EuroleagueBasketball">EuroleagueBasketball R package</a> created by <a href="https://github.com/natanast">Natasa Anastasiadou</a>, with full documentation at <a href="https://natanast.github.io/EuroleagueBasketball/">natanast.github.io/EuroleagueBasketball</a>. This rich dataset enables exploration of geographic representation across European basketball, comparisons of arena capacities, and analysis of the most historically successful clubs in European basketball competition. The data is part of the <a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a> project, a weekly data visualization challenge in the R and Python communities.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_euroleague_basketball.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This map visualizes EuroLeague Basketball teams across Europe and beyond, showing arena locations, capacities, and team logos. Created using {ggplot2} with {sf} for spatial data, {ggimage} for team logos, and {ggrepel} for label placement. Map data from {rnaturalearth}, team information from the {EuroleagueBasketball} package. Logos were sourced via Google Custom Search API and processed with {magick}.
</figcaption>
</figure>
</div>
</section>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9">  sf, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for maps</span></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13">euroleague_basketball <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-10-07/euroleague_basketball.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-14">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the actual colors from chosen palette</span></span>
<span id="cb2-36">day_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ghibli::PonyoDark"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb2-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(day_colors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sun"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fri"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sat"</span>)</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  {EuroleagueBasketball} by Natasa Anastasiadou"</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe's Elite Basketball Arenas"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"From Barcelona to Tel Aviv, 23 iconic arenas across 11 countries host Europe's top-tier basketball competition. Arena capacities range from intimate 3,000-seat venues to massive 20,000+ stadiums, reflecting the continent's diverse basketball culture and passionate fanbases."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb2-68"></span>
<span id="cb2-69"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="download-images-of-club-logos" class="level3">
<h3 class="anchored" data-anchor-id="download-images-of-club-logos">Download images of Club Logos</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a custom google search engine and API key</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tutorial: https://developers.google.com/custom-search/v1/overview</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tutorial 2: https://programmablesearchengine.google.com/</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From:https://developers.google.com/custom-search/v1/overview</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># google_api_key &lt;- "LOAD YOUR GOOGLE API KEY HERE"</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># From: https://programmablesearchengine.google.com/controlpanel/all</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># my_cx &lt;- "GET YOUR CUSTOM SEARCH ENGINE ID HERE"</span></span>
<span id="cb3-10"></span>
<span id="cb3-11">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(magick, cropcircles)</span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Improved function to download and save food images</span></span>
<span id="cb3-14">download_club_icon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i) {</span>
<span id="cb3-15">  </span>
<span id="cb3-16">  api_key <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> google_api_key</span>
<span id="cb3-17">  cx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> my_cx</span>
<span id="cb3-18">  </span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build the API request URL with additional filters</span></span>
<span id="cb3-20">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb3-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.googleapis.com/customsearch/v1?q="</span>,</span>
<span id="cb3-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">URLencode</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(euroleague_basketball<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>team[i], </span>
<span id="cb3-23">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" basketball logo"</span>)),</span>
<span id="cb3-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;cx="</span>, cx,</span>
<span id="cb3-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;searchType=image"</span>,</span>
<span id="cb3-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;key="</span>, api_key,</span>
<span id="cb3-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;num=1"</span>                 <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fetch only one result</span></span>
<span id="cb3-28">  )</span>
<span id="cb3-29">  </span>
<span id="cb3-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make the request</span></span>
<span id="cb3-31">  response <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> httr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url)</span>
<span id="cb3-32">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (response<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>status_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>) {</span>
<span id="cb3-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Failed to fetch data for Cardinal: "</span>, </span>
<span id="cb3-34">            cardinals<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>name[i])</span>
<span id="cb3-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb3-36">  }</span>
<span id="cb3-37">  </span>
<span id="cb3-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse the response</span></span>
<span id="cb3-39">  result <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> httr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(response, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"parsed"</span>)</span>
<span id="cb3-40">  </span>
<span id="cb3-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the image URL</span></span>
<span id="cb3-42">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.null</span>(result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>items)) {</span>
<span id="cb3-43">    image_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>items[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>link</span>
<span id="cb3-44">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb3-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No results found for Team: "</span>, euroleague_basketball<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>team[i])</span>
<span id="cb3-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb3-47">  }</span>
<span id="cb3-48">  </span>
<span id="cb3-49">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Process the image</span></span>
<span id="cb3-50">  im <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> magick<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(image_url) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     image_resize("x300") </span></span>
<span id="cb3-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-53">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Calculate the new dimension for the square</span></span>
<span id="cb3-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># max_dim &lt;- max(image_info(im)$width, image_info(im)$height)</span></span>
<span id="cb3-55">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-56">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Create a blank white canvas of square size</span></span>
<span id="cb3-57">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># canvas &lt;- image_blank(width = max_dim, </span></span>
<span id="cb3-58">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                       height = max_dim, </span></span>
<span id="cb3-59">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                       color = bg_col)</span></span>
<span id="cb3-60">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-61">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Composite the original image onto the center of the square canvas</span></span>
<span id="cb3-62">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># image_composite(canvas, im, gravity = "center") |&gt; </span></span>
<span id="cb3-63">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Crop the image into a circle </span></span>
<span id="cb3-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # (Credits: https://github.com/doehm/cropcircles)</span></span>
<span id="cb3-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   cropcircles::circle_crop(</span></span>
<span id="cb3-66">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     border_colour = text_hil,</span></span>
<span id="cb3-67">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     border_size = 1</span></span>
<span id="cb3-68">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) |&gt;</span></span>
<span id="cb3-69">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   image_read() |&gt; </span></span>
<span id="cb3-70">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   image_background(color = "transparent") |&gt; </span></span>
<span id="cb3-71">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x300"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save or display the result</span></span>
<span id="cb3-73">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb3-74">      here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb3-75">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb3-76">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"temp_euroleague_basketball_"</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>)</span>
<span id="cb3-77">        )</span>
<span id="cb3-78">    )</span>
<span id="cb3-79">}</span>
<span id="cb3-80"></span>
<span id="cb3-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Iterate and download images</span></span>
<span id="cb3-82"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(euroleague_basketball)) {</span>
<span id="cb3-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download_club_icon</span>(i)</span>
<span id="cb3-84">}</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># euroleague_basketball |&gt; </span></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get logos of each team</span></span>
<span id="cb4-10"></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Source: Claude Sonnet 4.0</span></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the coordinates of each team  city to show on the map</span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># euroleague_basketball$arena |&gt; paste0(collapse = ", ")</span></span>
<span id="cb4-14">euroleague_arenas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb4-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arena =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Basketball Development Center"</span>,</span>
<span id="cb4-17">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Palau Blaugrana"</span>,</span>
<span id="cb4-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Buesa Arena"</span>,</span>
<span id="cb4-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SAP Garden"</span>,</span>
<span id="cb4-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Belgrade Arena"</span>,</span>
<span id="cb4-21">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Coca-Cola Arena"</span>,</span>
<span id="cb4-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ülker Sports and Event Hall"</span>,</span>
<span id="cb4-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arena 8888 Sofia"</span>,</span>
<span id="cb4-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Arena Botevgrad"</span>,</span>
<span id="cb4-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Menora Mivtachim Arena"</span>,</span>
<span id="cb4-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LDLC Arena"</span>,</span>
<span id="cb4-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Astroballe"</span>,</span>
<span id="cb4-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Salle Gaston Médecin"</span>,</span>
<span id="cb4-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unipol Forum"</span>,</span>
<span id="cb4-30">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peace and Friendship Stadium"</span>,</span>
<span id="cb4-31">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Telekom Center Athens"</span>,</span>
<span id="cb4-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adidas Arena"</span>,</span>
<span id="cb4-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Accor Arena"</span>,</span>
<span id="cb4-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Movistar Arena"</span>,</span>
<span id="cb4-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Roig Arena"</span>,</span>
<span id="cb4-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Virtus Arena"</span>,</span>
<span id="cb4-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"PalaDozza"</span>,</span>
<span id="cb4-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Žalgirio Arena"</span></span>
<span id="cb4-39">  ),</span>
<span id="cb4-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-41">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.1177</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Barcelona (Basketball Development Center)</span></span>
<span id="cb4-42">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.1228</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Barcelona (Palau Blaugrana)</span></span>
<span id="cb4-43">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6733</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vitoria-Gasteiz (Buesa Arena)</span></span>
<span id="cb4-44">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.5497</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Munich (SAP Garden)</span></span>
<span id="cb4-45">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">20.4289</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Belgrade (Belgrade Arena)</span></span>
<span id="cb4-46">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">55.2708</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dubai (Coca-Cola Arena)</span></span>
<span id="cb4-47">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">29.0275</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Istanbul (Ülker Sports and Event Hall)</span></span>
<span id="cb4-48">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23.3219</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sofia (Arena 8888 Sofia)</span></span>
<span id="cb4-49">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23.7833</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Botevgrad (Arena Botevgrad)</span></span>
<span id="cb4-50">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">34.8116</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tel Aviv (Menora Mivtachim Arena)</span></span>
<span id="cb4-51">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.9267</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Villeurbanne (LDLC Arena)</span></span>
<span id="cb4-52">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.9267</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Villeurbanne (Astroballe)</span></span>
<span id="cb4-53">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.4167</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monaco (Salle Gaston Médecin)</span></span>
<span id="cb4-54">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.1497</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Milan (Unipol Forum)</span></span>
<span id="cb4-55">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.9475</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Piraeus (Peace and Friendship Stadium)</span></span>
<span id="cb4-56">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23.7514</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Athens (Telekom Center Athens)</span></span>
<span id="cb4-57">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.3522</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paris (Adidas Arena)</span></span>
<span id="cb4-58">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.3792</span>,      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paris (Accor Arena)</span></span>
<span id="cb4-59">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.6753</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Madrid (Movistar Arena)</span></span>
<span id="cb4-60">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1058</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valencia (Roig Arena)</span></span>
<span id="cb4-61">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.3514</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bologna (Virtus Arena)</span></span>
<span id="cb4-62">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">11.3428</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bologna (PalaDozza)</span></span>
<span id="cb4-63">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">23.9036</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kaunas (Žalgirio Arena)</span></span>
<span id="cb4-64">  ),</span>
<span id="cb4-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-66">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">41.3806</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Barcelona (Basketball Development Center)</span></span>
<span id="cb4-67">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">41.3809</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Barcelona (Palau Blaugrana)</span></span>
<span id="cb4-68">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">42.8520</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vitoria-Gasteiz (Buesa Arena)</span></span>
<span id="cb4-69">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">48.1756</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Munich (SAP Garden)</span></span>
<span id="cb4-70">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44.7769</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Belgrade (Belgrade Arena)</span></span>
<span id="cb4-71">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">25.2048</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dubai (Coca-Cola Arena)</span></span>
<span id="cb4-72">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">41.0392</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Istanbul (Ülker Sports and Event Hall)</span></span>
<span id="cb4-73">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">42.6977</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sofia (Arena 8888 Sofia)</span></span>
<span id="cb4-74">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">42.9000</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Botevgrad (Arena Botevgrad)</span></span>
<span id="cb4-75">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">32.1133</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tel Aviv (Menora Mivtachim Arena)</span></span>
<span id="cb4-76">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45.7667</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Villeurbanne (LDLC Arena)</span></span>
<span id="cb4-77">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45.7667</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Villeurbanne (Astroballe)</span></span>
<span id="cb4-78">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">43.7384</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monaco (Salle Gaston Médecin)</span></span>
<span id="cb4-79">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">45.4375</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Milan (Unipol Forum)</span></span>
<span id="cb4-80">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.9475</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Piraeus (Peace and Friendship Stadium)</span></span>
<span id="cb4-81">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">37.9838</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Athens (Telekom Center Athens)</span></span>
<span id="cb4-82">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">48.8566</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paris (Adidas Arena)</span></span>
<span id="cb4-83">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">48.8394</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Paris (Accor Arena)</span></span>
<span id="cb4-84">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">40.4168</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Madrid (Movistar Arena)</span></span>
<span id="cb4-85">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">39.4699</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valencia (Roig Arena)</span></span>
<span id="cb4-86">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44.4949</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bologna (Virtus Arena)</span></span>
<span id="cb4-87">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">44.4938</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bologna (PalaDozza)</span></span>
<span id="cb4-88">    <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">54.8985</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kaunas (Žalgirio Arena)</span></span>
<span id="cb4-89">  ),</span>
<span id="cb4-90">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso_a2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-91">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ES"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spain</span></span>
<span id="cb4-92">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ES"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spain</span></span>
<span id="cb4-93">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ES"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spain</span></span>
<span id="cb4-94">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DE"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Germany</span></span>
<span id="cb4-95">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RS"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Serbia</span></span>
<span id="cb4-96">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AE"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># United Arab Emirates</span></span>
<span id="cb4-97">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Turkey</span></span>
<span id="cb4-98">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BG"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bulgaria</span></span>
<span id="cb4-99">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"BG"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bulgaria</span></span>
<span id="cb4-100">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IL"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Israel</span></span>
<span id="cb4-101">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># France</span></span>
<span id="cb4-102">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># France</span></span>
<span id="cb4-103">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MC"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Monaco</span></span>
<span id="cb4-104">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IT"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Italy</span></span>
<span id="cb4-105">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Greece</span></span>
<span id="cb4-106">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Greece</span></span>
<span id="cb4-107">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># France</span></span>
<span id="cb4-108">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># France</span></span>
<span id="cb4-109">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ES"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spain</span></span>
<span id="cb4-110">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ES"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spain</span></span>
<span id="cb4-111">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IT"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Italy</span></span>
<span id="cb4-112">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IT"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Italy</span></span>
<span id="cb4-113">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LT"</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lithuania</span></span>
<span id="cb4-114">  )</span>
<span id="cb4-115">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longitude"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latitude"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">remove =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb4-117"></span>
<span id="cb4-118">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> euroleague_arenas <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb4-120">    euroleague_basketball <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-121">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">image_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-122">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_longer_delim</span>(</span>
<span id="cb4-123">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> arena,</span>
<span id="cb4-124">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> "</span></span>
<span id="cb4-125">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-126">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_longer_delim</span>(</span>
<span id="cb4-127">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> arena,</span>
<span id="cb4-128">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span></span>
<span id="cb4-129">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb4-130">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-131">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arena =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_trim</span>(arena)</span>
<span id="cb4-132">    )</span>
<span id="cb4-133">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-134">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First, separate rows that have two capacities (separated by comma and space)</span></span>
<span id="cb4-135">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_longer_delim</span>(capacity, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">delim =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-136">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse as numbers (remove commas and convert to numeric)</span></span>
<span id="cb4-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">capacity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(capacity)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-138">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(team) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_head</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span>
<span id="cb4-142"></span>
<span id="cb4-143">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span></span>
<span id="cb4-146">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-147">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso_a2, geometry)</span>
<span id="cb4-148"></span>
<span id="cb4-149">country_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-150">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-151">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso_a2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-152">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb4-153">    rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb4-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb4-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span></span>
<span id="cb4-156">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-157">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(name, iso_a2, geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-158">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb4-159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso_a2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb4-160">      iso_a2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-99"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>, </span>
<span id="cb4-161">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FR"</span>, </span>
<span id="cb4-162">      iso_a2)</span>
<span id="cb4-163">    )</span>
<span id="cb4-164">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-165">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_map,</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey90"</span>,</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb5-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> country_map,</span>
<span id="cb5-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey50"</span>,</span>
<span id="cb5-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-15"></span>
<span id="cb5-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace the geom_label_repel with:</span></span>
<span id="cb5-17">  ggrepel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label_repel</span>(</span>
<span id="cb5-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df1,</span>
<span id="cb5-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb5-21">          team, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, home_city, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">") </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-22">          arena, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">", "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-23">          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(capacity, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb5-24">        ),</span>
<span id="cb5-25">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> geometry</span>
<span id="cb5-26">      ),</span>
<span id="cb5-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf_coordinates"</span>,</span>
<span id="cb5-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>),</span>
<span id="cb5-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb5-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb5-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force_pull =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,</span>
<span id="cb5-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb5-38">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb5-39">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb5-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min.segment.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-43">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-44">     ggimage<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_image</span>(</span>
<span id="cb5-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df1,</span>
<span id="cb5-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-47">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> longitude, </span>
<span id="cb5-48">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> latitude, </span>
<span id="cb5-49">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">image =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs/temp_euroleague_basketball_"</span>, image_id, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>)</span>
<span id="cb5-50">        ),</span>
<span id="cb5-51">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span></span>
<span id="cb5-52">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-53">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add legend annotation</span></span>
<span id="cb5-54">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>,</span>
<span id="cb5-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, </span>
<span id="cb5-57">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>,</span>
<span id="cb5-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb5-59">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Team Name"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" (Home City) </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-60">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Name of the Arena, "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb5-61">          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Capacity of the Stadium"</span></span>
<span id="cb5-62">        ),</span>
<span id="cb5-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>),</span>
<span id="cb5-65">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-66">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb5-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb5-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb5-72">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb5-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-75"></span>
<span id="cb5-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>,</span>
<span id="cb5-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb5-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>),</span>
<span id="cb5-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">66</span>)</span>
<span id="cb5-81">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-82">  </span>
<span id="cb5-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb5-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb5-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-90">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb5-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb5-94">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb5-97">    </span>
<span id="cb5-98">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb5-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-103">    ),</span>
<span id="cb5-104">    </span>
<span id="cb5-105">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Grid Lines and Axes Text</span></span>
<span id="cb5-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb5-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-110">    ),</span>
<span id="cb5-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-113">    ),</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-115">    </span>
<span id="cb5-116">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb5-126">    ),</span>
<span id="cb5-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-135">    ),</span>
<span id="cb5-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb5-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-141">    ),</span>
<span id="cb5-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-145">  )</span>
<span id="cb5-146"></span>
<span id="cb5-147"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-149">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-150">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_euroleague_basketball.png"</span></span>
<span id="cb5-151">  ),</span>
<span id="cb5-152">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb5-153">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb5-154">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb5-155">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb5-156">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb5-157">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_euroleague_basketball.png"</span></span>
<span id="cb6-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb6-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb6-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_euroleague_basketball.png"</span></span>
<span id="cb6-16">    )</span>
<span id="cb6-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb7-5">    date, source</span>
<span id="cb7-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb7-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fzjfqrcpgg" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#fzjfqrcpgg table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fzjfqrcpgg thead, #fzjfqrcpgg tbody, #fzjfqrcpgg tfoot, #fzjfqrcpgg tr, #fzjfqrcpgg td, #fzjfqrcpgg th {
  border-style: none;
}

#fzjfqrcpgg p {
  margin: 0;
  padding: 0;
}

#fzjfqrcpgg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fzjfqrcpgg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fzjfqrcpgg .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fzjfqrcpgg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fzjfqrcpgg .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzjfqrcpgg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzjfqrcpgg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzjfqrcpgg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fzjfqrcpgg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fzjfqrcpgg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fzjfqrcpgg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fzjfqrcpgg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fzjfqrcpgg .gt_spanner_row {
  border-bottom-style: hidden;
}

#fzjfqrcpgg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fzjfqrcpgg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fzjfqrcpgg .gt_from_md > :first-child {
  margin-top: 0;
}

#fzjfqrcpgg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fzjfqrcpgg .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fzjfqrcpgg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fzjfqrcpgg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fzjfqrcpgg .gt_row_group_first td {
  border-top-width: 2px;
}

#fzjfqrcpgg .gt_row_group_first th {
  border-top-width: 2px;
}

#fzjfqrcpgg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzjfqrcpgg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fzjfqrcpgg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fzjfqrcpgg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzjfqrcpgg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzjfqrcpgg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fzjfqrcpgg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fzjfqrcpgg .gt_striped {
  background-color: #FAFAFA;
}

#fzjfqrcpgg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzjfqrcpgg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzjfqrcpgg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzjfqrcpgg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzjfqrcpgg .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzjfqrcpgg .gt_left {
  text-align: left;
}

#fzjfqrcpgg .gt_center {
  text-align: center;
}

#fzjfqrcpgg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fzjfqrcpgg .gt_font_normal {
  font-weight: normal;
}

#fzjfqrcpgg .gt_font_bold {
  font-weight: bold;
}

#fzjfqrcpgg .gt_font_italic {
  font-style: italic;
}

#fzjfqrcpgg .gt_super {
  font-size: 65%;
}

#fzjfqrcpgg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fzjfqrcpgg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fzjfqrcpgg .gt_indent_1 {
  text-indent: 5px;
}

#fzjfqrcpgg .gt_indent_2 {
  text-indent: 10px;
}

#fzjfqrcpgg .gt_indent_3 {
  text-indent: 15px;
}

#fzjfqrcpgg .gt_indent_4 {
  text-indent: 20px;
}

#fzjfqrcpgg .gt_indent_5 {
  text-indent: 25px;
}

#fzjfqrcpgg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fzjfqrcpgg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="fzjfqrcpgg" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="fzjfqrcpgg">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","KernSmooth","R6","Rcpp","bit","bit64","class","classInt","cli","colorspace","crayon","curl","digest","dplyr","e1071","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","proxy","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","sf","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","units","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["1.2.3","2.23-26","2.6.1","1.0.14","4.6.0","4.6.0-1","7.3-23","0.4-11","3.6.4","2.1-1","1.5.3","6.2.2","0.6.37","1.1.4","1.7-16","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","0.4-27","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.8-7","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2025-01-01","2025-02-15","2025-01-12","2025-03-06","2025-01-16","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2024-08-19","2023-11-17","2024-09-16","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2022-06-09","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2025-03-11","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"fzjfqrcpgg","dataKey":"e3c4c078b6477fc75c8eb7ca001a0499"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://en.wikipedia.org/wiki/EuroLeague">Wikipedia</a></li>
<li><a href="https://www.euroleaguebasketball.net/">official EuroLeague records</a></li>
<li><a href="https://github.com/natanast/EuroleagueBasketball">EuroleagueBasketball R package</a></li>
<li><a href="https://github.com/natanast">Natasa Anastasiadou</a></li>
<li><a href="https://natanast.github.io/EuroleagueBasketball/">natanast.github.io/EuroleagueBasketball</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Maps</category>
  <category>Images</category>
  <category>{ggimage}</category>
  <category>{ggrepel}</category>
  <category>{ggtext}</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_euroleague_basketball.html</guid>
  <pubDate>Sat, 11 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_euroleague_basketball.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Tracking Cranes at Lake Hornborgasjön</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_crane_observations.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset documents crane observations at Lake Hornborgasjön in Västergötland, Sweden, spanning over 30 years of migration patterns. The data comes from dedicated crane counters at the <a href="https://www.hornborga.com/naturen/tranor/">Hornborgasjön field station</a>, who have systematically recorded crane populations during spring and fall migrations. The timing of peak crane presence varies depending on weather conditions—particularly the arrival of spring and favorable southerly winds that support crane flight. The dataset includes daily observation counts, dates, and important contextual notes from counting officials, such as records of bad weather, canceled counts, seasonal milestones (first and last counts), record observations, severe interference, and uncertain counts. Weather disruptions are specifically flagged when original comments mention conditions like fog, rain, snow, thunder, or other adverse weather. This rich historical record enables analysis of population trends, seasonal patterns, and the relationship between crane migration and weather conditions. More information about crane statistics can be found on the <a href="https://www.hornborga.com/naturen/transtatistik/">Hornborgasjön website</a>.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_crane_observations.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Visualization shows mean crane observations by weekday (y-axis), faceted by month (columns) and decade (rows). Bar length represents average observation count for each day-month-decade combination, with numeric labels showing exact values. Spring months (March-April) display comprehensive daily monitoring across all seven weekdays, while autumn months (August-October) show strategic sampling on selected days only. Growing bar lengths across decades indicate increasing observation frequencies. Colors distinguish weekdays using the Ghibli PonyoDark palette. Data: Hornborgasjön field station crane counts (1994-2024). Missing bars indicate no observations recorded for that weekday-month combination.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13">cranes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-30/cranes.csv'</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the actual colors from chosen palette</span></span>
<span id="cb2-36">day_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ghibli::PonyoDark"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span>
<span id="cb2-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(day_colors) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sun"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Wed"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thu"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fri"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sat"</span>)</span>
<span id="cb2-38"></span>
<span id="cb2-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-40">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-41">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-42">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-43">)</span>
<span id="cb2-44">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-45">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-46">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-47">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-48">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-49">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-50">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-51">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Hornborgasjön field station"</span>,</span>
<span id="cb2-52">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-53">  social_caption_1,</span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-55">  social_caption_2</span>
<span id="cb2-56">)</span>
<span id="cb2-57"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-58">  github, github_username, xtwitter,</span>
<span id="cb2-59">  xtwitter_username, social_caption_1,</span>
<span id="cb2-60">  social_caption_2</span>
<span id="cb2-61">)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Crane Observation Patterns</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Lake Hornborgasjön (1994–2024)"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(</span>
<span id="cb2-67">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Systematic crane monitoring occurs daily (&lt;span style='color:{day_colors['Mon']}'&gt;Mon&lt;/span&gt;-&lt;span style='color:{day_colors['Sun']}'&gt;Sun&lt;/span&gt;) during the intense &lt;b&gt;March-April&lt;/b&gt; spring migration&lt;br&gt;"</span>,</span>
<span id="cb2-68">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"when thousands gather at this critical stopover. Starting in the 2000s, &lt;b&gt;autumn counts&lt;/b&gt; expanded to track southward&lt;br&gt;"</span>,</span>
<span id="cb2-69">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"migration, but occur selectively—only on &lt;span style='color:{day_colors['Mon']}'&gt;Mon&lt;/span&gt;, &lt;span style='color:{day_colors['Tue']}'&gt;Tue&lt;/span&gt;, and &lt;span style='color:{day_colors['Thu']}'&gt;Thu&lt;/span&gt; in the 2010s, and &lt;span style='color:{day_colors['Mon']}'&gt;Mon&lt;/span&gt; and &lt;span style='color:{day_colors['Thu']}'&gt;Thu&lt;/span&gt; in the 2020s—&lt;br&gt;"</span>,</span>
<span id="cb2-70">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reflecting the more dispersed nature of fall passage. Three decades reveal steadily rising observations."</span></span>
<span id="cb2-71">)</span>
<span id="cb2-72"></span>
<span id="cb2-73"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cranes |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-8"></span>
<span id="cb3-9">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cranes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date),</span>
<span id="cb3-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decade =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">year</span>(date) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%/%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">decade_label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(decade, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"s"</span>),       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Decade with 's' suffix (1990s, 2000s, etc.)</span></span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">month</span>(date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">abbr =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_of_week =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">day</span>(date),</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_of_year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">yday</span>(date)</span>
<span id="cb3-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(observations))</span>
<span id="cb3-20"></span>
<span id="cb3-21">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(date, observations)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()</span>
<span id="cb3-24"></span>
<span id="cb3-25">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(month) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(month, observations)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>()</span>
<span id="cb3-32"></span>
<span id="cb3-33"></span>
<span id="cb3-34">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(month, day_of_week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(day_of_week, observations)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>month)</span>
<span id="cb3-42"></span>
<span id="cb3-43">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(month, day_of_week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(day_of_week, observations)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>month)</span>
<span id="cb3-51"></span>
<span id="cb3-52">df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(month, year, day_of_week) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-56">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb3-58">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb3-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> day_of_week, </span>
<span id="cb3-60">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> observations, </span>
<span id="cb3-61">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(year),</span>
<span id="cb3-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(year)</span>
<span id="cb3-63">    )</span>
<span id="cb3-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>month)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(decade_label, day_of_week, month) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">observations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(observations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb4-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> day_of_week, </span>
<span id="cb4-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> observations,</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> day_of_week</span>
<span id="cb4-11">    )</span>
<span id="cb4-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span></span>
<span id="cb4-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(</span>
<span id="cb4-19">        observations, </span>
<span id="cb4-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_short_scale</span>(),</span>
<span id="cb4-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">accuracy =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb4-22">      ),</span>
<span id="cb4-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> day_of_week</span>
<span id="cb4-24">    ),</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(decade_label <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> month) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> day_colors</span>
<span id="cb4-32">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> day_colors</span>
<span id="cb4-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut_short_scale</span>()),</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span></span>
<span id="cb4-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_discrete</span>(</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of observations on each day on the week (average for the month)"</span>,</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-56">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-59">    </span>
<span id="cb4-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-62">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-63">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-64">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-65">    ),</span>
<span id="cb4-66">    </span>
<span id="cb4-67">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-70">    ),</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> line_col</span>
<span id="cb4-77">    ),</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-79">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb4-80">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-81">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-82">    ),</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb4-87">    ),</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-91">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-92">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-93">    ),</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-98">    ),</span>
<span id="cb4-99">    </span>
<span id="cb4-100">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Strip Labels</span></span>
<span id="cb4-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-105">    ),</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil, </span>
<span id="cb4-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-111">    ),</span>
<span id="cb4-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-114">    </span>
<span id="cb4-115">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb4-125">    ),</span>
<span id="cb4-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-135">    ),</span>
<span id="cb4-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-141">    ),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-143">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-144">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-145">  )</span>
<span id="cb4-146"></span>
<span id="cb4-147"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-149">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-150">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_crane_observations.png"</span></span>
<span id="cb4-151">  ),</span>
<span id="cb4-152">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-153">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-154">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-155">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-156">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-157">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_crane_observations.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_crane_observations.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-5">    date, source</span>
<span id="cb6-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="cpyiixtdqi" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#cpyiixtdqi table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cpyiixtdqi thead, #cpyiixtdqi tbody, #cpyiixtdqi tfoot, #cpyiixtdqi tr, #cpyiixtdqi td, #cpyiixtdqi th {
  border-style: none;
}

#cpyiixtdqi p {
  margin: 0;
  padding: 0;
}

#cpyiixtdqi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cpyiixtdqi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cpyiixtdqi .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cpyiixtdqi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cpyiixtdqi .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cpyiixtdqi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpyiixtdqi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cpyiixtdqi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cpyiixtdqi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cpyiixtdqi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cpyiixtdqi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cpyiixtdqi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cpyiixtdqi .gt_spanner_row {
  border-bottom-style: hidden;
}

#cpyiixtdqi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cpyiixtdqi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cpyiixtdqi .gt_from_md > :first-child {
  margin-top: 0;
}

#cpyiixtdqi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cpyiixtdqi .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cpyiixtdqi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cpyiixtdqi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cpyiixtdqi .gt_row_group_first td {
  border-top-width: 2px;
}

#cpyiixtdqi .gt_row_group_first th {
  border-top-width: 2px;
}

#cpyiixtdqi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpyiixtdqi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cpyiixtdqi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cpyiixtdqi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpyiixtdqi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpyiixtdqi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cpyiixtdqi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cpyiixtdqi .gt_striped {
  background-color: #FAFAFA;
}

#cpyiixtdqi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cpyiixtdqi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cpyiixtdqi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpyiixtdqi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cpyiixtdqi .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cpyiixtdqi .gt_left {
  text-align: left;
}

#cpyiixtdqi .gt_center {
  text-align: center;
}

#cpyiixtdqi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cpyiixtdqi .gt_font_normal {
  font-weight: normal;
}

#cpyiixtdqi .gt_font_bold {
  font-weight: bold;
}

#cpyiixtdqi .gt_font_italic {
  font-style: italic;
}

#cpyiixtdqi .gt_super {
  font-size: 65%;
}

#cpyiixtdqi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cpyiixtdqi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cpyiixtdqi .gt_indent_1 {
  text-indent: 5px;
}

#cpyiixtdqi .gt_indent_2 {
  text-indent: 10px;
}

#cpyiixtdqi .gt_indent_3 {
  text-indent: 15px;
}

#cpyiixtdqi .gt_indent_4 {
  text-indent: 20px;
}

#cpyiixtdqi .gt_indent_5 {
  text-indent: 25px;
}

#cpyiixtdqi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cpyiixtdqi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="cpyiixtdqi" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="cpyiixtdqi">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","bit","bit64","cli","colorspace","crayon","curl","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","4.6.0","4.6.0-1","3.6.4","2.1-1","1.5.3","6.2.2","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-03-06","2025-01-16","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"cpyiixtdqi","dataKey":"98b5d103dbfd852fec58481f4ded8166"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.hornborga.com/naturen/tranor/">Hornborgasjön field station</a></li>
<li><a href="https://www.hornborga.com/naturen/transtatistik/">Hornborgasjön website</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_crane_observations.html</guid>
  <pubDate>Sat, 04 Oct 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_crane_observations.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>The Age Gap: Female vs Male Chess Players Worldwide</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_fide_chess_ratings.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset features chess player ratings from the <a href="https://www.fide.com/">FIDE (International Chess Federation)</a> for August and September 2025, sourced from FIDE’s monthly rating publications available on their <a href="https://www.fide.com/fide-september-2025-rating-list-vincent-keymer-debuts-in-top-10-open/">official website</a>. Chess ratings, based on the <a href="https://en.wikipedia.org/wiki/Elo_rating_system">Elo rating system</a>, provide a numerical estimate of a player’s strength relative to other competitors, with ratings increasing or decreasing based on performance against expected outcomes. The September 2025 rating list reflects results from major tournaments including the <a href="https://saintlouischessclub.org/tournaments/sinquefield-cup">Sinquefield Cup</a>, Quantbox Chennai Grand Masters, 61st International Akiba Rubinstein Chess Festival, and the Spanish League Honor Division 2025 held in Linares. Each player record includes their unique FIDE identification number, federation code (similar to <a href="https://www.mark-weeks.com/aboutcom/mw15b16.htm">IOC country codes</a>), various titles ranging from <a href="https://en.wikipedia.org/wiki/Grandmaster_(chess)">Grandmaster (GM)</a> to Candidate Master (CM), current Elo rating, number of games played, and birth year. The dataset was curated by <a href="https://github.com/jessjep">Jessica Moore</a> as part of the <a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a> weekly data project, providing researchers and chess enthusiasts with comprehensive rating data to analyze player improvements, federation distributions, ranking changes, and youth player performance trends.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_fide_chess_ratings.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This population pyramid visualization displays the average age and player count distribution across the top 20 chess federations by total registered players from FIDE’s August 2025 ratings. Each horizontal bar represents a federation, with blue bars extending rightward showing male players and pink bars extending leftward representing female players. The length of each bar corresponds to the average age of players in that gender group, while the numbers displayed indicate the total count of registered players. Country flags appear at the center dividing line between male and female demographics. The x-axis represents average age in years, with the scale showing absolute values for both directions. The data illustrates a consistent pattern where female players maintain younger average ages than their male counterparts across all federations.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13"></span>
<span id="cb1-14">fide_ratings_august <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-23/fide_ratings_august.csv'</span>)</span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fide_ratings_september &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-23/fide_ratings_september.csv')</span></span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  FIDE (International Chess Federation)"</span>,</span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-49">  social_caption_1,</span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">)</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-54">  github, github_username, xtwitter,</span>
<span id="cb2-55">  xtwitter_username, social_caption_1,</span>
<span id="cb2-56">  social_caption_2</span>
<span id="cb2-57">)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-60">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gender and Age Patterns in Chess players"</span></span>
<span id="cb2-61"></span>
<span id="cb2-62">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"International chess reveals a striking pattern where &lt;span style='color:#9E0C5BFF'&gt;**female**&lt;/span&gt; players are consistently younger than &lt;span style='color:#003DA5FF'&gt;**males**&lt;/span&gt;&lt;br&gt;across all federations, with India demonstrating the most youthful chess community globally."</span></span>
<span id="cb2-63"></span>
<span id="cb2-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fide_ratings_august |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fide_ratings_september |&gt; </span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"></span>
<span id="cb3-14">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> fide_ratings_august <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bday) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id, fed, age, sex, rating, games) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(fed, sex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nos =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rating =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(rating, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">games =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(games, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  </span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(fed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_player =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(nos)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(</span>
<span id="cb3-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> total_player,</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>,</span>
<span id="cb3-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">with_ties =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-31">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">age =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>age, age),</span>
<span id="cb3-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rating =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>rating, rating)</span>
<span id="cb3-35">  )</span>
<span id="cb3-36"></span>
<span id="cb3-37">country_levels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(total_player) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(fed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>()</span>
<span id="cb3-41"></span>
<span id="cb3-42">countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guess_field</span>(df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fed)</span>
<span id="cb3-43"></span>
<span id="cb3-44">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(fed, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> country_levels)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(</span>
<span id="cb3-48">      countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-49">        fed,</span>
<span id="cb3-50">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ioc"</span>,</span>
<span id="cb3-51">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso2c"</span></span>
<span id="cb3-52">      )</span>
<span id="cb3-53">    ),</span>
<span id="cb3-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_name =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-55">      country_code,</span>
<span id="cb3-56">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso2c"</span>,</span>
<span id="cb3-57">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span></span>
<span id="cb3-58">    )</span>
<span id="cb3-59">  )</span>
<span id="cb3-60"></span>
<span id="cb3-61">cpicks <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#003DA5FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#9E0C5BFF"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> fed,</span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> age</span>
<span id="cb4-6">    )</span>
<span id="cb4-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  </span>
<span id="cb4-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the data for males</span></span>
<span id="cb4-10">  ggchicklet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_chicklet</span>(</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span>),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span>),</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(age, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" yrs"</span>)),</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span>),</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(nos, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>),</span>
<span id="cb4-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-28">    ),</span>
<span id="cb4-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-33">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-34">  </span>
<span id="cb4-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plotting the data for Females</span></span>
<span id="cb4-36">  ggchicklet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_chicklet</span>(</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>),</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>),</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>age, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" yrs"</span>)),</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>,</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>),</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(nos, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>),</span>
<span id="cb4-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-54">    ),</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-59">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-60">  </span>
<span id="cb4-61">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add Country Names</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>),</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> country_name, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>),</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-69">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-70">  </span>
<span id="cb4-71">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add flags in the center</span></span>
<span id="cb4-72">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(sex <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span>),</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> country_code),</span>
<span id="cb4-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-77">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-78">  </span>
<span id="cb4-79">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text annotations for "Number of Players"</span></span>
<span id="cb4-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y),</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Male Players"</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-90">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y),</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of Female Players"</span>,</span>
<span id="cb4-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> cpicks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,</span>
<span id="cb4-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-101">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-102">  </span>
<span id="cb4-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb4-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(x), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove minus signs</span></span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>),</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-108">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-109">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>(</span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb4-111">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-112"></span>
<span id="cb4-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Average Age for FIDE players for the country"</span>,</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-121">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-125">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-128">    </span>
<span id="cb4-129">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-134">    ),</span>
<span id="cb4-135">    </span>
<span id="cb4-136">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-140">    ),</span>
<span id="cb4-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-145">    ),</span>
<span id="cb4-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ends =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>),</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-152">    ),</span>
<span id="cb4-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb4-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-158">    ),</span>
<span id="cb4-159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-164">    ),</span>
<span id="cb4-165">    </span>
<span id="cb4-166">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-170">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-171">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-175">    ),</span>
<span id="cb4-176">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-178">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-180">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-182">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-183">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-184">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-185">    ),</span>
<span id="cb4-186">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-187">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-188">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-189">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-190">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-191">    ),</span>
<span id="cb4-192">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-193">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-194">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-195">  )</span>
<span id="cb4-196"></span>
<span id="cb4-197"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-198">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-199">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-200">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_fide_chess_ratings.png"</span></span>
<span id="cb4-201">  ),</span>
<span id="cb4-202">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-203">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-204">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-205">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-206">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-207">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_fide_chess_ratings.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_fide_chess_ratings.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-5">    date, source</span>
<span id="cb6-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="chpmrcfdzd" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#chpmrcfdzd table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#chpmrcfdzd thead, #chpmrcfdzd tbody, #chpmrcfdzd tfoot, #chpmrcfdzd tr, #chpmrcfdzd td, #chpmrcfdzd th {
  border-style: none;
}

#chpmrcfdzd p {
  margin: 0;
  padding: 0;
}

#chpmrcfdzd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#chpmrcfdzd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#chpmrcfdzd .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#chpmrcfdzd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#chpmrcfdzd .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chpmrcfdzd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chpmrcfdzd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#chpmrcfdzd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#chpmrcfdzd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#chpmrcfdzd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#chpmrcfdzd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#chpmrcfdzd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#chpmrcfdzd .gt_spanner_row {
  border-bottom-style: hidden;
}

#chpmrcfdzd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#chpmrcfdzd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#chpmrcfdzd .gt_from_md > :first-child {
  margin-top: 0;
}

#chpmrcfdzd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#chpmrcfdzd .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#chpmrcfdzd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#chpmrcfdzd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#chpmrcfdzd .gt_row_group_first td {
  border-top-width: 2px;
}

#chpmrcfdzd .gt_row_group_first th {
  border-top-width: 2px;
}

#chpmrcfdzd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chpmrcfdzd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#chpmrcfdzd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#chpmrcfdzd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chpmrcfdzd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#chpmrcfdzd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#chpmrcfdzd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#chpmrcfdzd .gt_striped {
  background-color: #FAFAFA;
}

#chpmrcfdzd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#chpmrcfdzd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chpmrcfdzd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chpmrcfdzd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#chpmrcfdzd .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#chpmrcfdzd .gt_left {
  text-align: left;
}

#chpmrcfdzd .gt_center {
  text-align: center;
}

#chpmrcfdzd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#chpmrcfdzd .gt_font_normal {
  font-weight: normal;
}

#chpmrcfdzd .gt_font_bold {
  font-weight: bold;
}

#chpmrcfdzd .gt_font_italic {
  font-style: italic;
}

#chpmrcfdzd .gt_super {
  font-size: 65%;
}

#chpmrcfdzd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#chpmrcfdzd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#chpmrcfdzd .gt_indent_1 {
  text-indent: 5px;
}

#chpmrcfdzd .gt_indent_2 {
  text-indent: 10px;
}

#chpmrcfdzd .gt_indent_3 {
  text-indent: 15px;
}

#chpmrcfdzd .gt_indent_4 {
  text-indent: 20px;
}

#chpmrcfdzd .gt_indent_5 {
  text-indent: 25px;
}

#chpmrcfdzd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#chpmrcfdzd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="chpmrcfdzd" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="chpmrcfdzd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","bit","bit64","cli","colorspace","crayon","curl","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","4.6.0","4.6.0-1","3.6.4","2.1-1","1.5.3","6.2.2","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-03-06","2025-01-16","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"chpmrcfdzd","dataKey":"98b5d103dbfd852fec58481f4ded8166"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.fide.com/">FIDE (International Chess Federation)</a></li>
<li><a href="https://www.fide.com/fide-september-2025-rating-list-vincent-keymer-debuts-in-top-10-open/">official website</a></li>
<li><a href="https://en.wikipedia.org/wiki/Elo_rating_system">Elo rating system</a></li>
<li><a href="https://saintlouischessclub.org/tournaments/sinquefield-cup">Sinquefield Cup</a></li>
<li><a href="https://www.mark-weeks.com/aboutcom/mw15b16.htm">IOC country codes</a></li>
<li><a href="https://en.wikipedia.org/wiki/Grandmaster_(chess)">Grandmaster (GM)</a></li>
<li><a href="https://github.com/jessjep">Jessica Moore</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_fide_chess_ratings.html</guid>
  <pubDate>Thu, 25 Sep 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_fide_chess_ratings.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Global Cuisine Nutrition Profiles</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_allrecipes.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This week’s dataset explores a comprehensive collection of recipes from <a href="https://www.allrecipes.com/">Allrecipes.com</a>, curated through the <a href="https://cran.r-project.org/package=tastyR">tastyR package</a> and prepared for analysis. The collection includes two complementary datasets: <code>all_recipes</code> containing 14,426 general recipes, and <code>cuisines</code> featuring 2,218 recipes categorized by country of origin. Both datasets provide rich recipe information including ingredients, comprehensive nutritional data (calories, fat, carbohydrates, protein), cooking logistics (preparation and cooking times), user engagement metrics (ratings and reviews), and serving sizes. All data has been systematically cleaned and standardized to facilitate straightforward comparisons and visual exploration. The datasets open up numerous analytical opportunities, from identifying the most successful recipe authors and exploring relationships between cooking time and ratings, to discovering which cuisines achieve the highest user satisfaction and finding the most “actionable” recipes that balance high ratings with minimal time investment. This curated collection was assembled by <a href="https://github.com/owlzyseyes">Brian Mubia</a> and represents a valuable resource for exploring culinary trends, user preferences, and recipe performance patterns across diverse cooking traditions and styles.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_allrecipes.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This visualization explores the nutritional profiles of 42 global cuisines from the Allrecipes dataset, with each pie chart representing a different culinary tradition. The size of each pie is proportional to the average calories per recipe, ranging from Malaysian cuisine at 247 calories to Italian at 488 calories. Within each pie, colored segments reveal the macronutrient balance: red for carbohydrates, yellow for fats, and green for proteins, with percentages displayed for each segment. Country flags at the center help identify each cuisine’s origin. The data reveals fascinating patterns—Italian and German cuisines tend to be more calorie-dense, while Asian cuisines like Vietnamese and Thai generally show lower calorie averages. Some cuisines like Brazilian and Turkish show relatively balanced macronutrient distributions, while others like certain European cuisines lean more heavily toward carbohydrates, reflecting their traditional grain and pasta-based dishes.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<p>I created this comprehensive visualization using <a href="https://www.r-project.org/">R</a> and the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem, leveraging several specialized packages for enhanced functionality. The foundation was built with <a href="https://ggplot2.tidyverse.org/">ggplot2</a> for the core plotting framework, enhanced by <a href="https://wilkelab.org/ggtext/">ggtext</a> for markdown text support in titles and subtitles. I used <a href="https://github.com/yixuan/showtext">showtext</a> and <a href="https://fonts.google.com/">Google Fonts</a> to incorporate custom typography (Saira family fonts) for a polished aesthetic. The polar coordinate system transformed rectangular bar charts into pie charts using <code>coord_polar()</code>, while <a href="https://github.com/jimjam-slam/ggflags">ggflags</a> added country flags at each pie center. Data manipulation relied heavily on <a href="https://dplyr.tidyverse.org/">dplyr</a> for grouping and summarizing nutritional data, with <a href="https://tidyr.tidyverse.org/">tidyr</a> for reshaping data into the long format required for visualization. The <a href="https://scales.r-lib.org/">scales</a> package normalized calorie values to create proportional pie sizes, and <a href="https://patchwork.data-imaginist.com/">patchwork</a> enabled the multi-panel layout through <code>facet_wrap()</code>. Color choices used a custom palette to distinguish carbohydrates, fats, and proteins across the 42 featured cuisines.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3"></span>
<span id="cb1-4">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">)</span>
<span id="cb1-12"></span>
<span id="cb1-13">all_recipes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-16/all_recipes.csv'</span>)</span>
<span id="cb1-14">cuisines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-16/cuisines.csv'</span>)</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Source: Claude Sonnet 4.0</span></span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a tibble mapping cuisines to their primary country ISO-2 codes</span></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tibble)</span>
<span id="cb1-19"></span>
<span id="cb1-20">cuisine_country_mapping <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb1-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Southern Recipes"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Italian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cajun and Creole"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Malaysian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Indonesian"</span>, </span>
<span id="cb1-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vietnamese"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Spanish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tex-Mex"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Portuguese"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Soul Food"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Thai"</span>, </span>
<span id="cb1-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pakistani"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Peruvian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cuban"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Puerto Rican"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canadian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"French"</span>, </span>
<span id="cb1-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Korean"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Polish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chinese"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Austrian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"German"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Persian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Filipino"</span>, </span>
<span id="cb1-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Turkish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Greek"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jamaican"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Brazilian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Japanese"</span>, </span>
<span id="cb1-27">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Indian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Jewish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Argentinian"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Chilean"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scandinavian"</span>, </span>
<span id="cb1-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Amish and Mennonite"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Swedish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Australian and New Zealander"</span>, </span>
<span id="cb1-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lebanese"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Danish"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Israeli"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Norwegian"</span></span>
<span id="cb1-30">  ),</span>
<span id="cb1-31">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb1-32">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Southern Recipes - United States (Southern US cuisine)</span></span>
<span id="cb1-33">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"it"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Italian - Italy</span></span>
<span id="cb1-34">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cajun and Creole - United States (Louisiana)</span></span>
<span id="cb1-35">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"my"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Malaysian - Malaysia</span></span>
<span id="cb1-36">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Indonesian - Indonesia</span></span>
<span id="cb1-37">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vn"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vietnamese - Vietnam</span></span>
<span id="cb1-38">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"es"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spanish - Spain</span></span>
<span id="cb1-39">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tex-Mex - United States (Texas-Mexico border cuisine)</span></span>
<span id="cb1-40">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Portuguese - Portugal</span></span>
<span id="cb1-41">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Soul Food - United States (African-American cuisine)</span></span>
<span id="cb1-42">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"th"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Thai - Thailand</span></span>
<span id="cb1-43">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pk"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pakistani - Pakistan</span></span>
<span id="cb1-44">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pe"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Peruvian - Peru</span></span>
<span id="cb1-45">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cu"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cuban - Cuba</span></span>
<span id="cb1-46">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pr"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Puerto Rican - Puerto Rico</span></span>
<span id="cb1-47">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ca"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Canadian - Canada</span></span>
<span id="cb1-48">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fr"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># French - France</span></span>
<span id="cb1-49">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kr"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Korean - South Korea</span></span>
<span id="cb1-50">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pl"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Polish - Poland</span></span>
<span id="cb1-51">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cn"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Chinese - China</span></span>
<span id="cb1-52">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"at"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Austrian - Austria</span></span>
<span id="cb1-53">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"de"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># German - Germany</span></span>
<span id="cb1-54">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ir"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Persian - Iran</span></span>
<span id="cb1-55">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ph"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filipino - Philippines</span></span>
<span id="cb1-56">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tr"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Turkish - Turkey</span></span>
<span id="cb1-57">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gr"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Greek - Greece</span></span>
<span id="cb1-58">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jm"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jamaican - Jamaica</span></span>
<span id="cb1-59">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"br"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Brazilian - Brazil</span></span>
<span id="cb1-60">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ru"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Russian - Russia</span></span>
<span id="cb1-61">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jp"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Japanese - Japan</span></span>
<span id="cb1-62">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Indian - India</span></span>
<span id="cb1-63">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"il"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jewish - Israel (modern Jewish cuisine center)</span></span>
<span id="cb1-64">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ar"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Argentinian - Argentina</span></span>
<span id="cb1-65">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cl"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Chilean - Chile</span></span>
<span id="cb1-66">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scandinavian - Sweden (largest Scandinavian country)</span></span>
<span id="cb1-67">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"us"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Amish and Mennonite - United States (primarily Pennsylvania)</span></span>
<span id="cb1-68">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"se"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Swedish - Sweden</span></span>
<span id="cb1-69">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"au"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Australian and New Zealander - Australia (larger population)</span></span>
<span id="cb1-70">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lb"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lebanese - Lebanon</span></span>
<span id="cb1-71">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dk"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Danish - Denmark</span></span>
<span id="cb1-72">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"il"</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Israeli - Israel</span></span>
<span id="cb1-73">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no"</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Norwegian - Norway</span></span>
<span id="cb1-74">  )</span>
<span id="cb1-75">)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Brian Mubia"</span>,</span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-49">  social_caption_1,</span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">)</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-54">  github, github_username, xtwitter,</span>
<span id="cb2-55">  xtwitter_username, social_caption_1,</span>
<span id="cb2-56">  social_caption_2</span>
<span id="cb2-57">)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-60">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global Cuisine Nutrition Profiles"</span></span>
<span id="cb2-61"></span>
<span id="cb2-62">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pie chart size reflects average calories per recipe (value in brackets), while segments&lt;br&gt;show the balance of &lt;b style='color:#FF7676'&gt;**Carbohydrates**&lt;/b&gt;, &lt;b style='color:#F9D662'&gt;**Fats**&lt;/b&gt;, and &lt;b style='color:#7CAB7D'&gt;**Proteins**&lt;/b&gt; across the cuisines."</span></span>
<span id="cb2-63"></span>
<span id="cb2-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_recipes</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cuisines |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   count(country, sort = T) |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   print(n = 30)</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cuisines |&gt; </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># all_recipes |&gt; </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clause Sonnet 4.0</span></span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate summary statistics and carbs proportion for sorting</span></span>
<span id="cb3-20">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> cuisines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">calories =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(calories, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T),</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(fat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">carbs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(carbs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">protein =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(protein, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">avg_rating =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(avg_rating, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop'</span></span>
<span id="cb3-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-31">  </span>
<span id="cb3-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate carbs proportion for sorting</span></span>
<span id="cb3-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># mutate(</span></span>
<span id="cb3-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   total_macros = fat + carbs + protein,</span></span>
<span id="cb3-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   carbs_prop = carbs / total_macros</span></span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ) |&gt; </span></span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> n,</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>,</span>
<span id="cb3-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">with_ties =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb3-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-42"></span>
<span id="cb3-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort by carbs proportion (descending)</span></span>
<span id="cb3-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(calories)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-45">  </span>
<span id="cb3-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create radius scale based on calories (normalize between 0.1 and 0.4)</span></span>
<span id="cb3-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rescale</span>(</span>
<span id="cb3-49">      calories, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">247</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">488</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb3-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">range</span>(calories, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-51">      )</span>
<span id="cb3-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-53">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pull(country) |&gt; </span></span>
<span id="cb3-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paste0(collapse = ", ")</span></span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-56">    cuisine_country_mapping</span>
<span id="cb3-57">  )</span>
<span id="cb3-58"></span>
<span id="cb3-59">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(fat, carbs, protein),</span>
<span id="cb3-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nutrient"</span>,</span>
<span id="cb3-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"value"</span></span>
<span id="cb3-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reorder country factor to maintain the carbs proportion order</span></span>
<span id="cb3-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> df1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>country)</span>
<span id="cb3-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(</span>
<span id="cb3-70">    country</span>
<span id="cb3-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value =</span> value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cumsum</span>(value),</span>
<span id="cb3-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lag</span>(ymax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymid =</span> (ymax <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ymin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> radius</span>
<span id="cb3-80">  )</span>
<span id="cb3-81"></span>
<span id="cb3-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create custom labels for the facets</span></span>
<span id="cb3-83">strip_labels <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">distinct</span>(</span>
<span id="cb3-85">    country, calories</span>
<span id="cb3-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(country, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(calories, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>)</span>
<span id="cb3-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(label)</span>
<span id="cb3-91"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(strip_labels) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">levels</span>(plot_data<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>country)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb4-2">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> xmin, </span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax, </span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> ymin, </span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> ymax, </span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> nutrient</span>
<span id="cb4-11">    ),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col</span>
<span id="cb4-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb4-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(plot_data)),</span>
<span id="cb4-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(plot_data)),</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(plot_data)),</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(plot_data))</span>
<span id="cb4-20">    ),</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> xmin, </span>
<span id="cb4-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax, </span>
<span id="cb4-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> ymin, </span>
<span id="cb4-25">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> ymax</span>
<span id="cb4-26">    ),</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col</span>
<span id="cb4-29">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> xmax <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position at ~3/4 way to edge</span></span>
<span id="cb4-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> ymid,</span>
<span id="cb4-34">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(value<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>),</span>
<span id="cb4-35">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb4-36">    ),</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_size_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-41">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center position</span></span>
<span id="cb4-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center position</span></span>
<span id="cb4-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> country_code</span>
<span id="cb4-46">    ),</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-50">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>country,</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labeller</span>(</span>
<span id="cb4-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> strip_labels</span>
<span id="cb4-54">    )</span>
<span id="cb4-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span></span>
<span id="cb4-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Nutrient"</span>,</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Carbohydrates"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fat"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Protein"</span>),</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FF7676FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F9D662FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#7CAB7DFF"</span>)</span>
<span id="cb4-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-79">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-82">    </span>
<span id="cb4-83">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-88">    ),</span>
<span id="cb4-89">    </span>
<span id="cb4-90">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-96"> </span>
<span id="cb4-97">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panels</span></span>
<span id="cb4-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-105">    ),</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-108">    </span>
<span id="cb4-109">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-115">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-118">    ),</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-128">    ),</span>
<span id="cb4-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_markdown</span>(</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-134">    ),</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-138">  )</span>
<span id="cb4-139"></span>
<span id="cb4-140"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-141">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-142">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-143">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_allrecipes.png"</span></span>
<span id="cb4-144">  ),</span>
<span id="cb4-145">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-146">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-147">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-148">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-149">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-150">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_allrecipes.png"</span></span>
<span id="cb5-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb5-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb5-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_allrecipes.png"</span></span>
<span id="cb5-16">    )</span>
<span id="cb5-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb6-5">    date, source</span>
<span id="cb6-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="ojduxioxgm" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#ojduxioxgm table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ojduxioxgm thead, #ojduxioxgm tbody, #ojduxioxgm tfoot, #ojduxioxgm tr, #ojduxioxgm td, #ojduxioxgm th {
  border-style: none;
}

#ojduxioxgm p {
  margin: 0;
  padding: 0;
}

#ojduxioxgm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ojduxioxgm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ojduxioxgm .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ojduxioxgm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ojduxioxgm .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojduxioxgm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojduxioxgm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ojduxioxgm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ojduxioxgm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ojduxioxgm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ojduxioxgm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ojduxioxgm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ojduxioxgm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ojduxioxgm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ojduxioxgm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ojduxioxgm .gt_from_md > :first-child {
  margin-top: 0;
}

#ojduxioxgm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ojduxioxgm .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ojduxioxgm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ojduxioxgm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ojduxioxgm .gt_row_group_first td {
  border-top-width: 2px;
}

#ojduxioxgm .gt_row_group_first th {
  border-top-width: 2px;
}

#ojduxioxgm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojduxioxgm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ojduxioxgm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ojduxioxgm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojduxioxgm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojduxioxgm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ojduxioxgm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ojduxioxgm .gt_striped {
  background-color: #FAFAFA;
}

#ojduxioxgm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ojduxioxgm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojduxioxgm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojduxioxgm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ojduxioxgm .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ojduxioxgm .gt_left {
  text-align: left;
}

#ojduxioxgm .gt_center {
  text-align: center;
}

#ojduxioxgm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ojduxioxgm .gt_font_normal {
  font-weight: normal;
}

#ojduxioxgm .gt_font_bold {
  font-weight: bold;
}

#ojduxioxgm .gt_font_italic {
  font-style: italic;
}

#ojduxioxgm .gt_super {
  font-size: 65%;
}

#ojduxioxgm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ojduxioxgm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ojduxioxgm .gt_indent_1 {
  text-indent: 5px;
}

#ojduxioxgm .gt_indent_2 {
  text-indent: 10px;
}

#ojduxioxgm .gt_indent_3 {
  text-indent: 15px;
}

#ojduxioxgm .gt_indent_4 {
  text-indent: 20px;
}

#ojduxioxgm .gt_indent_5 {
  text-indent: 25px;
}

#ojduxioxgm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ojduxioxgm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="ojduxioxgm" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ojduxioxgm">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","RColorBrewer","Rcpp","bit","bit64","cli","colorspace","crayon","curl","dichromat","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","vroom","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.1-3","1.0.14","4.6.0","4.6.0-1","3.6.4","2.1-1","1.5.3","6.2.2","2.0-0.1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.3","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.4.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2022-04-03","2025-01-12","2025-03-06","2025-01-16","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2022-05-02","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2022-07-05","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2025-04-24","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"ojduxioxgm","dataKey":"dd8be12d481f1da9e432abf6a858392f"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.allrecipes.com/">Allrecipes.com</a></li>
<li><a href="https://cran.r-project.org/package=tastyR">tastyR package</a></li>
<li><a href="https://github.com/owlzyseyes">Brian Mubia</a></li>
<li><a href="https://www.r-project.org/">R</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
<li><a href="https://fonts.google.com/">Google Fonts</a></li>
<li><a href="https://github.com/jimjam-slam/ggflags">ggflags</a></li>
<li><a href="https://dplyr.tidyverse.org/">dplyr</a></li>
<li><a href="https://tidyr.tidyverse.org/">tidyr</a></li>
<li><a href="https://scales.r-lib.org/">scales</a></li>
<li><a href="https://patchwork.data-imaginist.com/">patchwork</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_allrecipes.html</guid>
  <pubDate>Mon, 22 Sep 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_allrecipes.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Passport Power Shifts: 2006-2025</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_henley_passport_index.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>The dataset explores passport power through the <a href="https://www.henleyglobal.com/passport-index/about">Henley Passport Index</a>, produced by <a href="https://www.henleyglobal.com/">Henley &amp; Partners</a>, which measures visa-free travel access for passport holders worldwide. The index assigns a score of 1 to destinations where no visa is required, or where travelers can obtain a visa on arrival, visitor’s permit, or electronic travel authority (ETA) without pre-departure government approval. A score of 0 is given when a traditional visa or government-approved electronic visa (e-Visa) is required before departure. The total passport score equals the number of visa-free destinations available to holders of that passport. <a href="https://www.henleyglobal.com/passport-index/ranking">Henley &amp; Partners updates the Global Passport Index rankings</a> monthly, with recent <a href="https://edition.cnn.com/2025/07/22/travel/world-most-powerful-passports-july-2025">changes to US passport rankings</a> drawing significant media attention. The data is sourced from the <a href="http://api.henleypassportindex.com/api/v3/countries">Henley Passport Index API</a> and includes comprehensive information about visa requirements, visa-free access, and electronic travel authorizations across different countries and regions over multiple years, providing insights into how passport strength correlates with geopolitical relationships, economic stability, and international mobility trends.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_henley_passport_index.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Each bar represents a country’s change in Henley Passport Index ranking between 2006 and 2025. Positive values (green bars extending right) show improved rankings, while negative values (red bars extending left) indicate declined rankings. Flags mark each country, with labels positioned to avoid overlap.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(ggforce)</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To plot geom_convex_hull()</span></span>
<span id="cb1-3">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(MASS, fields)</span>
<span id="cb1-4"></span>
<span id="cb1-5">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-6">  tidyverse, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-7"></span>
<span id="cb1-8">  scales, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-9">  fontawesome, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-10">  ggtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-11">  showtext, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-12">  colorspace, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">  patchwork, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-15">  sf <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("ggflags", repos = c(</span></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   "https://jimjam-slam.r-universe.dev",</span></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   "https://cloud.r-project.org"))</span></span>
<span id="cb1-21"></span>
<span id="cb1-22">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(ggflags)</span>
<span id="cb1-23"></span>
<span id="cb1-24"></span>
<span id="cb1-25">country_lists <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-09/country_lists.csv"</span>)</span>
<span id="cb1-26"></span>
<span id="cb1-27">rank_by_year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-09/rank_by_year.csv"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">)</span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">)</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">)</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Henley Passport Index by Henley &amp; Partners"</span>,</span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>,</span>
<span id="cb2-49">  social_caption_1,</span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>,</span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">)</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-54">  github, github_username, xtwitter,</span>
<span id="cb2-55">  xtwitter_username, social_caption_1,</span>
<span id="cb2-56">  social_caption_2</span>
<span id="cb2-57">)</span>
<span id="cb2-58"></span>
<span id="cb2-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-60">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Passport Power Shifts (2006-2025)"</span></span>
<span id="cb2-61"></span>
<span id="cb2-62">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Based on visa-free destinations accessible to passport holders, the Henley Index reveals dramatic shifts in global mobility. UAE's spectacular 39-position climb and declines by poorer, war-torn economies highlight how economic growth and diplomatic expansion are redefining travel freedom worldwide."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">105</span>)</span>
<span id="cb2-63"></span>
<span id="cb2-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span>
<span id="cb2-65"></span>
<span id="cb2-66"></span>
<span id="cb2-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-68">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-69">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-70">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-71">)</span>
<span id="cb2-72">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-73">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-74">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-75">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-76">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-77">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-78">plot_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-79">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Henley Passport Index by Henley &amp; Partners"</span>,</span>
<span id="cb2-80">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;**Code:** "</span>,</span>
<span id="cb2-81">  social_caption_1,</span>
<span id="cb2-82">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;br&gt;**Graphics:** "</span>,</span>
<span id="cb2-83">  social_caption_2</span>
<span id="cb2-84">)</span>
<span id="cb2-85"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(</span>
<span id="cb2-86">  github, github_username, xtwitter,</span>
<span id="cb2-87">  xtwitter_username, social_caption_1,</span>
<span id="cb2-88">  social_caption_2</span>
<span id="cb2-89">)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># country_lists |&gt;</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt;</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rank_by_year |&gt;</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt;</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # A basic plot of changing ranks</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rank_by_year |&gt;</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     aes(</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       x = year,</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       y = rank,</span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       group = code,</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       colour = code</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_line() +</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   theme(</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     legend.position = "none"</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Credits: Claude Sonnet 4.0</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate ranking changes from 2006 to 2025</span></span>
<span id="cb3-30">ranking_changes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rank_by_year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter for the start and end years</span></span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2006</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ensure we have both years for each country</span></span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(code, country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate the change in ranking (2006 rank - 2025 rank)</span></span>
<span id="cb3-37">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Positive values mean improvement (lower rank number = better)</span></span>
<span id="cb3-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank_2006 =</span> rank[year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2006</span>],</span>
<span id="cb3-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank_2025 =</span> rank[year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2025</span>],</span>
<span id="cb3-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank_change =</span> rank_2006 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> rank_2025,</span>
<span id="cb3-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"drop"</span></span>
<span id="cb3-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-44">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sort by rank change to identify top movers</span></span>
<span id="cb3-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(rank_change))</span>
<span id="cb3-46"> </span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # View the biggest improvers and fallers</span></span>
<span id="cb3-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Top 10 Countries with Most Improved Rankings:")</span></span>
<span id="cb3-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># head(ranking_changes, 10)</span></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Top 10 Countries with Most Fallen Rankings:")</span></span>
<span id="cb3-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tail(ranking_changes, 10)</span></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Create the change column</span></span>
<span id="cb3-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rank_by_year_with_change &lt;- rank_by_year %&gt;%</span></span>
<span id="cb3-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   left_join(</span></span>
<span id="cb3-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     ranking_changes %&gt;%</span></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       mutate(</span></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#         change = case_when(</span></span>
<span id="cb3-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           # Top 10 improvers (highest positive rank_change)</span></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           rank(-rank_change, ties.method = "first") &lt;= 10 ~ "improved",</span></span>
<span id="cb3-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           # Top 10 fallers (lowest/most negative rank_change)</span></span>
<span id="cb3-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           rank(rank_change, ties.method = "first") &lt;= 10 ~ "fallen",</span></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           # All others</span></span>
<span id="cb3-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#           TRUE ~ "others"</span></span>
<span id="cb3-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#         )</span></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       ) %&gt;%</span></span>
<span id="cb3-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       select(code, change),</span></span>
<span id="cb3-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     by = "code"</span></span>
<span id="cb3-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) %&gt;%</span></span>
<span id="cb3-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   # Handle countries that might not have data for both 2006 and 2025</span></span>
<span id="cb3-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   mutate(change = ifelse(is.na(change), "others", change))</span></span>
<span id="cb3-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Verify the results</span></span>
<span id="cb3-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Summary of change categories:")</span></span>
<span id="cb3-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rank_by_year_with_change %&gt;%</span></span>
<span id="cb3-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   count(change)</span></span>
<span id="cb3-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Show the top improvers and fallers with their details</span></span>
<span id="cb3-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Top 10 Improved Countries (2006 vs 2025):")</span></span>
<span id="cb3-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ranking_changes %&gt;%</span></span>
<span id="cb3-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   head(10) %&gt;%</span></span>
<span id="cb3-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(country, rank_2006, rank_2025, rank_change)</span></span>
<span id="cb3-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print("Top 10 Fallen Countries (2006 vs 2025):")</span></span>
<span id="cb3-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ranking_changes %&gt;%</span></span>
<span id="cb3-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   tail(10) %&gt;%</span></span>
<span id="cb3-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(country, rank_2006, rank_2025, rank_change)</span></span>
<span id="cb3-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # Optional: Create a visualization of the biggest changes</span></span>
<span id="cb3-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggplot2)</span></span>
<span id="cb3-92"></span>
<span id="cb3-93">top_movers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ranking_changes <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(rank_change <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span>),</span>
<span id="cb3-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_ordered =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(country, rank_change),</span>
<span id="cb3-98">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert country codes to lowercase for ggflags</span></span>
<span id="cb3-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flag_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(code),</span>
<span id="cb3-100">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create modified rank_change that leaves gap for flags</span></span>
<span id="cb3-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-102">      rank_change <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb3-103">      rank_change <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb3-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.default =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-105">    ),</span>
<span id="cb3-106">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position for country labels</span></span>
<span id="cb3-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-108">      direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb3-109">      direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb3-110">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-111">    ),</span>
<span id="cb3-112">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Hjust for country labels</span></span>
<span id="cb3-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_hjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-114">      direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-115">      direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-116">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb3-117">    )</span>
<span id="cb3-118">  )</span>
<span id="cb3-119"></span>
<span id="cb3-120">country_lists <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-121">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code, country, visa_free_access)</span>
<span id="cb3-122"></span>
<span id="cb3-123"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">############################# Plot 2 #######################################</span></span>
<span id="cb3-124"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get country codes for Visa Free Access</span></span>
<span id="cb3-125"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inspiration: Claude AI Sonnet 4.0</span></span>
<span id="cb3-126"></span>
<span id="cb3-127"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-128"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(jsonlite)</span>
<span id="cb3-129"></span>
<span id="cb3-130">codes_filter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>lflags <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>()</span>
<span id="cb3-132"></span>
<span id="cb3-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract visa-free access data to long format</span></span>
<span id="cb3-134">visa_free_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> country_lists <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-135">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code, country, visa_free_access) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-136">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out rows with empty or null visa_free_access</span></span>
<span id="cb3-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(visa_free_access) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> visa_free_access <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[]"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> visa_free_access <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-138">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse JSON and extract country codes</span></span>
<span id="cb3-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-140">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse the JSON string to extract the nested array</span></span>
<span id="cb3-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parsed_json =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(visa_free_access, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>{</span>
<span id="cb3-142">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatch</span>({</span>
<span id="cb3-143">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Parse the JSON - it appears to be a nested array format</span></span>
<span id="cb3-144">        parsed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fromJSON</span>(.x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flatten =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-145">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract the first level of the nested structure</span></span>
<span id="cb3-146">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.list</span>(parsed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(parsed) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb3-147">          parsed[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb3-148">        } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb3-149">          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-150">        }</span>
<span id="cb3-151">      }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(e) {</span>
<span id="cb3-152">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Return NULL if parsing fails</span></span>
<span id="cb3-153">        <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-154">      })</span>
<span id="cb3-155">    })</span>
<span id="cb3-156">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-157">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Filter out rows where JSON parsing failed</span></span>
<span id="cb3-158">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_lgl</span>(parsed_json, is.null)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-159">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Unnest the parsed JSON data with name separation</span></span>
<span id="cb3-160">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(parsed_json, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-161">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean and select relevant columns</span></span>
<span id="cb3-162">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(</span>
<span id="cb3-163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin_code =</span> code,</span>
<span id="cb3-164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin_country =</span> country,</span>
<span id="cb3-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination_code =</span> parsed_json_code,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will be the "code" field from JSON</span></span>
<span id="cb3-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination_country =</span> parsed_json_name  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This will be the "name" field from JSON</span></span>
<span id="cb3-167">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-168">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove any rows with missing destination codes</span></span>
<span id="cb3-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(destination_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> destination_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-170">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-171">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(</span>
<span id="cb3-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(origin_code, destination_code),</span>
<span id="cb3-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.fns =</span> str_to_lower</span>
<span id="cb3-174">    )</span>
<span id="cb3-175">  )</span>
<span id="cb3-176"></span>
<span id="cb3-177"></span>
<span id="cb3-178"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Show summary by origin country</span></span>
<span id="cb3-179">visa_free_summary <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> visa_free_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-180">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(origin_code, origin_country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-181">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-182">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">visa_free_destinations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-183">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.groups =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop'</span></span>
<span id="cb3-184">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-185">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(visa_free_destinations))</span>
<span id="cb3-186"></span>
<span id="cb3-187"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-188"></span>
<span id="cb3-189"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prepare the data for plotting</span></span>
<span id="cb3-190">visa_free_plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> visa_free_long <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-191">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(origin_country, origin_code, destination_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-192">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(destination_code <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> codes_filter) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-193">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count visa-free destinations per origin country</span></span>
<span id="cb3-194">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(origin_code, origin_country) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-195">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_destinations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-196">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-197">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Order origin countries by total destinations (most at top)</span></span>
<span id="cb3-198">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-199">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin_country_ordered =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(origin_country, total_destinations, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.desc =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-200">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin_country_ordered =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(origin_country_ordered)</span>
<span id="cb3-201">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-202">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For each origin country, arrange destinations and create symmetric x positions</span></span>
<span id="cb3-203">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(origin_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-204">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(destination_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-205">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-206">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rank_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(),</span>
<span id="cb3-207">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_destinations =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(),</span>
<span id="cb3-208">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create symmetric positions around 0</span></span>
<span id="cb3-209">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_position =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (n_destinations[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-210">      <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-211">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb3-212">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>((n_destinations[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), ((n_destinations[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> n_destinations[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-213">    }</span>
<span id="cb3-214">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-215">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> top_movers <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> country_ordered, </span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> direction</span>
<span id="cb4-6">    )</span>
<span id="cb4-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-12">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> base_x,</span>
<span id="cb4-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> rank_change</span>
<span id="cb4-17">    ),</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span></span>
<span id="cb4-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add flags</span></span>
<span id="cb4-22">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> flag_code), </span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb4-26">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add country labels</span></span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> label_x, </span>
<span id="cb4-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> country, </span>
<span id="cb4-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> label_hjust</span>
<span id="cb4-33">    ), </span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb4-40">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d62728"</span>, </span>
<span id="cb4-41">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#2ca02c"</span></span>
<span id="cb4-42">      )</span>
<span id="cb4-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-44">  </span>
<span id="cb4-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb4-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb4-48">        direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-49">        direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-50">        <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-51">      ),</span>
<span id="cb4-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> country_ordered,</span>
<span id="cb4-53">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-54">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:grey20'&gt;"</span>, rank_2006, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;"</span>,</span>
<span id="cb4-55">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" → "</span>,</span>
<span id="cb4-56">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:black'&gt;"</span>, rank_2025, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;"</span></span>
<span id="cb4-57">      ),</span>
<span id="cb4-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb4-59">        direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Improved"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-60">        direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fallen"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-61">        <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-62">      )</span>
<span id="cb4-63">    ),</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb4-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-69">  </span>
<span id="cb4-70">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add legend for rank explanation</span></span>
<span id="cb4-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-75">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:grey20'&gt;Rank (2006)&lt;/span&gt;"</span>,</span>
<span id="cb4-76">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" → "</span>,</span>
<span id="cb4-77">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:black'&gt;Rank (2025)&lt;/span&gt;"</span></span>
<span id="cb4-78">    ),</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb4-85">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lower rank numbers indicate stronger passports"</span>,</span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb4-95">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb4-98">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Change in Rankings (2025 rank - 2006 rank)"</span>,</span>
<span id="cb4-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-111">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-114">    </span>
<span id="cb4-115">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-120">    ),</span>
<span id="cb4-121">    </span>
<span id="cb4-122">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-126">    </span>
<span id="cb4-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-129">    ),</span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb4-134">    ),</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(</span>
<span id="cb4-137">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ends =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span></span>
<span id="cb4-138">      ),</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb4-141">    ),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-144">    ),</span>
<span id="cb4-145">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb4-150">    ),</span>
<span id="cb4-151"></span>
<span id="cb4-152">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-161">    ),</span>
<span id="cb4-162">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-170">    ),</span>
<span id="cb4-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-178">    ),</span>
<span id="cb4-179">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-180">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-181">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-182">  )</span>
<span id="cb4-183"></span>
<span id="cb4-184"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-185">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-186">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-187">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_henley_passport_index.png"</span></span>
<span id="cb4-188">  ),</span>
<span id="cb4-189">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-190">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-191">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-192">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-193">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-194">)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot-2" class="level3">
<h3 class="anchored" data-anchor-id="the-plot-2">The Plot 2</h3>
<p>This visualization was created using R to transform complex passport data into an intuitive flag-based display. The foundation relied on the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem for data manipulation, particularly using <code>jsonlite</code> to parse the nested JSON structure containing visa-free access information from the <a href="http://api.henleypassportindex.com/api/v3/countries">Henley Passport Index API</a>. The core challenge involved unnesting the complex JSON data structure and creating symmetric positioning for destination flags around a central axis using conditional logic within grouped <code>mutate()</code> operations. The visual appeal comes from the <a href="https://github.com/jimjam-slam/ggflags">ggflags package</a>, which renders actual country flags instead of text labels, making patterns immediately recognizable. I used <code>geom_flag()</code> twice: once for visa-free destinations positioned symmetrically along each row, and again for origin country flags anchored to the left edge using <code>x = -Inf</code> positioning. Typography and styling leverage <a href="https://github.com/yixuan/showtext">showtext</a> for Google Fonts integration (<a href="https://fonts.google.com/specimen/Saira">Saira font family</a>), while <a href="https://wilkelab.org/ggtext/">ggtext</a> enables rich text formatting for the caption with embedded social media icons using Font Awesome. The annotations system replaces traditional plot titles with precisely positioned text elements using <code>annotate(geom = "text")</code> and <code>annotate(geom = "richtext")</code>, providing complete control over placement and styling.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the plot</span></span>
<span id="cb5-2"></span>
<span id="cb5-3">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> visa_free_plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_position,</span>
<span id="cb5-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> origin_country_ordered,</span>
<span id="cb5-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> destination_code,</span>
<span id="cb5-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> destination_code</span>
<span id="cb5-10">    )</span>
<span id="cb5-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> destination_code), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-14">  </span>
<span id="cb5-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add origin country flags at the left end</span></span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb5-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> origin_code, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> origin_country_ordered), </span>
<span id="cb5-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb5-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> visa_free_plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(origin_code, origin_country_ordered)</span>
<span id="cb5-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb5-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"("</span>,  visa_free_destinations, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>),</span>
<span id="cb5-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> origin_country_ordered</span>
<span id="cb5-28">    ), </span>
<span id="cb5-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb5-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,</span>
<span id="cb5-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb5-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb5-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> visa_free_plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(visa_free_summary)</span>
<span id="cb5-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-38">  </span>
<span id="cb5-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add title annotation at bottom left</span></span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb5-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>,</span>
<span id="cb5-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Global</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Visa-Free</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Access</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Patterns"</span>,</span>
<span id="cb5-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span>,</span>
<span id="cb5-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to geom_text size</span></span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb5-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb5-50">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-51">  </span>
<span id="cb5-52">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add subtitle annotation below title</span></span>
<span id="cb5-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb5-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>,</span>
<span id="cb5-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Each dot represents a destination country with visa-free access for the Country's passport holders"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(),</span>
<span id="cb5-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb5-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to geom_text size</span></span>
<span id="cb5-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-62">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-63">  </span>
<span id="cb5-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add caption annotation at bottom right</span></span>
<span id="cb5-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb5-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"richtext"</span>,</span>
<span id="cb5-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>,</span>
<span id="cb5-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> plot_caption_2,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace with your actual caption</span></span>
<span id="cb5-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.02</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to geom_richtext size</span></span>
<span id="cb5-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb5-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb5-76">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-77">  </span>
<span id="cb5-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb5-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>))</span>
<span id="cb5-81">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove plot title</span></span>
<span id="cb5-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove plot subtitle</span></span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb5-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-88">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-89">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb5-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb5-92">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-94">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb5-95">    </span>
<span id="cb5-96">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb5-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-101">    ),</span>
<span id="cb5-102">    </span>
<span id="cb5-103">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb5-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb5-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb5-109">    ),</span>
<span id="cb5-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-112">    </span>
<span id="cb5-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-119">    </span>
<span id="cb5-120">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove plot title and subtitle themes since they're now annotations</span></span>
<span id="cb5-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove since using annotation instead</span></span>
<span id="cb5-124">    </span>
<span id="cb5-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-128">  )</span>
<span id="cb5-129"></span>
<span id="cb5-130"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-131">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-132">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-133">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_henley_passport_index_2.png"</span></span>
<span id="cb5-134">  ),</span>
<span id="cb5-135">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb5-136">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb5-137">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>,</span>
<span id="cb5-138">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb5-139">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb5-140">)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_henley_passport_index_2.png" class="img-fluid figure-img"></p>
<figcaption>This visualization displays global visa-free travel patterns using the Henley Passport Index data. Each row represents a passport-holding country (shown by flags on the left), ordered from most to least visa-free destinations. The colored dots represent destination countries where visa-free travel is permitted, positioned symmetrically around the center axis. Destination countries are depicted as flag icons rather than text labels, making travel patterns immediately recognizable. Numbers in parentheses indicate the total count of visa-free destinations available to each passport holder.</figcaption>
</figure>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-7">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-8">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_henley_passport_index_2.png"</span></span>
<span id="cb6-9">)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb6-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb6-12">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb6-14">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>,</span>
<span id="cb6-15">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_henley_passport_index.png"</span></span>
<span id="cb6-16">    )</span>
<span id="cb6-17">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package,</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion,</span>
<span id="cb7-5">    date, source</span>
<span id="cb7-6">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-7">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-8">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb7-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb7-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-12">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb7-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb7-15">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="oqatixmdjd" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#oqatixmdjd table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oqatixmdjd thead, #oqatixmdjd tbody, #oqatixmdjd tfoot, #oqatixmdjd tr, #oqatixmdjd td, #oqatixmdjd th {
  border-style: none;
}

#oqatixmdjd p {
  margin: 0;
  padding: 0;
}

#oqatixmdjd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oqatixmdjd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oqatixmdjd .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oqatixmdjd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oqatixmdjd .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oqatixmdjd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqatixmdjd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oqatixmdjd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oqatixmdjd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oqatixmdjd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oqatixmdjd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oqatixmdjd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oqatixmdjd .gt_spanner_row {
  border-bottom-style: hidden;
}

#oqatixmdjd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oqatixmdjd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oqatixmdjd .gt_from_md > :first-child {
  margin-top: 0;
}

#oqatixmdjd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oqatixmdjd .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oqatixmdjd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oqatixmdjd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oqatixmdjd .gt_row_group_first td {
  border-top-width: 2px;
}

#oqatixmdjd .gt_row_group_first th {
  border-top-width: 2px;
}

#oqatixmdjd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqatixmdjd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oqatixmdjd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oqatixmdjd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqatixmdjd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqatixmdjd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oqatixmdjd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oqatixmdjd .gt_striped {
  background-color: #FAFAFA;
}

#oqatixmdjd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oqatixmdjd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oqatixmdjd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqatixmdjd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oqatixmdjd .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oqatixmdjd .gt_left {
  text-align: left;
}

#oqatixmdjd .gt_center {
  text-align: center;
}

#oqatixmdjd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oqatixmdjd .gt_font_normal {
  font-weight: normal;
}

#oqatixmdjd .gt_font_bold {
  font-weight: bold;
}

#oqatixmdjd .gt_font_italic {
  font-style: italic;
}

#oqatixmdjd .gt_super {
  font-size: 65%;
}

#oqatixmdjd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oqatixmdjd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oqatixmdjd .gt_indent_1 {
  text-indent: 5px;
}

#oqatixmdjd .gt_indent_2 {
  text-indent: 10px;
}

#oqatixmdjd .gt_indent_3 {
  text-indent: 15px;
}

#oqatixmdjd .gt_indent_4 {
  text-indent: 20px;
}

#oqatixmdjd .gt_indent_5 {
  text-indent: 25px;
}

#oqatixmdjd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oqatixmdjd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="oqatixmdjd" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="oqatixmdjd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","KernSmooth","MASS","R6","RColorBrewer","Rcpp","bit","bit64","class","classInt","cli","colorspace","crayon","curl","dichromat","digest","dotCall64","dplyr","e1071","evaluate","farver","fastmap","fields","fontawesome","forcats","generics","ggflags","ggforce","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","maps","pacman","paletteer","patchwork","pillar","pkgconfig","polyclip","proxy","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","sf","showtext","showtextdb","snakecase","spam","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tweenr","tzdb","units","vctrs","viridisLite","vroom","withr","xfun","xml2","yaml"],"Version":["1.2.3","2.23-26","7.3-65","2.6.1","1.1-3","1.0.14","4.6.0","4.6.0-1","7.3-23","0.4-11","3.6.4","2.1-1","1.5.3","6.2.2","2.0-0.1","0.6.37","1.2","1.1.4","1.7-16","1.0.3","2.1.2","1.2.0","16.3.1","0.5.3","1.0.0","0.1.3","0.0.4","0.4.2","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","3.4.2.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.10-7","0.4-27","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.4.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","2.11-1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","2.0.3","0.5.0","0.8-7","0.6.5","0.4.2","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2025-01-01","2025-02-28","2025-02-15","2022-04-03","2025-01-12","2025-03-06","2025-01-16","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2022-05-02","2024-08-19","2024-10-04","2023-11-17","2024-09-16","2025-01-10","2024-05-13","2024-05-15","2025-03-08","2024-11-16","2023-01-29","2022-07-05","2023-10-10","2024-02-19","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-11-10","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2024-07-23","2022-06-09","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2025-04-24","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-01-20","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2024-02-26","2025-03-15","2025-03-11","2023-12-01","2023-05-02","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","https://jimjam-slam.r-universe.dev (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"oqatixmdjd","dataKey":"6f1ea0724be3643cb1e7bab630bb6b39"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.henleyglobal.com/passport-index/about">Henley Passport Index</a></li>
<li><a href="https://www.henleyglobal.com/">Henley &amp; Partners</a></li>
<li><a href="https://www.henleyglobal.com/passport-index/ranking">Henley &amp; Partners updates the Global Passport Index rankings</a></li>
<li><a href="https://edition.cnn.com/2025/07/22/travel/world-most-powerful-passports-july-2025">changes to US passport rankings</a></li>
<li><a href="http://api.henleypassportindex.com/api/v3/countries">Henley Passport Index API</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://github.com/jimjam-slam/ggflags">ggflags package</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
<li><a href="https://fonts.google.com/specimen/Saira">Saira font family</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>{ggflags}</category>
  <category>{ggtext}</category>
  <category>Claude Sonnet Code</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_henley_passport_index.html</guid>
  <pubDate>Sat, 13 Sep 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_henley_passport_index.png" medium="image" type="image/png" height="198" width="144"/>
</item>
<item>
  <title>A map of Australia’s Frog Families</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_australian_frogs.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This week’s dataset explores Australian frog biodiversity through the 2023 release of <a href="https://www.frogid.net.au/explore">FrogID data</a>, representing the sixth annual publication from this groundbreaking citizen science initiative. <a href="https://www.frogid.net.au/">FrogID</a> is an innovative mobile app that enables citizen scientists across Australia to record and submit frog calls, which are then expertly identified by museum professionals. Since its launch in 2017, this collaborative effort has generated data that has contributed to over 30 scientific papers examining frog ecology, taxonomy, and conservation. The dataset is particularly significant given that Australia hosts 257 unique native frog species—most found nowhere else on Earth—with nearly one in five species currently threatened with extinction due to climate change, urbanization, disease, and invasive species. The data includes occurrence records with precise geographic coordinates, temporal information, and species identifications validated by experts, offering researchers and data enthusiasts a comprehensive view of Australian frog distributions and calling patterns. This rich dataset, formally documented in <a href="https://zookeys.pensoft.net/">ZooKeys</a> by Rowley &amp; Callaghan (2020), provides an invaluable resource for understanding the current state of Australia’s imperiled amphibian fauna and supports ongoing conservation efforts through community-driven scientific discovery.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_australian_frogs.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution map based on citizen-contributed frog call recordings shows marked geographic segregation among Australia’s five major amphibian subfamilies. Each dot represents a validated frog call recording from the FrogID citizen science database, with colors indicating the five major Australian frog subfamilies. Shaded regions highlight core distribution areas where each subfamily’s populations are most concentrated. The map demonstrates the stark biogeographic divide between widespread generalist subfamilies (Hylidae and Myobatrachidae) that occur across Australia’s diverse environments, and tropical specialists (Ranidae, Bufonidae, and Microhylidae) restricted to the humid northeastern coastal regions.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<p>This visualization was created using R with several specialized packages for spatial analysis and advanced plotting techniques. The core data manipulation relied on the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem, particularly <a href="https://dplyr.tidyverse.org/">dplyr</a> for data wrangling and <a href="https://ggplot2.tidyverse.org/">ggplot2</a> for the base mapping framework. Spatial operations were handled using <a href="https://r-spatial.github.io/sf/">sf</a> for coordinate transformations and map clipping, while the Australian map boundaries came from <a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a>. The key analytical challenge—identifying the 70% most concentrated points for each subfamily—was solved using kernel density estimation through <a href="https://www.rdocumentation.org/packages/MASS/versions/7.3-61/topics/kde2d">MASS::kde2d()</a> and <a href="https://www.rdocumentation.org/packages/fields/versions/16.3/topics/interp.surface">fields::interp.surface()</a> to calculate density at each point location, then ranking and selecting the highest-density observations. The striking convex hulls that define each subfamily’s core distribution were created using <a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">ggforce::geom_mark_hull()</a>, which automatically generates smooth, labeled boundary polygons around point clusters. Additional aesthetic enhancements included the <a href="https://nschiett.github.io/fishualize/">fishualize</a> color palette for subfamily differentiation, <a href="https://wilkelab.org/ggtext/">ggtext</a> for HTML-formatted text elements with coloured subfamily names, and <a href="https://github.com/yixuan/showtext">showtext</a> for custom Google Fonts integration, creating a publication-ready visualization that clearly communicates Australia’s distinct amphibian bio-geographic patterns.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(ggforce)</span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To plot geom_convex_hull()</span></span>
<span id="cb1-3">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(MASS, fields)</span>
<span id="cb1-4"></span>
<span id="cb1-5">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-6">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-7">  </span>
<span id="cb1-8">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-9">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-10">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-11">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-12">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-13"></span>
<span id="cb1-14">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-15">  sf                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-16">)</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using R</span></span>
<span id="cb1-19">frogID_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-02/frogID_data.csv'</span>)</span>
<span id="cb1-20"></span>
<span id="cb1-21">frog_names <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-09-02/frog_names.csv'</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  FrogID App; Rowley &amp; Callaghan (2020)"</span>, </span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-49">  social_caption_1, </span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">  )</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-54">   xtwitter_username, social_caption_1, </span>
<span id="cb2-55">   social_caption_2)</span>
<span id="cb2-56"></span>
<span id="cb2-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-58">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Endemic Boundaries:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Australia's Frog Geography"</span></span>
<span id="cb2-59"></span>
<span id="cb2-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding Subtitle:</span></span>
<span id="cb2-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First, get the color palette to match your plot</span></span>
<span id="cb2-62">mypal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fishualize::Balistapus_undulatus"</span>)</span>
<span id="cb2-63"></span>
<span id="cb2-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create color mapping for subfamilies</span></span>
<span id="cb2-65">subfamily_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setNames</span>(</span>
<span id="cb2-66">  mypal, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hylid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myobatrachid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microhylidae"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Toad"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ranid"</span>))</span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Formatted subtitle with ggtext color coding and line breaks</span></span>
<span id="cb2-69">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-70">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Australia's five frog subfamilies reveal a striking biogeographic pattern. While &lt;span style='color:"</span>,</span>
<span id="cb2-71">  subfamily_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hylid"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;**Hylid**&lt;/span&gt; and &lt;span style='color:"</span>,</span>
<span id="cb2-72">  subfamily_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myobatrachid"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;**Myobatrachid**&lt;/span&gt;&lt;br&gt;"</span>,</span>
<span id="cb2-73">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"frogs colonize diverse habitats across the continent, &lt;span style='color:"</span>,</span>
<span id="cb2-74">  subfamily_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ranid"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;**Ranid**&lt;/span&gt;, &lt;span style='color:"</span>,</span>
<span id="cb2-75">  subfamily_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Toad"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;**Toad**&lt;/span&gt;, and &lt;span style='color:"</span>,</span>
<span id="cb2-76">  subfamily_colors[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microhylidae"</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;**Microhylidae**&lt;/span&gt; species are confined&lt;br&gt;"</span>,</span>
<span id="cb2-77">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"to Australia's tropical northeastern coast, highlighting how climate zones have shaped evolution."</span></span>
<span id="cb2-78">)</span>
<span id="cb2-79"></span>
<span id="cb2-80"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span>
<span id="cb2-81"></span>
<span id="cb2-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get a map of Australia to plot</span></span>
<span id="cb2-83"></span>
<span id="cb2-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create bounding box for latitude restriction</span></span>
<span id="cb2-85">clip_polygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>(</span>
<span id="cb2-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(</span>
<span id="cb2-87">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">155</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_crs</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4326</span>)</span>
<span id="cb2-89">  )</span>
<span id="cb2-90">)</span>
<span id="cb2-91"></span>
<span id="cb2-92"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get Australia map and apply latitude restriction</span></span>
<span id="cb2-93">aus_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(</span>
<span id="cb2-94">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Australia"</span>,</span>
<span id="cb2-95">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span>,</span>
<span id="cb2-96">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span></span>
<span id="cb2-97">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-98">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-99">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clip to latitude bounds before transforming</span></span>
<span id="cb2-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(clip_polygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-101">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform to Australian coordinate system</span></span>
<span id="cb2-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7845</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Exploring the data to understand it</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># frogID_data |&gt; </span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># frog_names |&gt; </span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_unload(summarytools)</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the data to plot as an SF object</span></span>
<span id="cb3-14">plotdf_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> frogID_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-15">  </span>
<span id="cb3-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop uncertain measurements</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(coordinateUncertaintyInMeters <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-18">  </span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop out of mainland measurements</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-21">    decimalLatitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-22">      decimalLatitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-23">      decimalLongitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">112</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-24">      decimalLongitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">154</span></span>
<span id="cb3-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-27">    frog_names <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">      dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(scientificName, subfamily, tribe),</span>
<span id="cb3-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">relationship =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"many-to-many"</span></span>
<span id="cb3-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-31">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-32">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(</span>
<span id="cb3-33">    event_id, decimal_latitude, decimal_longitude,</span>
<span id="cb3-34">    subfamily, tribe</span>
<span id="cb3-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(subfamily) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(tribe)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subfamily =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct</span>(</span>
<span id="cb3-39">      subfamily,</span>
<span id="cb3-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-41">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hylid"</span>,        </span>
<span id="cb3-42">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myobatrachid"</span>, </span>
<span id="cb3-43">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Microhylidae"</span>, </span>
<span id="cb3-44">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Toad"</span>,</span>
<span id="cb3-45">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ranid"</span></span>
<span id="cb3-46">      )</span>
<span id="cb3-47">    )</span>
<span id="cb3-48">  )</span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plotdf_points |&gt; </span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   count(subfamily) |&gt; </span></span>
<span id="cb3-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   pull(subfamily)</span></span>
<span id="cb3-53"></span>
<span id="cb3-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to calculate density-based core points for each subfamily</span></span>
<span id="cb3-55">get_core_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(data, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>) {</span>
<span id="cb3-56">  data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-57">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(subfamily) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-58">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_modify</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> {</span>
<span id="cb3-59">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(.x)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keep all points if too few for hull</span></span>
<span id="cb3-60">      </span>
<span id="cb3-61">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate 2D kernel density</span></span>
<span id="cb3-62">      coords <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cbind</span>(.x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>decimal_longitude, .x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>decimal_latitude)</span>
<span id="cb3-63">      kde <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> MASS<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kde2d</span>(coords[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], coords[,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb3-64">      </span>
<span id="cb3-65">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get density at each point location</span></span>
<span id="cb3-66">      density_at_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> fields<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">interp.surface</span>(</span>
<span id="cb3-67">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">obj =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> kde<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> kde<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> kde<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>z),</span>
<span id="cb3-68">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">loc =</span> coords</span>
<span id="cb3-69">      )</span>
<span id="cb3-70">      </span>
<span id="cb3-71">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Select top proportion of points by density</span></span>
<span id="cb3-72">      n_keep <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prop)</span>
<span id="cb3-73">      density_rank <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rank</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>density_at_points, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ties.method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>)</span>
<span id="cb3-74">      core_mask <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> density_rank <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> n_keep</span>
<span id="cb3-75">      </span>
<span id="cb3-76">      .x[core_mask, ]</span>
<span id="cb3-77">    }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-78">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb3-79">}</span>
<span id="cb3-80"></span>
<span id="cb3-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plotdf_points |&gt; </span></span>
<span id="cb3-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(subfamily)</span></span>
<span id="cb3-83"></span>
<span id="cb3-84">filter_fams <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Hylid"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Myobatrachid"</span>)</span>
<span id="cb3-85"></span>
<span id="cb3-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create core points dataset (most concentrated 50%)</span></span>
<span id="cb3-87">plotdf_core1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_core_points</span>(</span>
<span id="cb3-88">  plotdf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-91">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(subfamily <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> filter_fams <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> decimal_latitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb3-92">    ), </span>
<span id="cb3-93">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb3-94">)</span>
<span id="cb3-95"></span>
<span id="cb3-96">plotdf_core2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_core_points</span>(</span>
<span id="cb3-97">  plotdf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-99">      decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-100">        decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-101">        decimal_latitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-102">        <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(subfamily <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> filter_fams)</span>
<span id="cb3-103">    ), </span>
<span id="cb3-104">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb3-105">)</span>
<span id="cb3-106"></span>
<span id="cb3-107">plotdf_core3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_core_points</span>(</span>
<span id="cb3-108">  plotdf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-109">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-110">      decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-111">        decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">130</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-112">        decimal_latitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb3-113">    ), </span>
<span id="cb3-114">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb3-115">)</span>
<span id="cb3-116"></span>
<span id="cb3-117">plotdf_core4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_core_points</span>(</span>
<span id="cb3-118">  plotdf_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-119">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-120">      decimal_longitude <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span></span>
<span id="cb3-121">    ), </span>
<span id="cb3-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb3-123">)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">mypal <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fishualize::Balistapus_undulatus"</span>)</span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define a custom geom_mark_hull function</span></span>
<span id="cb4-4">geom_frog_hull <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dataframe =</span> plotdf_core1, ...) {</span>
<span id="cb4-5">  ggforce<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_mark_hull</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataframe,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> decimal_longitude,</span>
<span id="cb4-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> decimal_latitude,</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> subfamily,</span>
<span id="cb4-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> subfamily,</span>
<span id="cb4-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> subfamily</span>
<span id="cb4-13">    ),</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">concavity =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.fontsize =</span> bts,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plain"</span>,</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>),</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.colour =</span> text_hil,</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.buffer =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">con.size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">con.cap =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-26">    ...</span>
<span id="cb4-27">  )</span>
<span id="cb4-28">}</span>
<span id="cb4-29"></span>
<span id="cb4-30">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">  </span>
<span id="cb4-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Map of Australia</span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> aus_map,</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey90"</span>,</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>  </span>
<span id="cb4-40">  </span>
<span id="cb4-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf_points,</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> decimal_longitude,</span>
<span id="cb4-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> decimal_latitude,</span>
<span id="cb4-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> subfamily</span>
<span id="cb4-47">    ),</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> ggforce<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_jitternormal</span>(</span>
<span id="cb4-51">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-52">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd_y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb4-53">    ),</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-56">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-57">  </span>
<span id="cb4-58">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Drawing the Convex Hulls</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_frog_hull</span>(plotdf_core1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_frog_hull</span>(plotdf_core2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_frog_hull</span>(plotdf_core3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_frog_hull</span>(plotdf_core4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-63">  </span>
<span id="cb4-64">  </span>
<span id="cb4-65">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scales and Coordinates</span></span>
<span id="cb4-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> mypal</span>
<span id="cb4-68">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> mypal</span>
<span id="cb4-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, </span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb4-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7845</span>,</span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb4-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb4-89">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">override.aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-90">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,</span>
<span id="cb4-91">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-92">      )</span>
<span id="cb4-93">    )</span>
<span id="cb4-94">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-95">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-98">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-100">    </span>
<span id="cb4-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inside"</span>,</span>
<span id="cb4-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position.inside =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>),</span>
<span id="cb4-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.direction =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"horizontal"</span>,</span>
<span id="cb4-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-110">    ),</span>
<span id="cb4-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-114">    ),</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-117">    </span>
<span id="cb4-118">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-123">    ),</span>
<span id="cb4-124">    </span>
<span id="cb4-125">    </span>
<span id="cb4-126">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-127">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-135">      ),</span>
<span id="cb4-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.3</span>,</span>
<span id="cb4-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb4-146">      ),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-154">    ),</span>
<span id="cb4-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-158">  )</span>
<span id="cb4-159"></span>
<span id="cb4-160"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-161">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-162">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-163">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_australian_frogs.png"</span></span>
<span id="cb4-164">  ),</span>
<span id="cb4-165">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-166">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-167">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-168">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-169">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-170">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_australian_frogs.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_australian_frogs.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-3">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-5">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-6">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-7">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-10">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-11">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="sfouteqqbv" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#sfouteqqbv table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sfouteqqbv thead, #sfouteqqbv tbody, #sfouteqqbv tfoot, #sfouteqqbv tr, #sfouteqqbv td, #sfouteqqbv th {
  border-style: none;
}

#sfouteqqbv p {
  margin: 0;
  padding: 0;
}

#sfouteqqbv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sfouteqqbv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sfouteqqbv .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sfouteqqbv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sfouteqqbv .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfouteqqbv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfouteqqbv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sfouteqqbv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sfouteqqbv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sfouteqqbv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sfouteqqbv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sfouteqqbv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sfouteqqbv .gt_spanner_row {
  border-bottom-style: hidden;
}

#sfouteqqbv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sfouteqqbv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sfouteqqbv .gt_from_md > :first-child {
  margin-top: 0;
}

#sfouteqqbv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sfouteqqbv .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sfouteqqbv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#sfouteqqbv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sfouteqqbv .gt_row_group_first td {
  border-top-width: 2px;
}

#sfouteqqbv .gt_row_group_first th {
  border-top-width: 2px;
}

#sfouteqqbv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfouteqqbv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sfouteqqbv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sfouteqqbv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfouteqqbv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfouteqqbv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sfouteqqbv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sfouteqqbv .gt_striped {
  background-color: #FAFAFA;
}

#sfouteqqbv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sfouteqqbv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfouteqqbv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfouteqqbv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sfouteqqbv .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sfouteqqbv .gt_left {
  text-align: left;
}

#sfouteqqbv .gt_center {
  text-align: center;
}

#sfouteqqbv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sfouteqqbv .gt_font_normal {
  font-weight: normal;
}

#sfouteqqbv .gt_font_bold {
  font-weight: bold;
}

#sfouteqqbv .gt_font_italic {
  font-style: italic;
}

#sfouteqqbv .gt_super {
  font-size: 65%;
}

#sfouteqqbv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sfouteqqbv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sfouteqqbv .gt_indent_1 {
  text-indent: 5px;
}

#sfouteqqbv .gt_indent_2 {
  text-indent: 10px;
}

#sfouteqqbv .gt_indent_3 {
  text-indent: 15px;
}

#sfouteqqbv .gt_indent_4 {
  text-indent: 20px;
}

#sfouteqqbv .gt_indent_5 {
  text-indent: 25px;
}

#sfouteqqbv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sfouteqqbv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="sfouteqqbv" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="sfouteqqbv">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","KernSmooth","MASS","R6","RColorBrewer","Rcpp","bit","bit64","class","classInt","cli","colorspace","crayon","curl","dichromat","digest","dotCall64","dplyr","e1071","evaluate","farver","fastmap","fields","fontawesome","forcats","generics","ggforce","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","maps","pacman","paletteer","patchwork","pillar","pkgconfig","polyclip","proxy","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","sf","showtext","showtextdb","snakecase","spam","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tweenr","tzdb","units","vctrs","viridisLite","vroom","withr","xfun","xml2","yaml"],"Version":["1.2.3","2.23-26","7.3-65","2.6.1","1.1-3","1.0.14","4.6.0","4.6.0-1","7.3-23","0.4-11","3.6.4","2.1-1","1.5.3","6.2.2","2.0-0.1","0.6.37","1.2","1.1.4","1.7-16","1.0.3","2.1.2","1.2.0","16.3.1","0.5.3","1.0.0","0.1.3","0.4.2","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","3.4.2.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.10-7","0.4-27","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.4.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","2.11-1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","2.0.3","0.5.0","0.8-7","0.6.5","0.4.2","1.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2025-01-01","2025-02-28","2025-02-15","2022-04-03","2025-01-12","2025-03-06","2025-01-16","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2024-06-20","2025-03-24","2022-05-02","2024-08-19","2024-10-04","2023-11-17","2024-09-16","2025-01-10","2024-05-13","2024-05-15","2025-03-08","2024-11-16","2023-01-29","2022-07-05","2024-02-19","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-11-10","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2024-07-23","2022-06-09","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2025-04-24","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-01-20","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2024-02-26","2025-03-15","2025-03-11","2023-12-01","2023-05-02","2023-12-05","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"sfouteqqbv","dataKey":"4fc9aa8aa108abeb3fe6bef82c2c4af1"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.frogid.net.au/explore">FrogID data</a></li>
<li><a href="https://www.frogid.net.au/">FrogID</a></li>
<li><a href="https://zookeys.pensoft.net/">ZooKeys</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://dplyr.tidyverse.org/">dplyr</a></li>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2</a></li>
<li><a href="https://r-spatial.github.io/sf/">sf</a></li>
<li><a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a></li>
<li><a href="https://www.rdocumentation.org/packages/MASS/versions/7.3-61/topics/kde2d">MASS::kde2d()</a></li>
<li><a href="https://www.rdocumentation.org/packages/fields/versions/16.3/topics/interp.surface">fields::interp.surface()</a></li>
<li><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">ggforce::geom_mark_hull()</a></li>
<li><a href="https://nschiett.github.io/fishualize/">fishualize</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Maps</category>
  <category>{ggforce}</category>
  <category>Convex Mark Hull</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_australian_frogs.html</guid>
  <pubDate>Sat, 30 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_australian_frogs.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>From Long to Short: Hit Song Evolution</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_billboard_hot_100.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>The Billboard Hot 100 Number Ones Database represents a comprehensive collection of data about every song to reach number one on the <a href="https://www.billboard.com/charts/hot-100/">Billboard Hot 100</a> between August 4, 1958 and January 11, 2025. This extensive dataset was meticulously compiled by <a href="https://bio.site/uncharted_territory">Chris Dalla Riva</a> over seven years as part of his research for the book <a href="https://bio.site/uncharted_territory"><em>Uncharted Territory: What Numbers Tell Us about the Biggest Hit Songs and Ourselves</em></a>, and continues to power his music analytics newsletter <a href="https://www.cantgetmuchhigher.com/"><em>Can’t Get Much Higher</em></a>. The database contains detailed information across 87 variables for each chart-topper, including musical characteristics sourced from <a href="https://open.spotify.com/">Spotify</a>, genre classifications from both Dalla Riva’s team and <a href="https://www.discogs.com/">Discogs</a>, songwriter and producer credits from <a href="https://www.bmi.com/">BMI/ASCAP databases</a>, demographic information about artists, lyrical content analysis, and technical details like song structure, instrumentation, and recording characteristics. This rich dataset enables researchers to explore trends in popular music across nearly seven decades, from the evolution of song length and musical keys to changing patterns in artist demographics and lyrical themes, providing unprecedented insights into the cultural and musical landscape of American popular music.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_billboard_hot_100.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This visualization maps the evolution of Billboard Hot 100 #1 hits from 1958 to 2025, with each horizontal line segment representing a chart-topping song. The x-axis shows song duration in seconds, centered at zero and extending symmetrically to show each song’s length. The y-axis displays the release year. Line segment width indicates weeks spent at #1, while colors distinguish between songs that fade out (orange) versus those with definitive endings (blue). Two curved trend lines trace the average duration boundaries over time, revealing how hit songs lengthened from the 1960s through 1990s before shortening again in recent decades, while the predominance of fade-outs has declined since 2010.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  </span>
<span id="cb1-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">  sf                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-12">)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Using R</span></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Option 2: Read directly from GitHub</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">billboard <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-26/billboard.csv'</span>)</span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># topics &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-26/topics.csv')</span></span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  Chris Dalla Riva"</span>, </span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-49">  social_caption_1, </span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">  )</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-54">   xtwitter_username, social_caption_1, </span>
<span id="cb2-55">   social_caption_2)</span>
<span id="cb2-56"></span>
<span id="cb2-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-58">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shorter Songs, Cleaner Endings"</span></span>
<span id="cb2-59"></span>
<span id="cb2-60">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Billboard #1 hits grew longer from 1960-1990s then shortened again, traced by curved trend lines showing duration boundaries. Fade-outs dominated until 2010 when definitive endings took over."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># billboard |&gt; </span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     mapping = aes(</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       x = length_sec</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_histogram(</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     fill = "white",</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     colour = "grey20",</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     bins = 100</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># billboard |&gt; </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(cdr_genre)</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># billboard |&gt; </span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-20"></span>
<span id="cb3-21">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> billboard <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_x_min =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (length_sec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length_x_max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (length_sec<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-26">      artist_male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Female"</span>,</span>
<span id="cb3-27">      artist_male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Male"</span>,</span>
<span id="cb3-28">      artist_male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Both Male and Female"</span>,</span>
<span id="cb3-29">      artist_male <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Both Male and Female"</span></span>
<span id="cb3-30">    ),</span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_date</span>(date)</span>
<span id="cb3-32">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> date,</span>
<span id="cb4-6">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> date,</span>
<span id="cb4-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> length_x_min,</span>
<span id="cb4-8">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> length_x_max,</span>
<span id="cb4-9">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> weeks_at_number_one,</span>
<span id="cb4-10">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_factor</span>(fade_out)</span>
<span id="cb4-11">    ),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span></span>
<span id="cb4-19">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> length_x_min, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">orientation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(</span>
<span id="cb4-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> length_x_max, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> date, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">orientation =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">poly</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_linewidth_continuous</span>(</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">oob =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>squish,</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>),</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>)),</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-46">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_date</span>(</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1960-01-01"</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.Date</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2020-01-01"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10 years"</span>),</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date_labels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y"</span></span>
<span id="cb4-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::knicks"</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Song does</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">not fade out"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Song</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">fades out"</span>)</span>
<span id="cb4-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb4-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-59">    ),</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb4-61">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">override.aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-62">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb4-63">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-64">      )</span>
<span id="cb4-65">    )</span>
<span id="cb4-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year"</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Duration of the song (in seconds)"</span>,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Total Weeks spent as No. 1"</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Does the song fade out?"</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-80">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-81">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-82">    </span>
<span id="cb4-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-88">    ),</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-91">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-92">    ),</span>
<span id="cb4-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb4-94">    </span>
<span id="cb4-95">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-100">    ),</span>
<span id="cb4-101">    </span>
<span id="cb4-102">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes</span></span>
<span id="cb4-103">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ends =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb4-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> line_col,</span>
<span id="cb4-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-107">    ),</span>
<span id="cb4-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)),</span>
<span id="cb4-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> line_col,</span>
<span id="cb4-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-112">    ),</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-118">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>,</span>
<span id="cb4-119">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-120">    ),</span>
<span id="cb4-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-125">    ),</span>
<span id="cb4-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-129">    ),</span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb4-133">    ),</span>
<span id="cb4-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb4-137">    ),</span>
<span id="cb4-138">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-146">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-147">      ),</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts,</span>
<span id="cb4-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-156">      ),</span>
<span id="cb4-157">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-160">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-164">    ),</span>
<span id="cb4-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-168">  )</span>
<span id="cb4-169"></span>
<span id="cb4-170"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-171">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-172">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-173">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_billboard_hot_100.png"</span></span>
<span id="cb4-174">  ),</span>
<span id="cb4-175">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-176">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-177">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-178">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-179">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-180">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_billboard_hot_100.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_billboard_hot_100.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-9"></span>
<span id="cb6-10">  patchwork             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"></span>
<span id="cb6-13">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-17">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-19">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="gtdehvubkt" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#gtdehvubkt table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gtdehvubkt thead, #gtdehvubkt tbody, #gtdehvubkt tfoot, #gtdehvubkt tr, #gtdehvubkt td, #gtdehvubkt th {
  border-style: none;
}

#gtdehvubkt p {
  margin: 0;
  padding: 0;
}

#gtdehvubkt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gtdehvubkt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gtdehvubkt .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gtdehvubkt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gtdehvubkt .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gtdehvubkt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gtdehvubkt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gtdehvubkt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gtdehvubkt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gtdehvubkt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gtdehvubkt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gtdehvubkt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gtdehvubkt .gt_spanner_row {
  border-bottom-style: hidden;
}

#gtdehvubkt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gtdehvubkt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gtdehvubkt .gt_from_md > :first-child {
  margin-top: 0;
}

#gtdehvubkt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gtdehvubkt .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gtdehvubkt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gtdehvubkt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gtdehvubkt .gt_row_group_first td {
  border-top-width: 2px;
}

#gtdehvubkt .gt_row_group_first th {
  border-top-width: 2px;
}

#gtdehvubkt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gtdehvubkt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gtdehvubkt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gtdehvubkt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gtdehvubkt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gtdehvubkt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gtdehvubkt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gtdehvubkt .gt_striped {
  background-color: #FAFAFA;
}

#gtdehvubkt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gtdehvubkt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gtdehvubkt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gtdehvubkt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gtdehvubkt .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gtdehvubkt .gt_left {
  text-align: left;
}

#gtdehvubkt .gt_center {
  text-align: center;
}

#gtdehvubkt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gtdehvubkt .gt_font_normal {
  font-weight: normal;
}

#gtdehvubkt .gt_font_bold {
  font-weight: bold;
}

#gtdehvubkt .gt_font_italic {
  font-style: italic;
}

#gtdehvubkt .gt_super {
  font-size: 65%;
}

#gtdehvubkt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gtdehvubkt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gtdehvubkt .gt_indent_1 {
  text-indent: 5px;
}

#gtdehvubkt .gt_indent_2 {
  text-indent: 10px;
}

#gtdehvubkt .gt_indent_3 {
  text-indent: 15px;
}

#gtdehvubkt .gt_indent_4 {
  text-indent: 20px;
}

#gtdehvubkt .gt_indent_5 {
  text-indent: 25px;
}

#gtdehvubkt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gtdehvubkt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="gtdehvubkt" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="gtdehvubkt">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","cli","colorspace","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","3.6.4","2.1-1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-02-13","2024-07-26","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"gtdehvubkt","dataKey":"b78dc7312df85389c220fcb26b135ed8"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.billboard.com/charts/hot-100/">Billboard Hot 100</a></li>
<li><a href="https://bio.site/uncharted_territory">Chris Dalla Riva</a></li>
<li><a href="https://bio.site/uncharted_territory"><em>Uncharted Territory: What Numbers Tell Us about the Biggest Hit Songs and Ourselves</em></a></li>
<li><a href="https://www.cantgetmuchhigher.com/"><em>Can’t Get Much Higher</em></a></li>
<li><a href="https://open.spotify.com/">Spotify</a></li>
<li><a href="https://www.discogs.com/">Discogs</a></li>
<li><a href="https://www.bmi.com/">BMI/ASCAP databases</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_billboard_hot_100.html</guid>
  <pubDate>Wed, 27 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_billboard_hot_100.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>AI Adoption Across Europe</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_ai_adoption.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>The data presented in this visualization comes from <a href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Use_of_artificial_intelligence_in_enterprises">Eurostat’s 2024 EU survey on ‘ICT usage and e-commerce in enterprises’</a>, conducted by National Statistical Authorities in the first months of 2024. The survey reveals that 13.5% of enterprises in the EU with 10 or more employees used artificial intelligence (AI) technologies to conduct their business in 2024, representing a significant 5.5 percentage point growth from 8.0% in 2023. The comprehensive survey covered approximately <a href="https://ec.europa.eu/eurostat/databrowser/view/isoc_eb_ai/default/table?lang=en">157,000 of the 1.54 million enterprises</a> across the EU, with data collection focusing on enterprises with at least 10 employees and self-employed persons across multiple economic sectors including manufacturing, information and communication, professional services, and retail trade. AI technologies measured in the survey include text mining, speech recognition, natural language generation, image recognition, machine learning, robotic process automation, and autonomous decision-making systems. The original data and detailed methodology are available through <a href="https://ec.europa.eu/eurostat/databrowser/view/isoc_eb_ai/default/table?lang=en">Eurostat’s database</a>, with the specific Excel file containing the visualization data accessible at the <a href="https://ec.europa.eu/eurostat/statistics-explained/images/2/2b/2024_Enterprises_using_AI_data_tables_and_graphs.xlsx">European Commission’s statistics portal</a>.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_ai_adoption.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This map visualizes the percentage of enterprises with 10 or more employees using artificial intelligence technologies across European countries in 2023 and 2024. The fill colors represent AI adoption rates, ranging from light (low adoption) to dark (high adoption), with values displayed on each country. Denmark leads with 27.6% adoption in 2024, followed by Sweden (25.1%) and Belgium (24.7%), while Romania shows the lowest rate at 3.1%. All countries demonstrate growth between the two years, reflecting Europe’s accelerating digital transformation. Data source: Eurostat’s ICT usage survey.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<p>This visualization was created using R and several key packages for data processing, spatial analysis, and plotting. The data was harvested directly from <a href="https://ec.europa.eu/eurostat/statistics-explained/images/2/2b/2024_Enterprises_using_AI_data_tables_and_graphs.xlsx">Eurostat’s Excel file</a> using R’s built-in <code>download.file()</code> function and processed with the <a href="https://readxl.tidyverse.org/">readxl</a> package to extract specific sheet ranges. Data wrangling was performed using the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem, particularly <a href="https://dplyr.tidyverse.org/">dplyr</a> for data manipulation and <a href="https://tidyr.tidyverse.org/">tidyr</a> for reshaping the data from wide to long format. Country names were standardized and converted to ISO3 codes using the <a href="https://github.com/vincentarelbundock/countrycode">countrycode</a> package. The spatial component utilized the <a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a> package to obtain country geometries and the <a href="https://r-spatial.github.io/sf/">sf</a> package for spatial operations, including coordinate system transformations to EPSG:3035 for optimal European mapping. The final visualization was created using <a href="https://ggplot2.tidyverse.org/">ggplot2</a> with <code>geom_sf()</code> for mapping, <a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a> for color palettes, and enhanced typography through <a href="https://github.com/yixuan/showtext">showtext</a> with Google Fonts integration, while <a href="https://wilkelab.org/ggtext/">ggtext</a> enabled rich text formatting in plot annotations.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  eurostat,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for EUROSTAT data</span></span>
<span id="cb1-4">  rvest,                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for harvesting web data</span></span>
<span id="cb1-5">  </span>
<span id="cb1-6">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-7">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-8">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-9">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-10">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-13">  sf,                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-14">  scatterpie            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To make pie charts on top of maps</span></span>
<span id="cb1-15">)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey97"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom Colours for dots</span></span>
<span id="cb2-33">custom_dot_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom size for dots</span></span>
<span id="cb2-36">size_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-39">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-42">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-45">)</span>
<span id="cb2-46">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-47">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-48">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-49">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-50">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-51">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-52">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:**  2024 ICT Usage survey, EuroStat"</span>, </span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-55">  social_caption_1, </span>
<span id="cb2-56">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-57">  social_caption_2</span>
<span id="cb2-58">  )</span>
<span id="cb2-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-60">   xtwitter_username, social_caption_1, </span>
<span id="cb2-61">   social_caption_2)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A.I. Adoption Across Europe"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Percentage of enterprises with 10+ employees using artificial intelligence technologies in EU Member States and associated countries, showing significant growth from 2023 to 2024."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="getting-the-data-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-data-and-wrangling">Getting the data and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Source: Eurostat, Use of artificial intelligence in enterprises</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Define the URL and download the Excel file</span></span>
<span id="cb3-4">xlsx_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://ec.europa.eu/eurostat/statistics-explained/images/2/2b/2024_Enterprises_using_AI_data_tables_and_graphs.xlsx"</span></span>
<span id="cb3-5">destfile <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">basename</span>(xlsx_url))</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(xlsx_url, destfile, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">quiet =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-7"></span>
<span id="cb3-8">readxl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">excel_sheets</span>(destfile)</span>
<span id="cb3-9"></span>
<span id="cb3-10">df_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(</span>
<span id="cb3-11">  destfile,</span>
<span id="cb3-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sheet =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Figure 2"</span>,</span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B6:D42"</span>   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># header in row 6, data from row 9 onwards</span></span>
<span id="cb3-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove any empty rows if present</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_all</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), is.na)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_name =</span> x1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace</span>(</span>
<span id="cb3-22">      country_name, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">s*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(.*</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">)"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb3-23">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_squish</span>()</span>
<span id="cb3-24">  )</span>
<span id="cb3-25"></span>
<span id="cb3-26"></span>
<span id="cb3-27">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso_a3, name, geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> iso_a3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb3-32">      name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>,</span>
<span id="cb3-33">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FRA"</span>,</span>
<span id="cb3-34">      iso3</span>
<span id="cb3-35">    )</span>
<span id="cb3-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)</span>
<span id="cb3-38"></span>
<span id="cb3-39"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create bounding box in WGS84 (same CRS as world_map)</span></span>
<span id="cb3-40">bbox_polygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)</span>
<span id="cb3-44"></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crop to Europe first, then transform</span></span>
<span id="cb3-46">europe_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> world_map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(bbox_polygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform after cropping</span></span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-50">  </span>
<span id="cb3-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove margins non-Europe countries</span></span>
<span id="cb3-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-53">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(iso3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RUS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GRL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TUR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYR"</span>,</span>
<span id="cb3-54">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"JOR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IRQ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LBN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CYP"</span>,</span>
<span id="cb3-55">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-99"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ISR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GEO"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DZA"</span>,</span>
<span id="cb3-56">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TUN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LBY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>))</span>
<span id="cb3-57">  )</span>
<span id="cb3-58"></span>
<span id="cb3-59"></span>
<span id="cb3-60">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(x2023, x2024),</span>
<span id="cb3-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_period"</span>,</span>
<span id="cb3-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"value_var"</span></span>
<span id="cb3-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(time_period),</span>
<span id="cb3-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-69">      country_name,</span>
<span id="cb3-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span>,</span>
<span id="cb3-71">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span></span>
<span id="cb3-72">    )</span>
<span id="cb3-73">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(europe_map) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> europe_map,</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>,</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> value_var</span>
<span id="cb4-12">    ),</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span></span>
<span id="cb4-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(value_var, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb4-20">    ),</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span></span>
<span id="cb4-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(country_name, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb4-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> value_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb4-30">    ),</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span></span>
<span id="cb4-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(text_col, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2024</span>)),</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> time_period),</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-49">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-51">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>time_period, </span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-53">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-54">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb4-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "grDevices::Purples 3",</span></span>
<span id="cb4-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "grDevices::Oslo",</span></span>
<span id="cb4-57">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "grDevices::Purple-Yellow",</span></span>
<span id="cb4-58">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "grDevices::RdPu",</span></span>
<span id="cb4-59">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pals::ocean.tempo"</span>,</span>
<span id="cb4-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "pals::kovesi.linear_kryw_5_100_c67",</span></span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%"</span>),</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb4-64">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>,</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Adoption</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">of AI in</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">enterprises</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(%)"</span></span>
<span id="cb4-77">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-78">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-81">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-83">    </span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-89">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-90">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-91">    ),</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-96">    ),</span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb4-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col</span>
<span id="cb4-103">    ),</span>
<span id="cb4-104">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb4-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb4-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-108">    ),</span>
<span id="cb4-109">    </span>
<span id="cb4-110">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-115">    ),</span>
<span id="cb4-116">    </span>
<span id="cb4-117">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-129">      ),</span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-138">      ),</span>
<span id="cb4-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-146">    ),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-150">  )</span>
<span id="cb4-151"></span>
<span id="cb4-152"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-153">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-154">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-155">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_ai_adoption.png"</span></span>
<span id="cb4-156">  ),</span>
<span id="cb4-157">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-158">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-159">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-160">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-161">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-162">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_ai_adoption.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_ai_adoption.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  eurostat,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for EUROSTAT data</span></span>
<span id="cb6-4">  rvest,                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for harvesting web data</span></span>
<span id="cb6-5">  </span>
<span id="cb6-6">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-7">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-8">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-9">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-10">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-11"></span>
<span id="cb6-12">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-13">  sf                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb6-14">)</span>
<span id="cb6-15"></span>
<span id="cb6-16">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-20">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-21">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-25">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-29">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="bkgkgdrtsb" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#bkgkgdrtsb table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bkgkgdrtsb thead, #bkgkgdrtsb tbody, #bkgkgdrtsb tfoot, #bkgkgdrtsb tr, #bkgkgdrtsb td, #bkgkgdrtsb th {
  border-style: none;
}

#bkgkgdrtsb p {
  margin: 0;
  padding: 0;
}

#bkgkgdrtsb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bkgkgdrtsb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bkgkgdrtsb .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bkgkgdrtsb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bkgkgdrtsb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bkgkgdrtsb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bkgkgdrtsb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bkgkgdrtsb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bkgkgdrtsb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bkgkgdrtsb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bkgkgdrtsb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bkgkgdrtsb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bkgkgdrtsb .gt_spanner_row {
  border-bottom-style: hidden;
}

#bkgkgdrtsb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bkgkgdrtsb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bkgkgdrtsb .gt_from_md > :first-child {
  margin-top: 0;
}

#bkgkgdrtsb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bkgkgdrtsb .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bkgkgdrtsb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bkgkgdrtsb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bkgkgdrtsb .gt_row_group_first td {
  border-top-width: 2px;
}

#bkgkgdrtsb .gt_row_group_first th {
  border-top-width: 2px;
}

#bkgkgdrtsb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bkgkgdrtsb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bkgkgdrtsb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bkgkgdrtsb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bkgkgdrtsb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bkgkgdrtsb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bkgkgdrtsb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bkgkgdrtsb .gt_striped {
  background-color: #FAFAFA;
}

#bkgkgdrtsb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bkgkgdrtsb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bkgkgdrtsb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bkgkgdrtsb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bkgkgdrtsb .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bkgkgdrtsb .gt_left {
  text-align: left;
}

#bkgkgdrtsb .gt_center {
  text-align: center;
}

#bkgkgdrtsb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bkgkgdrtsb .gt_font_normal {
  font-weight: normal;
}

#bkgkgdrtsb .gt_font_bold {
  font-weight: bold;
}

#bkgkgdrtsb .gt_font_italic {
  font-style: italic;
}

#bkgkgdrtsb .gt_super {
  font-size: 65%;
}

#bkgkgdrtsb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bkgkgdrtsb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bkgkgdrtsb .gt_indent_1 {
  text-indent: 5px;
}

#bkgkgdrtsb .gt_indent_2 {
  text-indent: 10px;
}

#bkgkgdrtsb .gt_indent_3 {
  text-indent: 15px;
}

#bkgkgdrtsb .gt_indent_4 {
  text-indent: 20px;
}

#bkgkgdrtsb .gt_indent_5 {
  text-indent: 25px;
}

#bkgkgdrtsb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bkgkgdrtsb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="bkgkgdrtsb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="bkgkgdrtsb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","ISOweek","KernSmooth","R6","Rcpp","RefManageR","assertthat","backports","bibtex","cellranger","class","classInt","cli","colorspace","countrycode","curl","data.table","digest","dplyr","e1071","eurostat","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","here","hms","htmltools","htmlwidgets","httr","httr2","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","plyr","proxy","purrr","rappdirs","readr","readxl","regions","rematch2","rlang","rmarkdown","rprojroot","rstudioapi","rvest","scales","sessioninfo","sf","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","units","vctrs","withr","xfun","xml2","yaml"],"Version":["1.2.3","0.6-2","2.23-26","2.6.1","1.0.14","1.4.0","0.2.1","1.5.0","0.5.1","1.1.0","7.3-23","0.4-11","3.6.4","2.1-1","1.6.1","6.2.2","1.17.0","0.6.37","1.1.4","1.7-16","4.0.0","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.0.1","1.1.3","0.5.8.1","1.6.4","1.4.7","1.1.2","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.8.9","0.4-27","1.0.4","0.3.3","2.1.5","1.4.5","0.1.8","2.1.2","1.1.6","2.29","2.0.4","0.17.1","1.0.4","1.3.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.8-7","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2011-09-07","2025-01-01","2025-02-15","2025-01-12","2022-09-30","2019-03-21","2024-05-23","2023-01-26","2016-07-27","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2025-03-31","2025-03-24","2025-02-22","2024-08-19","2023-11-17","2024-09-16","2023-12-19","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2020-12-13","2023-03-21","2024-04-04","2023-12-06","2023-08-15","2025-03-26","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2023-10-02","2022-06-09","2025-02-05","2021-01-31","2024-01-10","2025-03-07","2021-06-21","2020-05-01","2025-04-11","2024-11-04","2023-11-05","2024-10-22","2024-02-12","2023-11-28","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2025-03-11","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"bkgkgdrtsb","dataKey":"f32a53492d9d9711096dcc5b60a1e63c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://ec.europa.eu/eurostat/statistics-explained/index.php?title=Use_of_artificial_intelligence_in_enterprises">Eurostat’s 2024 EU survey on ‘ICT usage and e-commerce in enterprises’</a></li>
<li><a href="https://ec.europa.eu/eurostat/databrowser/view/isoc_eb_ai/default/table?lang=en">157,000 of the 1.54 million enterprises</a></li>
<li><a href="https://ec.europa.eu/eurostat/databrowser/view/isoc_eb_ai/default/table?lang=en">Eurostat’s database</a></li>
<li><a href="https://ec.europa.eu/eurostat/statistics-explained/images/2/2b/2024_Enterprises_using_AI_data_tables_and_graphs.xlsx">European Commission’s statistics portal</a></li>
<li><a href="https://ec.europa.eu/eurostat/statistics-explained/images/2/2b/2024_Enterprises_using_AI_data_tables_and_graphs.xlsx">Eurostat’s Excel file</a></li>
<li><a href="https://readxl.tidyverse.org/">readxl</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://dplyr.tidyverse.org/">dplyr</a></li>
<li><a href="https://tidyr.tidyverse.org/">tidyr</a></li>
<li><a href="https://github.com/vincentarelbundock/countrycode">countrycode</a></li>
<li><a href="https://docs.ropensci.org/rnaturalearth/">rnaturalearth</a></li>
<li><a href="https://r-spatial.github.io/sf/">sf</a></li>
<li><a href="https://ggplot2.tidyverse.org/">ggplot2</a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
</ul>
</section>

 ]]></description>
  <category>Chloropleth</category>
  <category>Maps</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_ai_adoption.html</guid>
  <pubDate>Mon, 25 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/viz_euro_ai_adoption.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Europe’s Energy Pivot: Mapping the Gas Import Revolution</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_energy_imports.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This analysis uses natural gas import data from <a href="https://ec.europa.eu/eurostat"><strong>Eurostat</strong></a>, the official statistical office of the European Union. The dataset (<code>nrg_ti_gas</code>) contains information on natural gas trade imports measured in millions of cubic meters, broken down by importing country and partner country. The visualization compares two critical time periods: <strong>2021</strong>, representing the pre-Ukraine War baseline when European energy relationships were still largely intact, and <strong>2023</strong>, reflecting the post-invasion reality after Russia’s full-scale attack on Ukraine in February 2022. This temporal comparison reveals the dramatic shift in European energy dependency, showing how individual EU member states reduced their reliance on Russian gas imports following the conflict. The data specifically tracks the percentage share of Russian gas imports relative to total gas imports for each country, illustrating the varying degrees of energy transition and diversification efforts across Europe. Countries like Germany, which historically had high Russian gas dependency through pipelines like Nord Stream, show particularly striking changes between these two periods, while others maintained different import patterns based on their geographic location, existing infrastructure, and policy responses to the crisis.</p>
<p>The Eurostat energy statistics provide comprehensive coverage of EU member states and are considered the authoritative source for European energy trade data, making this analysis particularly valuable for understanding the geopolitical and economic impacts of the Ukraine conflict on European energy security.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_energy_imports.png" class="img-fluid figure-img" width="400">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This map visualizes the dramatic shift in European natural gas imports from Russia between 2021 (pre-war) and 2023 (post-invasion). Darker purple shades indicate higher percentages of Russian gas dependency, while lighter shades show lower reliance. The comparison reveals how the 2022 Ukraine conflict fundamentally reshaped Europe’s energy landscape, with many countries significantly reducing their Russian gas imports. Percentages displayed on each country show the exact share of total gas imports sourced from Russia.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic-1" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic-1">How I Made This Graphic (1)</h2>
<p>The first visualization was created using <strong>R</strong> and leverages several powerful packages for data manipulation, mapping, and visualization. The foundation begins with <a href="https://www.tidyverse.org/"><strong>{tidyverse}</strong></a> for data wrangling and <a href="https://ropengov.github.io/eurostat/"><strong>{eurostat}</strong></a> for directly accessing European statistical data through the <code>get_eurostat()</code> function. The mapping capabilities come from <a href="https://r-spatial.github.io/sf/"><strong>{sf}</strong></a> for spatial operations and <a href="https://docs.ropensci.org/rnaturalearth/"><strong>{rnaturalearth}</strong></a> for obtaining world map geometries. Geographic data processing involved transforming coordinate reference systems (from WGS84 to EPSG:3035 for proper European projection) and using spatial operations like <code>st_intersection()</code> to crop the world map to European boundaries. The visualization itself was built with <a href="https://ggplot2.tidyverse.org/"><strong>{ggplot2}</strong></a> using <code>geom_sf()</code> for mapping polygons and <code>geom_sf_text()</code> for country labels showing percentage values. Typography was enhanced using <a href="https://github.com/yixuan/showtext"><strong>{showtext}</strong></a> to load custom Google Fonts (Saira family), while <a href="https://wilkelab.org/ggtext/"><strong>{ggtext}</strong></a> enabled markdown formatting in plot elements. Colour palettes were applied using <a href="https://emilhvitfeldt.github.io/paletteer/"><strong>{paletteer}</strong></a> with the “grDevices::Purples” scale, and the final layout used <code>facet_wrap()</code> to create side-by-side comparison panels for 2021 and 2023. The coordinate system was set using <code>coord_sf()</code> with EPSG:3035 projection, optimized for European cartographic display, and the plot was exported using <code>ggsave()</code> with precise dimensions for high-quality output.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  eurostat,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for EUROSTAT data</span></span>
<span id="cb1-4">  rvest,                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for harvesting web data</span></span>
<span id="cb1-5">  </span>
<span id="cb1-6">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-7">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-8">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-9">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-10">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-13">  sf,                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-14">  scatterpie            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># To make pie charts on top of maps</span></span>
<span id="cb1-15">)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey40"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom Colours for dots</span></span>
<span id="cb2-33">custom_dot_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom size for dots</span></span>
<span id="cb2-36">size_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-39">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-42">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-45">)</span>
<span id="cb2-46">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-47">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-48">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-49">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-50">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-51">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-52">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:** {eurostat}"</span>, </span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-55">  social_caption_1, </span>
<span id="cb2-56">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-57">  social_caption_2</span>
<span id="cb2-58">  )</span>
<span id="cb2-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-60">   xtwitter_username, social_caption_1, </span>
<span id="cb2-61">   social_caption_2)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Europe's Energy Pivot"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian natural gas imports as percentage of total gas imports across European countries, comparing pre-war era (2021) with post-war reality (2023)"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="getting-the-data-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-data-and-wrangling">Getting the data and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Example: fetch natural gas import volumes by country and partner</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For brevity, this example uses get_eurostat (requires eurostat package) </span></span>
<span id="cb3-3">gas_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_eurostat</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nrg_ti_gas"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-4">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb3-5"></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gas_raw |&gt; </span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(geo)</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># gas_raw |&gt; </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(time_period) |&gt; </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   arrange(desc(time_period))</span></span>
<span id="cb3-12"></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute total and Russian share by country and year</span></span>
<span id="cb3-14">gas_by_country <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gas_raw  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-16">    unit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MIO_M3"</span>,</span>
<span id="cb3-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   (geo %in% c("AT","DE","FR","IT","PL","ES","SE",</span></span>
<span id="cb3-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#               "BG","HU","SK","CZ","RO","SI","RS")</span></span>
<span id="cb3-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#    ),</span></span>
<span id="cb3-20">    time_period <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>)</span>
<span id="cb3-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(geo, time_period)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">total_import =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(values, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">russia_import =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(values[partner <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RU"</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm=</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-26">  )  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">share_russia =</span> russia_import <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> total_import) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert geo (iso2) to ISO3</span></span>
<span id="cb3-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-32">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geo =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>codelist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iso2c, </span>
<span id="cb3-33">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>codelist<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>iso3c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(geo), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(iso3)</span>
<span id="cb3-34">    )</span>
<span id="cb3-35">  )</span>
<span id="cb3-36"></span>
<span id="cb3-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearth)</span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get world map in WGS84 first</span></span>
<span id="cb3-39">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso_a3, name, geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> iso_a3) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(</span>
<span id="cb3-44">      name <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"France"</span>,</span>
<span id="cb3-45">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FRA"</span>,</span>
<span id="cb3-46">      iso3</span>
<span id="cb3-47">    )</span>
<span id="cb3-48">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)</span>
<span id="cb3-50"></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create bounding box in WGS84 (same CRS as world_map)</span></span>
<span id="cb3-52">bbox_polygon <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_bbox</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sfc</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_set_crs</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>)</span>
<span id="cb3-56"></span>
<span id="cb3-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Testing to see Europe and World Map</span></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># world_map |&gt; </span></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot() +</span></span>
<span id="cb3-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_sf() +</span></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_sf(</span></span>
<span id="cb3-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     data = bbox_polygon,</span></span>
<span id="cb3-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     fill = "red"</span></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   coord_sf(</span></span>
<span id="cb3-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     ylim = c(-80, 80),</span></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     default_crs = "EPSG:4326"</span></span>
<span id="cb3-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span>
<span id="cb3-69"></span>
<span id="cb3-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crop to Europe first, then transform</span></span>
<span id="cb3-71">europe_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> world_map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_intersection</span>(bbox_polygon) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-73">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform after cropping</span></span>
<span id="cb3-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-75">  </span>
<span id="cb3-76">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove margins non-Europe countries</span></span>
<span id="cb3-77">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-78">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(iso3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RUS"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GRL"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TUR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SYR"</span>,</span>
<span id="cb3-79">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"JOR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IRQ"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LBN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CYP"</span>,</span>
<span id="cb3-80">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-99"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ISR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"GEO"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DZA"</span>,</span>
<span id="cb3-81">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"TUN"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LBY"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAR"</span>))</span>
<span id="cb3-82">  )</span>
<span id="cb3-83"></span>
<span id="cb3-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># europe_map |&gt; </span></span>
<span id="cb3-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot() +</span></span>
<span id="cb3-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_sf() +</span></span>
<span id="cb3-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_sf_text(aes(label = iso3))</span></span>
<span id="cb3-88"></span>
<span id="cb3-89">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> gas_by_country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(europe_map) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-91">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-92">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.nan</span>(share_russia))</span>
<span id="cb3-93"></span>
<span id="cb3-94"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(gas_raw, world_map, bbox_polygon)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> europe_map,</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-11">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> share_russia</span>
<span id="cb4-12">    )</span>
<span id="cb4-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(share_russia <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" %"</span>),</span>
<span id="cb4-17">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> share_russia <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span></span>
<span id="cb4-18">    ),</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb4-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(text_col, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb4-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>)),</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> time_period),</span>
<span id="cb4-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-37">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>time_period, </span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb4-41">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::BuPu"</span>,</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>()</span>
<span id="cb4-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>,</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-51">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian Gas</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Share of</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Total Imports</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(%)"</span></span>
<span id="cb4-57">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-58">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-63">    </span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-69">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-70">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-71">    ),</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-73">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-74">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-75">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-76">    ),</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">7.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-80">    </span>
<span id="cb4-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-86">    ),</span>
<span id="cb4-87">    </span>
<span id="cb4-88">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-99">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-100">      ),</span>
<span id="cb4-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-109">      ),</span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-115">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-117">    ),</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-121">  )</span>
<span id="cb4-122"></span>
<span id="cb4-123"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-124">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-125">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-126">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_energy_imports.png"</span></span>
<span id="cb4-127">  ),</span>
<span id="cb4-128">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-129">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-130">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-131">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-132">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-133">)</span></code></pre></div>
</details>
</div>
</section>
<section id="a-scatterpie-plot-of-the-same-chloropleth-to-represent-volumes" class="level3">
<h3 class="anchored" data-anchor-id="a-scatterpie-plot-of-the-same-chloropleth-to-represent-volumes">A scatterpie plot of the same Chloropleth (to represent volumes)</h3>
<p>This enhanced visualization combines choropleth mapping with scatter pie charts to show both the proportion and absolute volume of European natural gas imports. The technical foundation remained similar to the first version, using R with {tidyverse}, {eurostat}, and {sf} for data manipulation and spatial operations. However, this iteration introduced the {scatterpie} package as the key innovation, allowing pie charts to be overlaid on the map at each country’s centroid. The process involved several critical steps: first, extracting country centroids using <code>st_centroid()</code> and <code>st_coordinates()</code> to position the pie charts accurately; second, calculating a scaling factor to make pie chart sizes proportional to total import volumes using <code>sqrt(total_import) * scale_factor</code>; and third, restructuring the data to separate Russian imports from other sources for the pie chart segments. The {ggnewscale} package enabled multiple fill scales—one for the choropleth background showing Russian gas share percentages, and another for the pie chart colors distinguishing Russian imports (red) from other sources (grey). Custom legend positioning was achieved using <code>geom_scatterpie_legend()</code> with precise coordinate placement, while strip labels for the years were manually positioned using a separate data frame. The dual encoding approach—choropleth for proportions and scatter pies for volumes—creates a rich, layered visualization that reveals both the dependency patterns and the scale of energy trade across European countries before and after the Ukraine conflict.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">scale_factor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb5-2"></span>
<span id="cb5-3">plotdf2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rest_import =</span> total_import <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> russia_import) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso3, time_period, russia_import, rest_import, total_import) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(</span>
<span id="cb5-8">    plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-10">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># st_transform("EPSG:4326") |&gt; </span></span>
<span id="cb5-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-12">      janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb5-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-14">  </span>
<span id="cb5-15">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scale the radius for better visualization</span></span>
<span id="cb5-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust scaling factor as needed</span></span>
<span id="cb5-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(total_import) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>total_import)</span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a simple data frame: for Strip Labels i.e. years</span></span>
<span id="cb5-21">strip_labels_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb5-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_period =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2023</span>),</span>
<span id="cb5-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lon =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>),</span>
<span id="cb5-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb5-25">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(</span>
<span id="cb5-27">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lon"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lat"</span>),</span>
<span id="cb5-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span></span>
<span id="cb5-29">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>)</span>
<span id="cb5-31"></span>
<span id="cb5-32">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> europe_map,</span>
<span id="cb5-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>,</span>
<span id="cb5-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb5-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb5-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb5-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> share_russia</span>
<span id="cb5-43">    )</span>
<span id="cb5-44">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-45">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_paletteer_c</span>(</span>
<span id="cb5-46">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grDevices::BuPu"</span>,</span>
<span id="cb5-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_percent</span>(),</span>
<span id="cb5-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Russian Gas</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Share of</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Total Imports</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(%)"</span></span>
<span id="cb5-50">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-51">  ggnewscale<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new_scale_fill</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">  </span>
<span id="cb5-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_scatterpie</span>(</span>
<span id="cb5-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf2,</span>
<span id="cb5-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y,</span>
<span id="cb5-57">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use scaled radius</span></span>
<span id="cb5-58">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> radius,</span>
<span id="cb5-59">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> time_period</span>
<span id="cb5-60">    ),</span>
<span id="cb5-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"russia_import"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rest_import"</span>),  </span>
<span id="cb5-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb5-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span></span>
<span id="cb5-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_scatterpie_legend</span>(</span>
<span id="cb5-67">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert your desired breaks (in billions m³) to the scaled radius values</span></span>
<span id="cb5-68">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert B to M, then apply your scaling</span></span>
<span id="cb5-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor,  </span>
<span id="cb5-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1672194</span>,</span>
<span id="cb5-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3072552</span>,</span>
<span id="cb5-72">    </span>
<span id="cb5-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,  </span>
<span id="cb5-74">    </span>
<span id="cb5-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb5-76">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert back from scaled radius to billions m³</span></span>
<span id="cb5-77">      original_value <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> scale_factor)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb5-78">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(original_value, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" B m³"</span>)</span>
<span id="cb5-79">    },</span>
<span id="cb5-80">    </span>
<span id="cb5-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,  </span>
<span id="cb5-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb5-83">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb5-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-85">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf_text</span>(</span>
<span id="cb5-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> strip_labels_df,</span>
<span id="cb5-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> time_period),</span>
<span id="cb5-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb5-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb5-94">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb5-96">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>time_period, </span>
<span id="cb5-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-98">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb5-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BB5566FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>),</span>
<span id="cb5-101">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Imports from</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Russia"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Imports"</span>),</span>
<span id="cb5-102">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb5-103">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb5-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>,</span>
<span id="cb5-107">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3035"</span>,</span>
<span id="cb5-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb5-109">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb5-110">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb5-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption</span>
<span id="cb5-115">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-116">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb5-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb5-119">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-121">    </span>
<span id="cb5-122">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>,</span>
<span id="cb5-123">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.justification =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb5-124">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-125">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb5-129">    ),</span>
<span id="cb5-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.spacing =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb5-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb5-135">    ),</span>
<span id="cb5-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"top"</span>,</span>
<span id="cb5-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.width =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.key.height =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-139">    </span>
<span id="cb5-140">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb5-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb5-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-145">    ),</span>
<span id="cb5-146">    </span>
<span id="cb5-147">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb5-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-153">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-154">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-155">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-156">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb5-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb5-159">      ),</span>
<span id="cb5-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb5-161">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb5-165">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-166">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb5-167">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb5-168">      ),</span>
<span id="cb5-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb5-170">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb5-171">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb5-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb5-174">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb5-175">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb5-176">    ),</span>
<span id="cb5-177">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-178">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb5-179">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb5-180">  )</span>
<span id="cb5-181"></span>
<span id="cb5-182"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb5-183">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-184">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb5-185">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_energy_imports_2.png"</span></span>
<span id="cb5-186">  ),</span>
<span id="cb5-187">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb5-188">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb5-189">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb5-190">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb5-191">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb5-192">)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_energy_imports_2.png" class="img-fluid figure-img"></p>
<figcaption>This map reveals Europe’s dramatic energy transition between 2021 and 2023, combining two visual layers to tell the complete story. The choropleth (background colors) shows Russian gas dependency as a percentage of total imports, with darker purple indicating higher reliance. The overlaid pie charts represent absolute import volumes—larger circles mean more total gas imports, with red segments showing Russian sources and grey representing other suppliers. This dual visualization reveals both the scale of energy trade and the proportion of Russian dependency, illustrating how countries like Germany dramatically reduced both their reliance on and absolute volumes of Russian gas following the Ukraine invasion.</figcaption>
</figure>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb6-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb6-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_energy_imports_2.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb6-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb6-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb6-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb6-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"viz_euro_energy_imports.png"</span></span>
<span id="cb6-14">    )</span>
<span id="cb6-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb7-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb7-3">  eurostat,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for EUROSTAT data</span></span>
<span id="cb7-4">  rvest,                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Package for harvesting web data</span></span>
<span id="cb7-5">  </span>
<span id="cb7-6">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb7-7">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb7-8">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb7-9">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb7-10">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb7-11"></span>
<span id="cb7-12">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb7-13">  sf                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb7-14">)</span>
<span id="cb7-15"></span>
<span id="cb7-16">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb7-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb7-20">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-21">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-22">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb7-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb7-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-25">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-26">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb7-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb7-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-29">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="gzuyznhvvb" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#gzuyznhvvb table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gzuyznhvvb thead, #gzuyznhvvb tbody, #gzuyznhvvb tfoot, #gzuyznhvvb tr, #gzuyznhvvb td, #gzuyznhvvb th {
  border-style: none;
}

#gzuyznhvvb p {
  margin: 0;
  padding: 0;
}

#gzuyznhvvb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gzuyznhvvb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gzuyznhvvb .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gzuyznhvvb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gzuyznhvvb .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gzuyznhvvb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzuyznhvvb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gzuyznhvvb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gzuyznhvvb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gzuyznhvvb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gzuyznhvvb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gzuyznhvvb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gzuyznhvvb .gt_spanner_row {
  border-bottom-style: hidden;
}

#gzuyznhvvb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gzuyznhvvb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gzuyznhvvb .gt_from_md > :first-child {
  margin-top: 0;
}

#gzuyznhvvb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gzuyznhvvb .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gzuyznhvvb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gzuyznhvvb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gzuyznhvvb .gt_row_group_first td {
  border-top-width: 2px;
}

#gzuyznhvvb .gt_row_group_first th {
  border-top-width: 2px;
}

#gzuyznhvvb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzuyznhvvb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gzuyznhvvb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gzuyznhvvb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzuyznhvvb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzuyznhvvb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gzuyznhvvb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gzuyznhvvb .gt_striped {
  background-color: #FAFAFA;
}

#gzuyznhvvb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gzuyznhvvb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gzuyznhvvb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzuyznhvvb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gzuyznhvvb .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gzuyznhvvb .gt_left {
  text-align: left;
}

#gzuyznhvvb .gt_center {
  text-align: center;
}

#gzuyznhvvb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gzuyznhvvb .gt_font_normal {
  font-weight: normal;
}

#gzuyznhvvb .gt_font_bold {
  font-weight: bold;
}

#gzuyznhvvb .gt_font_italic {
  font-style: italic;
}

#gzuyznhvvb .gt_super {
  font-size: 65%;
}

#gzuyznhvvb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gzuyznhvvb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gzuyznhvvb .gt_indent_1 {
  text-indent: 5px;
}

#gzuyznhvvb .gt_indent_2 {
  text-indent: 10px;
}

#gzuyznhvvb .gt_indent_3 {
  text-indent: 15px;
}

#gzuyznhvvb .gt_indent_4 {
  text-indent: 20px;
}

#gzuyznhvvb .gt_indent_5 {
  text-indent: 25px;
}

#gzuyznhvvb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gzuyznhvvb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="gzuyznhvvb" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="gzuyznhvvb">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["DBI","ISOweek","KernSmooth","R6","Rcpp","RefManageR","assertthat","backports","bibtex","cellranger","class","classInt","cli","colorspace","countrycode","curl","data.table","digest","dplyr","e1071","eurostat","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","here","hms","htmltools","htmlwidgets","httr","httr2","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","plyr","proxy","purrr","rappdirs","readr","readxl","regions","rematch2","rlang","rmarkdown","rprojroot","rstudioapi","rvest","scales","sessioninfo","sf","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","units","vctrs","withr","xfun","xml2","yaml"],"Version":["1.2.3","0.6-2","2.23-26","2.6.1","1.0.14","1.4.0","0.2.1","1.5.0","0.5.1","1.1.0","7.3-23","0.4-11","3.6.4","2.1-1","1.6.1","6.2.2","1.17.0","0.6.37","1.1.4","1.7-16","4.0.0","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.0.1","1.1.3","0.5.8.1","1.6.4","1.4.7","1.1.2","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.8.9","0.4-27","1.0.4","0.3.3","2.1.5","1.4.5","0.1.8","2.1.2","1.1.6","2.29","2.0.4","0.17.1","1.0.4","1.3.0","1.2.3","1.0-20","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.8-7","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2024-06-02","2011-09-07","2025-01-01","2025-02-15","2025-01-12","2022-09-30","2019-03-21","2024-05-23","2023-01-26","2016-07-27","2025-01-01","2025-01-08","2025-02-13","2024-07-26","2025-03-31","2025-03-24","2025-02-22","2024-08-19","2023-11-17","2024-09-16","2023-12-19","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2020-12-13","2023-03-21","2024-04-04","2023-12-06","2023-08-15","2025-03-26","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2023-10-02","2022-06-09","2025-02-05","2021-01-31","2024-01-10","2025-03-07","2021-06-21","2020-05-01","2025-04-11","2024-11-04","2023-11-05","2024-10-22","2024-02-12","2023-11-28","2025-02-05","2025-03-24","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2025-03-11","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"gzuyznhvvb","dataKey":"f32a53492d9d9711096dcc5b60a1e63c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://ec.europa.eu/eurostat"><strong>Eurostat</strong></a></li>
<li><a href="https://www.tidyverse.org/"><strong>{tidyverse}</strong></a></li>
<li><a href="https://ropengov.github.io/eurostat/"><strong>{eurostat}</strong></a></li>
<li><a href="https://r-spatial.github.io/sf/"><strong>{sf}</strong></a></li>
<li><a href="https://docs.ropensci.org/rnaturalearth/"><strong>{rnaturalearth}</strong></a></li>
<li><a href="https://ggplot2.tidyverse.org/"><strong>{ggplot2}</strong></a></li>
<li><a href="https://github.com/yixuan/showtext"><strong>{showtext}</strong></a></li>
<li><a href="https://wilkelab.org/ggtext/"><strong>{ggtext}</strong></a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/"><strong>{paletteer}</strong></a></li>
</ul>
</section>

 ]]></description>
  <category>Chloropleth</category>
  <category>Maps</category>
  <category>{scatterpie}</category>
  <category>Pie Chart</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/viz_euro_energy_imports.html</guid>
  <pubDate>Sun, 24 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/viz_euro_energy_imports.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Mapping Global Climate Attribution Studies</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_extreme_weather_studies.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset explores extreme weather attribution studies, sourced from <a href="https://carbonbrief.org/">Carbon Brief</a>’s comprehensive article <a href="https://interactive.carbonbrief.org/attribution-studies/index.html">Mapped: How climate change affects extreme weather around the world</a>. Last updated in November 2024, the data includes individual entries for attribution studies that calculate whether and by how much climate change affected the intensity, frequency, or impact of extreme weather events—ranging from wildfires in the US and drought in South Africa to record-breaking rainfall in Pakistan and typhoons in Taiwan. The dataset covers studies published over multiple years, including both traditional attribution studies and rapid attribution studies (analyses completed within days of an event occurring). Each entry contains detailed information about the event studied, geographic location using <a href="https://www.iso.org/iso-3166-country-codes.html">ISO country codes</a>, event classification based on climate change influence, publication details, and whether the study represents a rapid response analysis. For those interested in the evolution of this scientific field, Carbon Brief also provides an <a href="https://carbonbrief.org/qa-the-evolving-science-of-extreme-weather-attribution/">in-depth Q&amp;A article</a> exploring the development of extreme weather attribution science. The dataset was curated by <a href="https://github.com/rajodm">Rajo</a> for the <a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a> weekly data project, making it an excellent resource for exploring questions about how attribution studies have evolved over time, which types of extreme events are most commonly studied, regional focus patterns, and trends in climate change influence across different weather phenomena.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_extreme_weather_studies.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This world map visualizes extreme weather attribution studies by country using proportional pie charts from Carbon Brief’s database. Each pie chart is positioned at a country’s geographic center, with slice sizes representing the proportion of studies finding climate change made events more severe/likely, had no discernible human influence, provided insufficient data, or made events less severe/likely. Pie chart sizes correspond to the total number of attribution studies conducted per country. The visualization reveals the global scientific consensus that climate change is predominantly making extreme weather events more dangerous worldwide.
</figcaption>
</figure>
</div>
<section id="how-i-made-this-graphic" class="level2">
<h2 class="anchored" data-anchor-id="how-i-made-this-graphic">How I Made This Graphic</h2>
<p>This world map visualization was created using R’s powerful geospatial and data visualization ecosystem. The foundation began with data wrangling using the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> suite, where I filtered the attribution studies data to focus on event-specific studies and parsed country codes using <a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html"><code>separate_longer_delim()</code></a> to handle multi-country studies. The base world map was generated using <a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html"><code>rnaturalearth::ne_countries()</code></a> and processed with the <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> package for spatial operations, including coordinate transformation and centroid calculation to position pie charts at each country’s geographic center. The key visualization technique employed the <a href="https://github.com/GuangchuangYu/scatterpie"><code>scatterpie</code></a> package, specifically <a href="https://guangchuangyu.github.io/scatterpie/reference/geom_scatterpie.html"><code>geom_scatterpie()</code></a>, which creates proportional pie charts where each slice represents the classification of extreme weather events (more severe/likely, no discernible influence, insufficient data, or less severe/likely). Typography was enhanced using <a href="https://github.com/yixuan/showtext"><code>showtext</code></a> with Google Fonts integration via <a href="https://cran.r-project.org/web/packages/showtext/showtext.pdf"><code>font_add_google()</code></a>, while <a href="https://wilkelab.org/ggtext/"><code>ggtext</code></a> enabled markdown formatting in plot elements. The spatial coordinate system was managed through <a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>coord_sf()</code></a> with EPSG:4326 projection, and custom legends were positioned using <a href="https://guangchuangyu.github.io/scatterpie/reference/geom_scatterpie_legend.html"><code>geom_scatterpie_legend()</code></a>. Color palettes were sourced from <a href="https://emilhvitfeldt.github.io/paletteer/"><code>paletteer</code></a>, and the final composition used <a href="https://jrnold.github.io/ggthemes/reference/theme_map.html"><code>ggthemes::theme_map()</code></a> for a clean cartographic aesthetic. The resulting visualization effectively demonstrates that across most countries with recorded extreme weather attribution studies, the majority of events are classified as “more severe or more likely to occur” due to climate change, represented by the dominant color in most pie charts globally.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  </span>
<span id="cb1-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">  sf                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Spatial Operations</span></span>
<span id="cb1-12">)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Option 2: Read data directly from GitHub</span></span>
<span id="cb1-15"></span>
<span id="cb1-16">attribution_studies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-12/attribution_studies.csv'</span>)</span>
<span id="cb1-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># attribution_studies_raw &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-12/attribution_studies_raw.csv')</span></span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom Colours for dots</span></span>
<span id="cb2-33">custom_dot_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom size for dots</span></span>
<span id="cb2-36">size_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-39">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-42">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-45">)</span>
<span id="cb2-46">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-47">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-48">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-49">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-50">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-51">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-52">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:** Carbon Brief"</span>, </span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-55">  social_caption_1, </span>
<span id="cb2-56">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-57">  social_caption_2</span>
<span id="cb2-58">  )</span>
<span id="cb2-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-60">   xtwitter_username, social_caption_1, </span>
<span id="cb2-61">   social_caption_2)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The Attribution Map: Climate Change and Weather Extremes"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This world map displays pie charts for each country showing the classification of extreme weather attribution studies from&lt;br&gt;Carbon Brief's database. Each pie represents the proportion of studies finding climate change made events &lt;span style='color:#BD5630FF'&gt;**more severe/likely**&lt;/span&gt;, had&lt;br&gt;&lt;span style='color:#6D8325FF'&gt;**no discernible influence**&lt;/span&gt;, provided &lt;span style='color:grey'&gt;**insufficient data**&lt;/span&gt;, or made events &lt;span style='color:#6D8325FF'&gt;**less severe/likely**&lt;/span&gt;. The size of each pie reflects&lt;br&gt;the total number of attribution studies conducted. Globally, the dominant &lt;span style='color:#BD5630FF'&gt;**red segments**&lt;/span&gt; reveal that most extreme weather&lt;br&gt;events are becoming more severe due to climate change."</span></span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base world map to plot</span></span>
<span id="cb3-4">world_map <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rnaturalearth<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"large"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso_a3, geometry) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3c =</span> iso_a3)</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get data on classification and year by countries to try to make a pie chart</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for each country on top of a world map</span></span>
<span id="cb3-10">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> attribution_studies <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">event_year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(event_year)</span>
<span id="cb3-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#filter(event_year &gt; 1900) |&gt; </span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(study_focus <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Event"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(iso_country_code)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(event_year, iso_country_code, classification) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3c =</span> iso_country_code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate_longer_delim</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> iso3c, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(iso3c, classification)</span>
<span id="cb3-21">  </span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Make data in format that {scatterpie} understands</span></span>
<span id="cb3-23">df_scatterpie <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb3-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> iso3c,</span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> classification,</span>
<span id="cb3-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> n</span>
<span id="cb3-28">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">everything</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replace_na</span>(.x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-31">    df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-32">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(iso3c) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-33">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(n))</span>
<span id="cb3-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add centroids of each country</span></span>
<span id="cb3-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-37">    world_map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-38">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:3857"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-39">      sf<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_centroid</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-40">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-41">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_coordinates</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-42">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-43">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(world_map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(iso3c)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-44">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">longitude =</span> X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">latitude =</span> Y)</span>
<span id="cb3-45">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">iso3c_label =</span> countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(</span>
<span id="cb3-48">      iso3c, </span>
<span id="cb3-49">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">origin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span>, </span>
<span id="cb3-50">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destination =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"country.name.en"</span></span>
<span id="cb3-51">    )</span>
<span id="cb3-52">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(radius_var))</span>
<span id="cb3-54"></span>
<span id="cb3-55">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(scatterpie)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">scale_factor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-2"></span>
<span id="cb4-3">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> world_map <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(iso3c <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ATA"</span>),</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey90"</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> bg_col,</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-11">  </span>
<span id="cb4-12">  scatterpie<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_scatterpie</span>(</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_scatterpie,</span>
<span id="cb4-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-15">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> longitude, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> latitude, </span>
<span id="cb4-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> iso3c, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(radius_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor</span>
<span id="cb4-17">    ),</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(df_scatterpie)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>], </span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> bg_col, </span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb4-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  </span>
<span id="cb4-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add country labels (iso3c)</span></span>
<span id="cb4-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_scatterpie,</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> longitude, </span>
<span id="cb4-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> latitude, </span>
<span id="cb4-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(iso3c_label, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>),</span>
<span id="cb4-31">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(radius_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor</span>
<span id="cb4-32">    ),</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.4</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position above pie chart</span></span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-40">  </span>
<span id="cb4-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add numeric value labels</span></span>
<span id="cb4-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_scatterpie,</span>
<span id="cb4-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-45">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> longitude, </span>
<span id="cb4-46">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> latitude, </span>
<span id="cb4-47">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> radius_var,</span>
<span id="cb4-48">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(radius_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor</span>
<span id="cb4-49">    ),</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>, </span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">check_overlap =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb4-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_size_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, bts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-57">  </span>
<span id="cb4-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span></span>
<span id="cb4-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  </span>
<span id="cb4-63">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom legend with specific breaks</span></span>
<span id="cb4-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_scatterpie_legend</span>(</span>
<span id="cb4-65">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> scale_factor,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Transform the desired break points</span></span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">160</span>, </span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55</span>,</span>
<span id="cb4-68">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Four legend circles for our breaks</span></span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"10"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"50"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"90"</span>),</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-73">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>,</span>
<span id="cb4-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">160</span>, </span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of studies"</span>,</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb4-83">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#6D8325FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#7FC7AFFF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BD5630FF"</span> )</span>
<span id="cb4-86">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption</span>
<span id="cb4-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb4-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb4-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-98">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">override.aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-99">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>,</span>
<span id="cb4-100">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-101">      )</span>
<span id="cb4-102">    )</span>
<span id="cb4-103">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-104">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-107">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-108">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-109">    </span>
<span id="cb4-110">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb4-111">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-115">    ),</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-117">    </span>
<span id="cb4-118">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-119">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-120">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-123">    ),</span>
<span id="cb4-124">    </span>
<span id="cb4-125">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-129">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-134">      ),</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-145">      ),</span>
<span id="cb4-146">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-151">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-152">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-153">    ),</span>
<span id="cb4-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-157">  )</span>
<span id="cb4-158"></span>
<span id="cb4-159"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-160">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-161">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-162">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_extreme_weather_studies.png"</span></span>
<span id="cb4-163">  ),</span>
<span id="cb4-164">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-165">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-166">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-167">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-168">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-169">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_extreme_weather_studies.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_extreme_weather_studies.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-9"></span>
<span id="cb6-10">  patchwork             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"></span>
<span id="cb6-13">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-17">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-19">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="eylbwnvmxn" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#eylbwnvmxn table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eylbwnvmxn thead, #eylbwnvmxn tbody, #eylbwnvmxn tfoot, #eylbwnvmxn tr, #eylbwnvmxn td, #eylbwnvmxn th {
  border-style: none;
}

#eylbwnvmxn p {
  margin: 0;
  padding: 0;
}

#eylbwnvmxn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eylbwnvmxn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eylbwnvmxn .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eylbwnvmxn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eylbwnvmxn .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eylbwnvmxn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eylbwnvmxn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eylbwnvmxn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eylbwnvmxn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eylbwnvmxn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eylbwnvmxn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eylbwnvmxn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eylbwnvmxn .gt_spanner_row {
  border-bottom-style: hidden;
}

#eylbwnvmxn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eylbwnvmxn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eylbwnvmxn .gt_from_md > :first-child {
  margin-top: 0;
}

#eylbwnvmxn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eylbwnvmxn .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eylbwnvmxn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eylbwnvmxn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eylbwnvmxn .gt_row_group_first td {
  border-top-width: 2px;
}

#eylbwnvmxn .gt_row_group_first th {
  border-top-width: 2px;
}

#eylbwnvmxn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eylbwnvmxn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eylbwnvmxn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eylbwnvmxn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eylbwnvmxn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eylbwnvmxn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eylbwnvmxn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eylbwnvmxn .gt_striped {
  background-color: #FAFAFA;
}

#eylbwnvmxn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eylbwnvmxn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eylbwnvmxn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eylbwnvmxn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eylbwnvmxn .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eylbwnvmxn .gt_left {
  text-align: left;
}

#eylbwnvmxn .gt_center {
  text-align: center;
}

#eylbwnvmxn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eylbwnvmxn .gt_font_normal {
  font-weight: normal;
}

#eylbwnvmxn .gt_font_bold {
  font-weight: bold;
}

#eylbwnvmxn .gt_font_italic {
  font-style: italic;
}

#eylbwnvmxn .gt_super {
  font-size: 65%;
}

#eylbwnvmxn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eylbwnvmxn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eylbwnvmxn .gt_indent_1 {
  text-indent: 5px;
}

#eylbwnvmxn .gt_indent_2 {
  text-indent: 10px;
}

#eylbwnvmxn .gt_indent_3 {
  text-indent: 15px;
}

#eylbwnvmxn .gt_indent_4 {
  text-indent: 20px;
}

#eylbwnvmxn .gt_indent_5 {
  text-indent: 25px;
}

#eylbwnvmxn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eylbwnvmxn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="eylbwnvmxn" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="eylbwnvmxn">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","cli","colorspace","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","3.6.4","2.1-1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-02-13","2024-07-26","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"eylbwnvmxn","dataKey":"b78dc7312df85389c220fcb26b135ed8"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://carbonbrief.org/">Carbon Brief</a></li>
<li><a href="https://interactive.carbonbrief.org/attribution-studies/index.html">Mapped: How climate change affects extreme weather around the world</a></li>
<li><a href="https://www.iso.org/iso-3166-country-codes.html">ISO country codes</a></li>
<li><a href="https://carbonbrief.org/qa-the-evolving-science-of-extreme-weather-attribution/">in-depth Q&amp;A article</a></li>
<li><a href="https://github.com/rajodm">Rajo</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">#TidyTuesday</a></li>
<li><a href="https://www.tidyverse.org/"><code>tidyverse</code></a></li>
<li><a href="https://tidyr.tidyverse.org/reference/separate_longer_delim.html"><code>separate_longer_delim()</code></a></li>
<li><a href="https://docs.ropensci.org/rnaturalearth/reference/ne_countries.html"><code>rnaturalearth::ne_countries()</code></a></li>
<li><a href="https://r-spatial.github.io/sf/"><code>sf</code></a></li>
<li><a href="https://github.com/GuangchuangYu/scatterpie"><code>scatterpie</code></a></li>
<li><a href="https://guangchuangyu.github.io/scatterpie/reference/geom_scatterpie.html"><code>geom_scatterpie()</code></a></li>
<li><a href="https://github.com/yixuan/showtext"><code>showtext</code></a></li>
<li><a href="https://cran.r-project.org/web/packages/showtext/showtext.pdf"><code>font_add_google()</code></a></li>
<li><a href="https://wilkelab.org/ggtext/"><code>ggtext</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>coord_sf()</code></a></li>
<li><a href="https://guangchuangyu.github.io/scatterpie/reference/geom_scatterpie_legend.html"><code>geom_scatterpie_legend()</code></a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/"><code>paletteer</code></a></li>
<li><a href="https://jrnold.github.io/ggthemes/reference/theme_map.html"><code>ggthemes::theme_map()</code></a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Maps</category>
  <category>{scatterpie}</category>
  <category>Pie Chart</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_extreme_weather_studies.html</guid>
  <pubDate>Fri, 22 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_extreme_weather_studies.png" medium="image" type="image/png" height="115" width="144"/>
</item>
<item>
  <title>Mapping the Evolution of Scottish Munros</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_scottish_munros.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level1">
<h1>About the Data</h1>
<p>This dataset contains information about Scottish Munros, mountains with elevations exceeding 3,000 feet (914 meters), sourced from <a href="https://www.hills-database.co.uk/">The Database of British and Irish Hills</a> v18.2 and made available under a <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Licence</a>. Originally catalogued by Sir Hugh Munro in 1891, these peaks differ from other Scottish mountain classifications by lacking rigid prominence requirements, making the list subject to periodic revisions as new surveys are conducted. The dataset tracks the classification status of each peak across multiple revisions from 1891 to 2021, documenting whether summits were designated as full Munros, subsidiary Munro Tops, or excluded entirely during different time periods. Each entry includes precise coordinates using the British National Grid projection system, enabling geographic analysis of these iconic Scottish highlands. This data was curated by <a href="https://github.com/nrennie">Nicola Rennie</a> as part of the <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a> weekly data project, providing researchers and enthusiasts with a comprehensive historical record of how Scotland’s most celebrated peaks have been classified over more than a century.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_scottish_munros.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This map displays changes to Scotland’s official Munro list—mountains exceeding 3,000 feet in elevation—across nine survey revisions from 1921 to 1997. Each dot represents a Munro peak: green dots indicate mountains newly added to the list in that survey year, red dots show peaks that will be dropped in the next revision, and gray dots represent mountains that remained unchanged between consecutive surveys. The shifting classifications reflect improvements in surveying techniques and measurement accuracy over more than a century of Scottish mountaineering history.
</figcaption>
</figure>
</div>
</section>
<section id="how-the-graphic-was-created" class="level1">
<h1>How the Graphic Was Created</h1>
<p>This visualization was created using R’s powerful mapping and data visualization ecosystem. I started by loading the Scottish Munros dataset and transforming it using the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> suite of packages, particularly <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> for data manipulation and <a href="https://tidyr.tidyverse.org/"><code>tidyr</code></a> for reshaping the data from wide to long format with <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>pivot_longer()</code></a>. The coordinate data was converted into spatial objects using the <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> package’s <a href="https://r-spatial.github.io/sf/reference/st_as_sf.html"><code>st_as_sf()</code></a> function, specifying the British National Grid (OSGB36) projection (CRS 27700). To categorize each Munro’s status across survey years, I developed custom helper functions to identify previous and next years in the chronological sequence, then used <a href="https://purrr.tidyverse.org/"><code>purrr</code></a>’s <a href="https://purrr.tidyverse.org/reference/map2.html"><code>map2_lgl()</code></a> function to determine whether each peak was newly added, unchanged, or dropped in subsequent surveys. The Scotland boundary data was obtained using <a href="https://github.com/rspatial/geodata"><code>geodata::gadm()</code></a> and transformed to match the coordinate system. The final visualization was built with <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a>, using <a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>geom_sf()</code></a> to plot both the country boundary and Munro locations, <a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html"><code>facet_wrap()</code></a> to create separate panels for each survey year, and <a href="https://wilkelab.org/ggtext/reference/geom_richtext.html"><code>ggtext::geom_richtext()</code></a> to add formatted summary statistics. Custom fonts were integrated using <a href="https://github.com/yixuan/showtext"><code>showtext</code></a>, while the color palette and styling were enhanced with <a href="https://emilhvitfeldt.github.io/paletteer/"><code>paletteer</code></a> and extensive <a href="https://ggplot2.tidyverse.org/reference/theme.html"><code>theme()</code></a> customizations to create a clean, professional cartographic presentation.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  </span>
<span id="cb1-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">  sf</span>
<span id="cb1-12">)</span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Read in the Data</span></span>
<span id="cb1-15">scottish_munros <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-19/scottish_munros.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-16">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom Colours for dots</span></span>
<span id="cb2-33">custom_dot_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom size for dots</span></span>
<span id="cb2-36">size_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-39">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-42">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-45">)</span>
<span id="cb2-46">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-47">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-48">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-49">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-50">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-51">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-52">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:** The Database of British and Irish Hills"</span>, </span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-55">  social_caption_1, </span>
<span id="cb2-56">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-57">  social_caption_2</span>
<span id="cb2-58">  )</span>
<span id="cb2-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-60">   xtwitter_username, social_caption_1, </span>
<span id="cb2-61">   social_caption_2)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scottish Munros: A Century of Reclassification"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Mountains over 3,000 feet have been &lt;span style='color:#088158FF'&gt;**added**&lt;/span&gt; and &lt;span style='color:#BA2F2AFF'&gt;**dropped**&lt;/span&gt; from Scotland's official Munro&lt;br&gt;list across multiple surveys. Gray peaks remained unchanged between consecutive revisions."</span></span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># How many distinct munors are there</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scottish_munros |&gt; </span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(do_bih_number)</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scottish_munros |&gt; </span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(name)</span></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert into sf object for British National Grid (OSGB36) projection</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df1 &lt;- scottish_munros |&gt; </span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   distinct(do_bih_number, name, xcoord, ycoord, height_m) |&gt; </span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   drop_na() |&gt; </span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   st_as_sf(coords = c("xcoord", "ycoord"), crs = 27700)</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># scottish_munros |&gt; </span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(height_m) |&gt; </span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(height_m)) +</span></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_boxplot()</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df1 |&gt; </span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot() +</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_sf(</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     aes(colour = height_m),</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     size = 0.8</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   paletteer::scale_colour_paletteer_c(</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     "grDevices::Purple-Yellow",</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     direction = -1</span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   )</span></span>
<span id="cb3-29"></span>
<span id="cb3-30">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> scottish_munros <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(xcoord) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(ycoord)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xcoord"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ycoord"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_drop_geometry</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>),</span>
<span id="cb3-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>,</span>
<span id="cb3-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"value"</span></span>
<span id="cb3-38">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parse_number</span>(year)</span>
<span id="cb3-41">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Munro"</span>)</span>
<span id="cb3-43"></span>
<span id="cb3-44"></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Code help : Clause Sonnet 4</span></span>
<span id="cb3-46"></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define the chronological order of years</span></span>
<span id="cb3-48">year_order <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1891</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1921</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1933</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1953</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1969</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1974</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1981</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1984</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1990</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1997</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>)</span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a helper function to get previous and next years</span></span>
<span id="cb3-51">get_prev_year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(year) {</span>
<span id="cb3-52">  idx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(year_order <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> year)</span>
<span id="cb3-53">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (idx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(year_order[idx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-54">}</span>
<span id="cb3-55"></span>
<span id="cb3-56">get_next_year <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(year) {</span>
<span id="cb3-57">  idx <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(year_order <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> year)</span>
<span id="cb3-58">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (idx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(year_order)) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(year_order[idx <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb3-59">}</span>
<span id="cb3-60"></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the label_var</span></span>
<span id="cb3-62">plotdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-63">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(do_bih_number, year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(do_bih_number) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-66">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the years this munro appears in</span></span>
<span id="cb3-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">munro_years =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(year),</span>
<span id="cb3-68">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># For each year, check previous and next</span></span>
<span id="cb3-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prev_year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(year, get_prev_year),</span>
<span id="cb3-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">next_year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(year, get_next_year)</span>
<span id="cb3-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-74">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if munro was present in previous year</span></span>
<span id="cb3-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">was_in_prev =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-76">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(prev_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># First year, so can't be continued</span></span>
<span id="cb3-77">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2_lgl</span>(do_bih_number, prev_year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>{</span>
<span id="cb3-78">        .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> (df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> .y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(do_bih_number))</span>
<span id="cb3-79">      })</span>
<span id="cb3-80">    ),</span>
<span id="cb3-81">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if munro will be present in next year</span></span>
<span id="cb3-82">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">will_be_in_next =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-83">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(next_year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Last year, so can't be dropped</span></span>
<span id="cb3-84">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2_lgl</span>(do_bih_number, next_year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>{</span>
<span id="cb3-85">        .x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> (df2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> .y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(do_bih_number))</span>
<span id="cb3-86">      })</span>
<span id="cb3-87">    ),</span>
<span id="cb3-88">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the label</span></span>
<span id="cb3-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb3-90">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>was_in_prev <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Newly added in this Survey"</span>,</span>
<span id="cb3-91">      <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>will_be_in_next <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dropped in the next Survey"</span>,</span>
<span id="cb3-92">      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unchanged"</span></span>
<span id="cb3-93">    )</span>
<span id="cb3-94">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-95">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up helper columns</span></span>
<span id="cb3-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>munro_years, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>prev_year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>next_year, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>was_in_prev, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>will_be_in_next)</span>
<span id="cb3-97"></span>
<span id="cb3-98">plotdf1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(</span>
<span id="cb3-100">    scottish_munros <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-101">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(do_bih_number, xcoord, ycoord) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-102">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(xcoord) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(ycoord)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-103">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coords =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"xcoord"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ycoord"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>)</span>
<span id="cb3-104">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-105">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-106">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1891</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>)))</span>
<span id="cb3-107"></span>
<span id="cb3-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A summary table for labels in the facet</span></span>
<span id="cb3-109">plotdf2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-110">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(year, label_var) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> label_var, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1891</span>)</span>
<span id="cb3-114">label_vector <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(plotdf2)</span>
<span id="cb3-115">plotdf2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-116">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>)</span>
<span id="cb3-118"></span>
<span id="cb3-119">scotland <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> geodata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gadm</span>(</span>
<span id="cb3-120">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"United Kingdom"</span>,</span>
<span id="cb3-121">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">level =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb3-122">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">path =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempdir</span>(),</span>
<span id="cb3-123">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resolution =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-124">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-125">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-126">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_as_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(name_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Scotland"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">st_transform</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>)</span>
<span id="cb3-129">  </span>
<span id="cb3-130">scotland</span>
<span id="cb3-131">plotdf1</span>
<span id="cb3-132">plotdf2</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plotdf1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> scotland,</span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey80"</span>,</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span></span>
<span id="cb4-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf1,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> label_var),</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>,</span>
<span id="cb4-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb4-14">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(label_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unchanged"</span>),</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> label_var),</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-22">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf2,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-26">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">59.5</span>,</span>
<span id="cb4-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> year</span>
<span id="cb4-29">    ),</span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fontface =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-36">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> plotdf2,</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-40">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-41">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">59</span>,</span>
<span id="cb4-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-43">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:#088158FF'&gt;Newly added in this survey = "</span>,</span>
<span id="cb4-44">        newly_added_in_this_survey,</span>
<span id="cb4-45">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;&lt;br&gt;&lt;span style='color:#BA2F2AFF'&gt;Dropped in next survey = "</span>,</span>
<span id="cb4-46">        dropped_in_the_next_survey,</span>
<span id="cb4-47">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;"</span></span>
<span id="cb4-48">      )</span>
<span id="cb4-49">    ),</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>,</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>)</span>
<span id="cb4-58">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(</span>
<span id="cb4-60">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_manual</span>(</span>
<span id="cb4-63">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#BA2F2AFF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#088158FF"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span>),</span>
<span id="cb4-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(label_vector[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb4-65">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-66">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(</span>
<span id="cb4-67">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(</span>
<span id="cb4-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">override.aes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb4-69">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb4-70">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-71">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb4-72">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb4-73">      )</span>
<span id="cb4-74">    )</span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_sf</span>(</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">crs =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27700</span>,</span>
<span id="cb4-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">54.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">59.9</span>),</span>
<span id="cb4-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">default_crs =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"EPSG:4326"</span>,</span>
<span id="cb4-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>,</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb4-82">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-86">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption</span>
<span id="cb4-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-94">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-95">    </span>
<span id="cb4-96">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legend</span></span>
<span id="cb4-97">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb4-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.box.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-100">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-104">    ),</span>
<span id="cb4-105">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-106">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-107">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>),</span>
<span id="cb4-108">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-110">    ),</span>
<span id="cb4-111">    </span>
<span id="cb4-112">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-115">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-117">    ),</span>
<span id="cb4-118">    </span>
<span id="cb4-119">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-120">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-121">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-125">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-126">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-128">      ),</span>
<span id="cb4-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> bg_col,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">valign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-134">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-135">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-140">      ),</span>
<span id="cb4-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-146">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-147">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-148">    ),</span>
<span id="cb4-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-152">    </span>
<span id="cb4-153">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes Lines, Ticks, Text and labels</span></span>
<span id="cb4-154">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-155">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-156">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-157">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-158">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-159">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-160">    ),</span>
<span id="cb4-161">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-162">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-163">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-164">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts</span>
<span id="cb4-165">    ),</span>
<span id="cb4-166">    </span>
<span id="cb4-167">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Panels</span></span>
<span id="cb4-168">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-169">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.spacing.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb4-172">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb4-173">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-174">    ),</span>
<span id="cb4-175">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(</span>
<span id="cb4-176">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span>,</span>
<span id="cb4-177">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"transparent"</span></span>
<span id="cb4-178">    )</span>
<span id="cb4-179">  )</span>
<span id="cb4-180"></span>
<span id="cb4-181"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-182">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-183">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-184">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_scottish_munros.png"</span></span>
<span id="cb4-185">  ),</span>
<span id="cb4-186">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-187">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-188">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>,</span>
<span id="cb4-189">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-190">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-191">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_scottish_munros.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_scottish_munros.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-9"></span>
<span id="cb6-10">  patchwork             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"></span>
<span id="cb6-13">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-17">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-19">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="fvwuxokbrm" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#fvwuxokbrm table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fvwuxokbrm thead, #fvwuxokbrm tbody, #fvwuxokbrm tfoot, #fvwuxokbrm tr, #fvwuxokbrm td, #fvwuxokbrm th {
  border-style: none;
}

#fvwuxokbrm p {
  margin: 0;
  padding: 0;
}

#fvwuxokbrm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fvwuxokbrm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fvwuxokbrm .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fvwuxokbrm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fvwuxokbrm .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fvwuxokbrm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fvwuxokbrm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fvwuxokbrm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fvwuxokbrm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fvwuxokbrm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fvwuxokbrm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fvwuxokbrm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fvwuxokbrm .gt_spanner_row {
  border-bottom-style: hidden;
}

#fvwuxokbrm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fvwuxokbrm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fvwuxokbrm .gt_from_md > :first-child {
  margin-top: 0;
}

#fvwuxokbrm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fvwuxokbrm .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fvwuxokbrm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fvwuxokbrm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fvwuxokbrm .gt_row_group_first td {
  border-top-width: 2px;
}

#fvwuxokbrm .gt_row_group_first th {
  border-top-width: 2px;
}

#fvwuxokbrm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fvwuxokbrm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fvwuxokbrm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fvwuxokbrm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fvwuxokbrm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fvwuxokbrm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fvwuxokbrm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fvwuxokbrm .gt_striped {
  background-color: #FAFAFA;
}

#fvwuxokbrm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fvwuxokbrm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fvwuxokbrm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fvwuxokbrm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fvwuxokbrm .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fvwuxokbrm .gt_left {
  text-align: left;
}

#fvwuxokbrm .gt_center {
  text-align: center;
}

#fvwuxokbrm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fvwuxokbrm .gt_font_normal {
  font-weight: normal;
}

#fvwuxokbrm .gt_font_bold {
  font-weight: bold;
}

#fvwuxokbrm .gt_font_italic {
  font-style: italic;
}

#fvwuxokbrm .gt_super {
  font-size: 65%;
}

#fvwuxokbrm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fvwuxokbrm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fvwuxokbrm .gt_indent_1 {
  text-indent: 5px;
}

#fvwuxokbrm .gt_indent_2 {
  text-indent: 10px;
}

#fvwuxokbrm .gt_indent_3 {
  text-indent: 15px;
}

#fvwuxokbrm .gt_indent_4 {
  text-indent: 20px;
}

#fvwuxokbrm .gt_indent_5 {
  text-indent: 25px;
}

#fvwuxokbrm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fvwuxokbrm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="fvwuxokbrm" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="fvwuxokbrm">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","cli","colorspace","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","3.6.4","2.1-1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-02-13","2024-07-26","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"fvwuxokbrm","dataKey":"b78dc7312df85389c220fcb26b135ed8"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://www.hills-database.co.uk/">The Database of British and Irish Hills</a></li>
<li><a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International Licence</a></li>
<li><a href="https://github.com/nrennie">Nicola Rennie</a></li>
<li><a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday</a></li>
<li><a href="https://www.tidyverse.org/"><code>tidyverse</code></a></li>
<li><a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a></li>
<li><a href="https://tidyr.tidyverse.org/"><code>tidyr</code></a></li>
<li><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html"><code>pivot_longer()</code></a></li>
<li><a href="https://r-spatial.github.io/sf/"><code>sf</code></a></li>
<li><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html"><code>st_as_sf()</code></a></li>
<li><a href="https://purrr.tidyverse.org/"><code>purrr</code></a></li>
<li><a href="https://purrr.tidyverse.org/reference/map2.html"><code>map2_lgl()</code></a></li>
<li><a href="https://github.com/rspatial/geodata"><code>geodata::gadm()</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsf.html"><code>geom_sf()</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html"><code>facet_wrap()</code></a></li>
<li><a href="https://wilkelab.org/ggtext/reference/geom_richtext.html"><code>ggtext::geom_richtext()</code></a></li>
<li><a href="https://github.com/yixuan/showtext"><code>showtext</code></a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/"><code>paletteer</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/theme.html"><code>theme()</code></a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Maps</category>
  <category>{ggtext}</category>
  <category>Data Wrangling</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_scottish_munros.html</guid>
  <pubDate>Fri, 22 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_scottish_munros.png" medium="image" type="image/png" height="198" width="144"/>
</item>
<item>
  <title>Redistribution Effect: How Taxes Transform Inequality</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_income_inequality.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<p>This analysis explores income inequality before and after taxes using data processed and visualized by <a href="https://ourworldindata.org/income-inequality-before-and-after-taxes">Joe Hasell at Our World in Data</a>. The dataset combines information from multiple authoritative sources including the <a href="https://www.lisdatacenter.org/our-data/lis-database/">Luxembourg Income Study (2025)</a>, <a href="https://www.oecd.org/en/data/datasets/income-and-wealth-distribution-database.html">OECD’s Income and Wealth Distribution Database (2024)</a>, and population data from <a href="https://population.un.org/wpp/downloads?folder=Standard%20Projections&amp;group=Most%20used">UN World Population Prospects (2024)</a> and <a href="https://www.gapminder.org/data/documentation/gd003/">Gapminder</a>. The core metric used is the Gini coefficient, which measures inequality on a scale from 0 to 1, where higher values indicate greater inequality. The data includes both pre-tax income (market income before taxes and most government benefits) and post-tax income (disposable income after taxes and benefits), with income figures equivalized to account for household cost-sharing. This comprehensive dataset enables examination of how different countries redistribute income through their tax and benefit systems, providing insights into the effectiveness of various redistributive policies across nations and over time.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_income_inequality.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This dumbbell chart compares income inequality before and after government intervention across countries using their most recent available data (years shown in parentheses). Red circles represent pre-tax Gini coefficients, blue circles show post-tax values, and the gradient segments illustrate the transition. Black percentages indicate how much inequality each government reduces through taxes and transfers, revealing dramatic differences in redistributive effectiveness—from minimal impact in some nations to substantial reductions exceeding 40% in others.
</figcaption>
</figure>
</div>
</section>
<section id="how-the-graphic-was-created" class="level1">
<h1>How the Graphic Was Created</h1>
<p>This advanced dumbbell chart was created using R’s <a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a> ecosystem with several sophisticated techniques to enhance visual storytelling. The gradient-colored segments were achieved by breaking each line into multiple small segments using <a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a>’s <code>rowwise()</code> and <code>do()</code> functions, then mapping colors based on Gini coefficient values along a common scale from 0.22 to 0.75. The visualization required <a href="https://eliocamp.github.io/ggnewscale/"><code>ggnewscale</code></a> to implement multiple color scales—one for the gradient segments and another for the custom point legend. Rich text formatting for the value labels was accomplished using <a href="https://wilkelab.org/ggtext/"><code>ggtext</code></a>’s <code>geom_richtext()</code> function, allowing HTML-styled text with colored numbers and arrows. Country flags within the data points were added using <a href="https://github.com/jimjam-slam/ggflags"><code>ggflags</code></a> package’s <code>geom_flag()</code> function. The custom legend was created by plotting invisible dummy points with <code>scale_colour_manual()</code> and <code>guide_legend()</code>, while hiding the gradient legend with <code>guide = "none"</code>. Font management was handled through <a href="https://github.com/yixuan/showtext"><code>showtext</code></a> and <a href="https://github.com/yixuan/sysfonts"><code>sysfonts</code></a> packages, with Google Fonts integration for consistent typography throughout the visualization.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  </span>
<span id="cb1-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">  ggridges,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Making ridgeline plot </span></span>
<span id="cb1-12">  gghalves              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half geoms in ggplot2</span></span>
<span id="cb1-13">)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Option 2: Read directly from GitHub</span></span>
<span id="cb1-16"></span>
<span id="cb1-17">income_inequality_processed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-05/income_inequality_processed.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb1-18">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>()</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Not using the raw data in my graphic here</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># income_inequality_raw &lt;- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-08-05/income_inequality_raw.csv')</span></span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom Colours for dots</span></span>
<span id="cb2-33">custom_dot_colours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbapalettes::cavaliers_retro"</span>)</span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Custom size for dots</span></span>
<span id="cb2-36">size_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span></span>
<span id="cb2-37"></span>
<span id="cb2-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-39">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-40"></span>
<span id="cb2-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-42">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-43">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-44">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-45">)</span>
<span id="cb2-46">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-47">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-48">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-49">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-50">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-51">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-52">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-53">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:** Joe Hasell at Our World in Data"</span>, </span>
<span id="cb2-54">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-55">  social_caption_1, </span>
<span id="cb2-56">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-57">  social_caption_2</span>
<span id="cb2-58">  )</span>
<span id="cb2-59"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-60">   xtwitter_username, social_caption_1, </span>
<span id="cb2-61">   social_caption_2)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-64">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Redistribution Effect: How Taxes Transform Inequality"</span></span>
<span id="cb2-65"></span>
<span id="cb2-66">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Red dots represent market-driven inequality (pre-tax Gini coefficients), blue dots show government-adjusted outcomes (post-tax), with percentage reductions revealing redistributive effectiveness. Countries are ranked in descending order of their success in narrowing income gaps through taxes and social programs."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>)</span>
<span id="cb2-67"></span>
<span id="cb2-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check which year has the most countries</span></span>
<span id="cb3-2">income_inequality_processed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sort =</span> T) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desc</span>(year))</span>
<span id="cb3-6"></span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ============================================================================</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DATA PREPARATION AND TRANSFORMATION</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ============================================================================</span></span>
<span id="cb3-11">plot_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> income_inequality_processed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove rows with missing values in any column</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Group countries to get most recent year data for each</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(entity) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice_max</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order_by =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Keep only the latest year per country</span></span>
<span id="cb3-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove grouping for subsequent operations</span></span>
<span id="cb3-18">  </span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate improvement metrics for visualization</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-21">    </span>
<span id="cb3-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calculate proportional improvement (reduction in inequality)</span></span>
<span id="cb3-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">improvement =</span> (gini_mi_eq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> gini_dhi_eq)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>gini_mi_eq,</span>
<span id="cb3-24">    </span>
<span id="cb3-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert to percentage and round for clean display</span></span>
<span id="cb3-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage_reduction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(improvement <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-27">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-28">  </span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add country codes for plotting flags</span></span>
<span id="cb3-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_lower</span>(</span>
<span id="cb3-32">      countrycode<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">countrycode</span>(code, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso3c"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iso2c"</span>)</span>
<span id="cb3-33">    )</span>
<span id="cb3-34">  )</span>
<span id="cb3-35"></span>
<span id="cb3-36"></span>
<span id="cb3-37"></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create a common gradient data set for colouring the line segments</span></span>
<span id="cb3-39">gradient_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-40">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowwise</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-41">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do</span>({</span>
<span id="cb3-42">        n_segments <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Number of small segments per line</span></span>
<span id="cb3-43">        x_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gini_mi_eq, .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gini_dhi_eq, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> n_segments <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-44">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use actual Gini values for common color scale (0.22 to 0.75)</span></span>
<span id="cb3-45">        color_vals <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x_vals[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x_vals)]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use x-position for color mapping</span></span>
<span id="cb3-46">        </span>
<span id="cb3-47">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb3-48">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">entity =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>entity,</span>
<span id="cb3-49">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_vals[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x_vals)],</span>
<span id="cb3-50">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> x_vals[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb3-51">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_position =</span> color_vals,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Color based on actual Gini values</span></span>
<span id="cb3-52">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">improvement =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>improvement,</span>
<span id="cb3-53">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gini_mi_eq =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gini_mi_eq,</span>
<span id="cb3-54">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gini_dhi_eq =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>gini_dhi_eq,</span>
<span id="cb3-55">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">percentage_reduction =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>percentage_reduction</span>
<span id="cb3-56">        )</span>
<span id="cb3-57">      }) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span></span>
<span id="cb3-58">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>()</span>
<span id="cb3-59"></span>
<span id="cb3-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A small custom dataframe for making a custom legend</span></span>
<span id="cb3-61">legend_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">entity =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Canada"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Lithuania"</span>),</span>
<span id="cb3-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gini_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.685</span>),</span>
<span id="cb3-64">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pre-tax</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GINI"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Post-tax</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GINI"</span>),</span>
<span id="cb3-65">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dot_colours =</span> custom_dot_colours</span>
<span id="cb3-66">)</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CREATE THE DUMBBELL CHART</span></span>
<span id="cb4-2">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> plot_data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  </span>
<span id="cb4-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Initialize plot with countries ordered by improvement on y-axis</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-7">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(entity, improvement)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Order countries by redistribution effectiveness</span></span>
<span id="cb4-8">    )</span>
<span id="cb4-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  </span>
<span id="cb4-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------------------</span></span>
<span id="cb4-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DUMBBELL SEGMENTS (connecting lines with gradient along each segment)</span></span>
<span id="cb4-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------------------</span></span>
<span id="cb4-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot the gradient segments</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> gradient_data,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-18">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x,</span>
<span id="cb4-19">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend,</span>
<span id="cb4-20">      </span>
<span id="cb4-21">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Color varies based on Gini coefficient values</span></span>
<span id="cb4-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> color_position  </span>
<span id="cb4-23">    ),</span>
<span id="cb4-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.5</span>,</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span></span>
<span id="cb4-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-27">  paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_paletteer_c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pals::kovesi.rainbow_bgyrm_35_85_c71"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># paletteer::scale_colour_paletteer_c("viridis::turbo") +</span></span>
<span id="cb4-29">  ggnewscale<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">new_scale_colour</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-30"></span>
<span id="cb4-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------------------</span></span>
<span id="cb4-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ADD COUNTRY FLAGS INSIDE THE DOTS (which we will plot later)</span></span>
<span id="cb4-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ---------------------------------------------------------------------</span></span>
<span id="cb4-34">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-35">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-36">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_mi_eq,</span>
<span id="cb4-37">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> country_code</span>
<span id="cb4-38">    ),</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb4-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-41">  ggflags<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_flag</span>(</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_dhi_eq,</span>
<span id="cb4-44">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> country_code</span>
<span id="cb4-45">    ),</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span></span>
<span id="cb4-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-48"></span>
<span id="cb4-49">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --------------------------------------------------------------------</span></span>
<span id="cb4-50">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DUMBBELL POINTS (pre-tax and post-tax markers)</span></span>
<span id="cb4-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># --------------------------------------------------------------------</span></span>
<span id="cb4-52"> </span>
<span id="cb4-53">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-tax inequality points (red)</span></span>
<span id="cb4-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_mi_eq,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position at pre-tax Gini value</span></span>
<span id="cb4-57">    ),</span>
<span id="cb4-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> custom_dot_colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],    </span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_var, </span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, </span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb4-63">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-64">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-tax inequality points (blue)</span></span>
<span id="cb4-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_dhi_eq, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Position at post-tax Gini value</span></span>
<span id="cb4-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(entity, improvement)</span>
<span id="cb4-69">    ),</span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> custom_dot_colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],    </span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_var, </span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, </span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-74">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span></span>
<span id="cb4-75">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-76">  </span>
<span id="cb4-77">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-78">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># COUNTRY NAME LABELS</span></span>
<span id="cb4-79">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-82">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.58</span>,         </span>
<span id="cb4-83">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(entity, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" ("</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>),   </span>
<span id="cb4-84">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(entity, improvement),</span>
<span id="cb4-85">      </span>
<span id="cb4-86">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Special alignment for South Africa (right-aligned), others left-aligned</span></span>
<span id="cb4-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(entity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"South Africa"</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-88">    ),</span>
<span id="cb4-89">    </span>
<span id="cb4-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.8</span>,        </span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb4-93">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-94">  </span>
<span id="cb4-95">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-96">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RICH TEXT LABELS (values with colored formatting)</span></span>
<span id="cb4-97">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-98">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_richtext</span>(</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> (gini_mi_eq <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gini_dhi_eq) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Center labels between points</span></span>
<span id="cb4-101"></span>
<span id="cb4-102">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create multi-line HTML formatted text</span></span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb4-104">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:"</span>,custom_dot_colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;"</span>, </span>
<span id="cb4-105">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(gini_dhi_eq, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;  ← "</span>,    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pre-tax in red</span></span>
<span id="cb4-106">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:"</span>,custom_dot_colours[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"'&gt;"</span>, </span>
<span id="cb4-107">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(gini_mi_eq, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;/span&gt;&lt;br&gt;"</span>,   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Post-tax in blue</span></span>
<span id="cb4-108">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='color:grey10'&gt;"</span>, </span>
<span id="cb4-109">        percentage_reduction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%&lt;/span&gt;"</span>      </span>
<span id="cb4-110">      )</span>
<span id="cb4-111">    ),</span>
<span id="cb4-112">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,   </span>
<span id="cb4-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, </span>
<span id="cb4-115">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,  </span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>),</span>
<span id="cb4-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb4-119">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-120">  </span>
<span id="cb4-121">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-122">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SCALES + COLOR SCALE + LABELS</span></span>
<span id="cb4-123">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -------------------------------------------------------------------------</span></span>
<span id="cb4-124">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-125">  </span>
<span id="cb4-126">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Creating a Custom Legend ------------------------------------------------</span></span>
<span id="cb4-127">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-128">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> legend_df,</span>
<span id="cb4-129">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-130">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_value,</span>
<span id="cb4-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> entity,</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> dot_colours</span>
<span id="cb4-133">    ),</span>
<span id="cb4-134">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_var,</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-136">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-137">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb4-138">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb4-140">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> legend_df,</span>
<span id="cb4-141">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> gini_value,</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> entity,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> dot_colours,</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> type</span>
<span id="cb4-146">    ),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-148">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-149">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>,</span>
<span id="cb4-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-152">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-153">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb4-154">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-155">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_colour_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-156">  </span>
<span id="cb4-157">  </span>
<span id="cb4-158">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-159">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>),</span>
<span id="cb4-160">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-161">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-162">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-163">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-164">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-165">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Gini Coefficient (0 = Perfect Equality, 1 = Maximum Inequality)"</span>,</span>
<span id="cb4-166">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb4-167">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption</span>
<span id="cb4-168">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>(</span>
<span id="cb4-170">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-171">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-172">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-173">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-174">    </span>
<span id="cb4-175">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Legend: Not needed as colour does not convey any additional information</span></span>
<span id="cb4-176">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-177">    </span>
<span id="cb4-178">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-179">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-180">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-181">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-182">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-183">    ),</span>
<span id="cb4-184">    </span>
<span id="cb4-185">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-186">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-187">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-188">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-189">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-190">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-191">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-192">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-193">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span></span>
<span id="cb4-194">      ),</span>
<span id="cb4-195">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-196">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-197">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-198">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-199">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span>  bts,</span>
<span id="cb4-200">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-201">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-202">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-203">      ),</span>
<span id="cb4-204">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-205">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-206">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-207">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-208">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-209">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>,</span>
<span id="cb4-210">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-211">    ),</span>
<span id="cb4-212">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-213">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-214">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-215">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-216">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-217">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-218">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-219">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(text_hil, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>),</span>
<span id="cb4-220">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-221">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb4-222">    ),</span>
<span id="cb4-223">    </span>
<span id="cb4-224">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes Lines, Ticks, Text and labels</span></span>
<span id="cb4-225">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-226">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-227">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-228">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>))</span>
<span id="cb4-229">    ),</span>
<span id="cb4-230">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-231">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-232">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-233">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-234">    ),</span>
<span id="cb4-235">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-236">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-237">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-238">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-239">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-240">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-241">    ),</span>
<span id="cb4-242">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-243">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-244">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-245">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-246">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-247">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts</span>
<span id="cb4-248">    )</span>
<span id="cb4-249">    </span>
<span id="cb4-250">  )</span>
<span id="cb4-251"></span>
<span id="cb4-252"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-253">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-254">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-255">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_income_inequality.png"</span></span>
<span id="cb4-256">  ),</span>
<span id="cb4-257">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-258">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-259">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-260">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-261">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-262">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_income_inequality.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_income_inequality.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-9"></span>
<span id="cb6-10">  patchwork             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"></span>
<span id="cb6-13">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-17">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-19">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="xujikeggqr" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#xujikeggqr table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xujikeggqr thead, #xujikeggqr tbody, #xujikeggqr tfoot, #xujikeggqr tr, #xujikeggqr td, #xujikeggqr th {
  border-style: none;
}

#xujikeggqr p {
  margin: 0;
  padding: 0;
}

#xujikeggqr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xujikeggqr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xujikeggqr .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xujikeggqr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xujikeggqr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xujikeggqr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujikeggqr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xujikeggqr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xujikeggqr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xujikeggqr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xujikeggqr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xujikeggqr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xujikeggqr .gt_spanner_row {
  border-bottom-style: hidden;
}

#xujikeggqr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xujikeggqr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xujikeggqr .gt_from_md > :first-child {
  margin-top: 0;
}

#xujikeggqr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xujikeggqr .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xujikeggqr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xujikeggqr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xujikeggqr .gt_row_group_first td {
  border-top-width: 2px;
}

#xujikeggqr .gt_row_group_first th {
  border-top-width: 2px;
}

#xujikeggqr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujikeggqr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xujikeggqr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xujikeggqr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujikeggqr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujikeggqr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xujikeggqr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xujikeggqr .gt_striped {
  background-color: #FAFAFA;
}

#xujikeggqr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xujikeggqr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xujikeggqr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujikeggqr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xujikeggqr .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xujikeggqr .gt_left {
  text-align: left;
}

#xujikeggqr .gt_center {
  text-align: center;
}

#xujikeggqr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xujikeggqr .gt_font_normal {
  font-weight: normal;
}

#xujikeggqr .gt_font_bold {
  font-weight: bold;
}

#xujikeggqr .gt_font_italic {
  font-style: italic;
}

#xujikeggqr .gt_super {
  font-size: 65%;
}

#xujikeggqr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xujikeggqr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xujikeggqr .gt_indent_1 {
  text-indent: 5px;
}

#xujikeggqr .gt_indent_2 {
  text-indent: 10px;
}

#xujikeggqr .gt_indent_3 {
  text-indent: 15px;
}

#xujikeggqr .gt_indent_4 {
  text-indent: 20px;
}

#xujikeggqr .gt_indent_5 {
  text-indent: 25px;
}

#xujikeggqr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xujikeggqr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="xujikeggqr" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="xujikeggqr">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","cli","colorspace","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","3.6.4","2.1-1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-02-13","2024-07-26","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"xujikeggqr","dataKey":"b78dc7312df85389c220fcb26b135ed8"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://ourworldindata.org/income-inequality-before-and-after-taxes">Joe Hasell at Our World in Data</a></li>
<li><a href="https://www.lisdatacenter.org/our-data/lis-database/">Luxembourg Income Study (2025)</a></li>
<li><a href="https://www.oecd.org/en/data/datasets/income-and-wealth-distribution-database.html">OECD’s Income and Wealth Distribution Database (2024)</a></li>
<li><a href="https://population.un.org/wpp/downloads?folder=Standard%20Projections&amp;group=Most%20used">UN World Population Prospects (2024)</a></li>
<li><a href="https://www.gapminder.org/data/documentation/gd003/">Gapminder</a></li>
<li><a href="https://ggplot2.tidyverse.org/"><code>ggplot2</code></a></li>
<li><a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a></li>
<li><a href="https://eliocamp.github.io/ggnewscale/"><code>ggnewscale</code></a></li>
<li><a href="https://wilkelab.org/ggtext/"><code>ggtext</code></a></li>
<li><a href="https://github.com/jimjam-slam/ggflags"><code>ggflags</code></a></li>
<li><a href="https://github.com/yixuan/showtext"><code>showtext</code></a></li>
<li><a href="https://github.com/yixuan/sysfonts"><code>sysfonts</code></a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>Dumbbell Chart</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_income_inequality.html</guid>
  <pubDate>Tue, 05 Aug 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_income_inequality.png" medium="image" type="image/png" height="180" width="144"/>
</item>
<item>
  <title>Netflix Movie Runtimes vs. Viewership</title>
  <dc:creator>Aditya Dahiya</dc:creator>
  <link>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_netflix_data.html</link>
  <description><![CDATA[ 




<section id="about-the-data" class="level2">
<h2 class="anchored" data-anchor-id="about-the-data">About the Data</h2>
<p>This analysis uses Netflix viewing data from the <a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday project</a> (Week 30, 2025), which compiles viewing statistics from Netflix’s official <a href="https://about.netflix.com/en/news/what-we-watched-the-first-half-of-2025">Engagement Reports</a> spanning late 2023 through the first half of 2025. The dataset, curated by <a href="https://github.com/jenrichmond">Jen Richmond from RLadies-Sydney</a>, captures approximately 99% of all Netflix viewing activity, representing over 95 billion hours of content consumption across a diverse range of genres and languages. The data includes two main components: movies and TV shows, with detailed information on viewing hours, release dates, runtime, global availability status, and calculated view counts (derived from hours viewed divided by runtime). This comprehensive dataset provides insights into viewing patterns, content performance over time, and the relationship between release timing and audience engagement on the world’s leading streaming platform.</p>
<div id="fig-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_netflix_data.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: This visualization displays the distribution of Netflix movie viewership across 13 runtime categories, from under 30 minutes to over 3 hours. Each row shows a density ridge plot revealing the spread of viewership within that duration category, overlaid with boxplots indicating quartiles and outliers. Red dots mark the trimmed mean viewership for each category, while numbers on the right show the count of movies in each runtime bin. The x-axis uses a logarithmic scale to accommodate the wide range of viewership values.
</figcaption>
</figure>
</div>
</section>
<section id="how-the-graphic-was-created" class="level1">
<h1>How the Graphic Was Created</h1>
<p>This visualization was created using R and the <a href="https://www.tidyverse.org/">tidyverse</a> ecosystem, combining multiple layers to reveal Netflix movie viewership patterns across runtime categories. I first converted the runtime strings (e.g., “1H 30M 0S”) into numerical hours using <a href="https://lubridate.tidyverse.org/">lubridate’s</a> <code>duration()</code> function and custom regex extraction. The movies were then binned into 13 ordered runtime categories using <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cut"><code>cut()</code></a> with carefully defined breaks from &lt;30 minutes to &gt;3 hours. The core visualization layers three complementary geoms: <a href="https://wilkelab.org/ggridges/"><code>geom_density_ridges()</code></a> from the <a href="https://wilkelab.org/ggridges/">ggridges package</a> to show the distribution shape of viewership within each runtime category, <a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html"><code>geom_boxplot()</code></a> to display statistical summaries (quartiles and outliers), and <a href="https://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point()</code></a> to highlight the trimmed mean viewership for each category. The color palette was sourced from <a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a> using the “khroma::smoothrainbow” scheme, while text formatting utilized <a href="https://fonts.google.com/">Google Fonts</a> via <a href="https://github.com/yixuan/showtext">showtext</a> and <a href="https://wilkelab.org/ggtext/">ggtext</a> for enhanced typography. The x-axis employs a log10 transformation with <a href="https://scales.r-lib.org/">scales</a> formatting to handle the wide range of viewership values, and custom annotations display the count of movies in each duration category to provide context for the distributions.</p>
<section id="loading-required-libraries" class="level3">
<h3 class="anchored" data-anchor-id="loading-required-libraries">Loading required libraries</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb1-3">  </span>
<span id="cb1-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb1-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb1-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb1-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb1-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb1-9"></span>
<span id="cb1-10">  patchwork,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb1-11">  ggridges,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Making ridgeline plot </span></span>
<span id="cb1-12">  gghalves              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Half geoms in ggplot2</span></span>
<span id="cb1-13">)</span>
<span id="cb1-14"></span>
<span id="cb1-15">movies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-29/movies.csv'</span>)</span>
<span id="cb1-16"></span>
<span id="cb1-17">shows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-29/shows.csv'</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="visualization-parameters" class="level3">
<h3 class="anchored" data-anchor-id="visualization-parameters">Visualization Parameters</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for titles</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira"</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title_font"</span></span>
<span id="cb2-4">) </span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for the caption</span></span>
<span id="cb2-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Condensed"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb2-9">) </span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Font for plot text</span></span>
<span id="cb2-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add_google</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Saira Extra Condensed"</span>,</span>
<span id="cb2-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb2-14">) </span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">showtext_auto</span>()</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A base Colour</span></span>
<span id="cb2-19">bg_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span></span>
<span id="cb2-20">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(bg_col)</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for highlighted text</span></span>
<span id="cb2-23">text_hil <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-24">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_hil)</span>
<span id="cb2-25"></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Colour for the text</span></span>
<span id="cb2-27">text_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey20"</span></span>
<span id="cb2-28">seecolor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print_color</span>(text_col)</span>
<span id="cb2-29"></span>
<span id="cb2-30">line_col <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey30"</span></span>
<span id="cb2-31"></span>
<span id="cb2-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Define Base Text Size</span></span>
<span id="cb2-33">bts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb2-34"></span>
<span id="cb2-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Caption stuff for the plot</span></span>
<span id="cb2-36">sysfonts<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">font_add</span>(</span>
<span id="cb2-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands"</span>,</span>
<span id="cb2-38">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">regular =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"docs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Font Awesome 6 Brands-Regular-400.otf"</span>)</span>
<span id="cb2-39">)</span>
<span id="cb2-40">github <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xf09b"</span></span>
<span id="cb2-41">github_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aditya-dahiya"</span></span>
<span id="cb2-42">xtwitter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;#xe61b"</span></span>
<span id="cb2-43">xtwitter_username <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@adityadahiyaias"</span></span>
<span id="cb2-44">social_caption_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{github};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{github_username}  &lt;/span&gt;"</span>)</span>
<span id="cb2-45">social_caption_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;span style='font-family:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Font Awesome 6 Brands</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">;'&gt;{xtwitter};&lt;/span&gt; &lt;span style='color: {text_hil}'&gt;{xtwitter_username}&lt;/span&gt;"</span>)</span>
<span id="cb2-46">plot_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(</span>
<span id="cb2-47">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**Data:** Netflix &amp; Jen Richmond"</span>, </span>
<span id="cb2-48">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Code:** "</span>, </span>
<span id="cb2-49">  social_caption_1, </span>
<span id="cb2-50">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" |  **Graphics:** "</span>, </span>
<span id="cb2-51">  social_caption_2</span>
<span id="cb2-52">  )</span>
<span id="cb2-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span>(github, github_username, xtwitter, </span>
<span id="cb2-54">   xtwitter_username, social_caption_1, </span>
<span id="cb2-55">   social_caption_2)</span>
<span id="cb2-56"></span>
<span id="cb2-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add text to plot-------------------------------------------------</span></span>
<span id="cb2-58">plot_title <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Movie Duration vs. Viewership Patterns"</span></span>
<span id="cb2-59"></span>
<span id="cb2-60">plot_subtitle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"While most Netflix movies fall between 90-150 minutes, the highest average viewership belongs to extreme outliers. Short films under 30 minutes and epic movies over 3 hours capture the most viewer attention per title, despite being fewer in number."</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_wrap</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">85</span>)</span>
<span id="cb2-62"></span>
<span id="cb2-63"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_view</span>(plot_subtitle)</span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-data-analysis-and-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-data-analysis-and-wrangling">Exploratory Data Analysis and Wrangling</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Credits: Claude Sonnet 4.0</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function to convert runtime string to duration</span></span>
<span id="cb3-3">convert_runtime <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(runtime_string) {</span>
<span id="cb3-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract hours, minutes, and seconds using regex</span></span>
<span id="cb3-5">  hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(runtime_string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+(?=H)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>()</span>
<span id="cb3-6">  minutes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(runtime_string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+(?=M)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>()</span>
<span id="cb3-7">  seconds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_extract</span>(runtime_string, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d+(?=S)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>()</span>
<span id="cb3-8">  </span>
<span id="cb3-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace NA with 0</span></span>
<span id="cb3-10">  hours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(hours), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, hours)</span>
<span id="cb3-11">  minutes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(minutes), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, minutes)</span>
<span id="cb3-12">  seconds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(seconds), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, seconds)</span>
<span id="cb3-13">  </span>
<span id="cb3-14">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create duration object</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">duration</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hours =</span> hours, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minutes =</span> minutes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seconds =</span> seconds)</span>
<span id="cb3-16">}</span>
<span id="cb3-17"></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply to movies dataframe</span></span>
<span id="cb3-19">movies <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> movies <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert duration to a numerical / time duration variable</span></span>
<span id="cb3-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">runtime_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convert_runtime</span>(runtime),</span>
<span id="cb3-23">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert runtime to hours for better visualization</span></span>
<span id="cb3-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">runtime_hours =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(runtime_duration, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>)</span>
<span id="cb3-25">  )</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply to shows dataframe</span></span>
<span id="cb3-28">shows <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> shows <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert duration to a numerical / time duration variable</span></span>
<span id="cb3-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">runtime_duration =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">convert_runtime</span>(runtime),</span>
<span id="cb3-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert runtime to hours for better visualization</span></span>
<span id="cb3-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">runtime_hours =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(runtime_duration, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hours"</span>)</span>
<span id="cb3-34">  )</span>
<span id="cb3-35"></span>
<span id="cb3-36"></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Explore the data with summarytools</span></span>
<span id="cb3-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(summarytools)</span></span>
<span id="cb3-39"></span>
<span id="cb3-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># movies |&gt; </span></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   </span></span>
<span id="cb3-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shows |&gt; </span></span>
<span id="cb3-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   dfSummary() |&gt; </span></span>
<span id="cb3-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   view()</span></span>
<span id="cb3-48"></span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Some trial examples to detect pattern in shows and movies duration</span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shows |&gt; </span></span>
<span id="cb3-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(</span></span>
<span id="cb3-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     mapping = aes(</span></span>
<span id="cb3-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       x = as.numeric(runtime_duration, "hours")</span></span>
<span id="cb3-55"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_boxplot(alpha = 0.2) +</span></span>
<span id="cb3-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   scale_x_log10(name = "Runtime (hours)")</span></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shows |&gt; </span></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(</span></span>
<span id="cb3-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     mapping = aes(</span></span>
<span id="cb3-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       x = as.numeric(runtime_duration, "hours"),</span></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       y = hours_viewed</span></span>
<span id="cb3-65"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_point(</span></span>
<span id="cb3-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     alpha = 0.3</span></span>
<span id="cb3-69"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_smooth() +</span></span>
<span id="cb3-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   scale_x_log10(name = "Runtime (hours)")</span></span>
<span id="cb3-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   </span></span>
<span id="cb3-73"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   </span></span>
<span id="cb3-74"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shows |&gt; </span></span>
<span id="cb3-75"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(</span></span>
<span id="cb3-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     mapping = aes(</span></span>
<span id="cb3-77"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       x = as.numeric(runtime_duration, "hours"),</span></span>
<span id="cb3-78"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#       y = hours_viewed</span></span>
<span id="cb3-79"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#     )</span></span>
<span id="cb3-80"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ) +</span></span>
<span id="cb3-81"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_violin() +</span></span>
<span id="cb3-82"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   scale_x_log10(name = "Runtime (hours)")</span></span>
<span id="cb3-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># # I took some Ideas from AI: Claude Sonnet 4.0</span></span>
<span id="cb3-85"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># library(ggridges)    # For ridge plots</span></span>
<span id="cb3-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb3-87"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># movies |&gt; </span></span>
<span id="cb3-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   select(runtime_hours, hours_viewed, views) |&gt; </span></span>
<span id="cb3-89"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   filter(runtime_hours &gt; (1/2) &amp; runtime_hours &lt; 3) |&gt; </span></span>
<span id="cb3-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ggplot(aes(runtime_hours)) +</span></span>
<span id="cb3-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   geom_boxplot()</span></span>
<span id="cb3-92">  </span>
<span id="cb3-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Planning a RIDGE PLOT - Shows distribution of views across runtime bins</span></span>
<span id="cb3-94"></span>
<span id="cb3-95">df1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> movies <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-96">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(runtime_hours, hours_viewed, views) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-97">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb3-98">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">runtime_bin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(</span>
<span id="cb3-99">      runtime_hours, </span>
<span id="cb3-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.67</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.83</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.17</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.33</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.67</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.83</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-102">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;30min"</span>, </span>
<span id="cb3-103">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"30-40min"</span>, </span>
<span id="cb3-104">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40-50min"</span>, </span>
<span id="cb3-105">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"50-60min"</span>, </span>
<span id="cb3-106">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h-1h10m"</span>, </span>
<span id="cb3-107">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h10-1h20m"</span>, </span>
<span id="cb3-108">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h20-1h30m"</span>, </span>
<span id="cb3-109">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h30-1h40m"</span>, </span>
<span id="cb3-110">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h40-1h50m"</span>, </span>
<span id="cb3-111">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1h50m-2h"</span>, </span>
<span id="cb3-112">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2h-2h30m"</span>, </span>
<span id="cb3-113">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2h30m-3h"</span>, </span>
<span id="cb3-114">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&gt;3 hours"</span></span>
<span id="cb3-115">      ),</span>
<span id="cb3-116">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">include.lowest =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb3-117">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ordered_result =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-118">    )</span>
<span id="cb3-119">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(</span>
<span id="cb3-121">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(runtime_bin),</span>
<span id="cb3-122">    <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(views),</span>
<span id="cb3-123">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.finite</span>(views),</span>
<span id="cb3-124">    views <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove zero or negative views</span></span>
<span id="cb3-125">    views <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Remove infinite values</span></span>
<span id="cb3-126">  )</span>
<span id="cb3-127"></span>
<span id="cb3-128"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df1$runtime_bin |&gt; levels()</span></span>
<span id="cb3-129"></span>
<span id="cb3-130"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pacman::p_load(ggridges, gghalves)</span></span>
<span id="cb3-131"></span>
<span id="cb3-132"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df1 |&gt; </span></span>
<span id="cb3-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   count(runtime_bin)</span></span>
<span id="cb3-134"></span>
<span id="cb3-135">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(runtime_bin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(</span>
<span id="cb3-138">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mean_views =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(views, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trim =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>),</span>
<span id="cb3-139">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">median_views =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">median</span>(views, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> T)</span>
<span id="cb3-140">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="the-plot" class="level3">
<h3 class="anchored" data-anchor-id="the-plot">The Plot</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">g <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-4">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> views, </span>
<span id="cb4-5">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> runtime_bin</span>
<span id="cb4-6">    )</span>
<span id="cb4-7">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density_ridges</span>(</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> runtime_bin),</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2</span>,</span>
<span id="cb4-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col</span>
<span id="cb4-13">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(</span>
<span id="cb4-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> runtime_bin),</span>
<span id="cb4-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outliers =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>,</span>
<span id="cb4-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">staplewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,</span>
<span id="cb4-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span></span>
<span id="cb4-23">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb4-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df2,</span>
<span id="cb4-26">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mapping =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mean_views),</span>
<span id="cb4-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb4-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stroke =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,</span>
<span id="cb4-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pch =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span></span>
<span id="cb4-32">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_label</span>(</span>
<span id="cb4-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">count</span>(runtime_bin),</span>
<span id="cb4-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5e6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> scales<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number</span>(n, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">big.mark =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">","</span>)),</span>
<span id="cb4-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nudge_y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,</span>
<span id="cb4-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(bg_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb4-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb4-43">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(</span>
<span id="cb4-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"label"</span>,</span>
<span id="cb4-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5e6</span>,</span>
<span id="cb4-47">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">13.65</span>,</span>
<span id="cb4-48">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Number of movies in</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">the duration category"</span>,</span>
<span id="cb4-49">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb4-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-51">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alpha</span>(bg_col, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>),</span>
<span id="cb4-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.size =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb4-55">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label.padding =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lines"</span>)</span>
<span id="cb4-57">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb4-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_number</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"M"</span>),</span>
<span id="cb4-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5e6</span>),</span>
<span id="cb4-61">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">transform =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log10"</span>,</span>
<span id="cb4-62">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-63">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-64">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_manual</span>(</span>
<span id="cb4-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> paletteer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paletteer_d</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"khroma::smoothrainbow"</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>)]</span>
<span id="cb4-66">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-67">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_cartesian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clip =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"off"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb4-69">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Viewership, on log scale (millions)"</span>, </span>
<span id="cb4-70">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Duration of the Movies"</span>,</span>
<span id="cb4-71">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> plot_title,</span>
<span id="cb4-72">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> plot_subtitle,</span>
<span id="cb4-73">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> plot_caption</span>
<span id="cb4-74">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-75">  ggthemes<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_map</span>(</span>
<span id="cb4-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-77">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">base_size =</span> bts</span>
<span id="cb4-78">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-79">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb4-80">    </span>
<span id="cb4-81">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>,</span>
<span id="cb4-82">    </span>
<span id="cb4-83">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Overall</span></span>
<span id="cb4-84">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_col,</span>
<span id="cb4-87">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-88">    ),</span>
<span id="cb4-89">    </span>
<span id="cb4-90">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Labels and Strip Text</span></span>
<span id="cb4-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-92">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-93">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-96">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-97">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span></span>
<span id="cb4-98">      ),</span>
<span id="cb4-99">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-100">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-101">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-102">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-103">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"body_font"</span>,</span>
<span id="cb4-106">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineheight =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-107">      ),</span>
<span id="cb4-108">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox</span>(</span>
<span id="cb4-109">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-110">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">halign =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts,</span>
<span id="cb4-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span></span>
<span id="cb4-115">    ),</span>
<span id="cb4-116">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-117">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>,</span>
<span id="cb4-118">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-119">    </span>
<span id="cb4-120">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Axes Lines, Ticks, Text and labels</span></span>
<span id="cb4-121">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-122">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-123">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,</span>
<span id="cb4-124">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>))</span>
<span id="cb4-125">    ),</span>
<span id="cb4-126">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(</span>
<span id="cb4-127">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-128">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb4-129">    ),</span>
<span id="cb4-130">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks.length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-131">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-133">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil</span>
<span id="cb4-134">    ),</span>
<span id="cb4-135">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-136">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-137">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-138">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caption_font"</span>,</span>
<span id="cb4-139">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> bts,</span>
<span id="cb4-140">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb4-141">    ),</span>
<span id="cb4-142">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-143">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-144">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-145">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb4-146">    ),</span>
<span id="cb4-147">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(</span>
<span id="cb4-148">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> text_hil,</span>
<span id="cb4-149">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>),</span>
<span id="cb4-150">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> bts <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span></span>
<span id="cb4-151">    )</span>
<span id="cb4-152">    </span>
<span id="cb4-153">  )</span>
<span id="cb4-154"></span>
<span id="cb4-155"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(</span>
<span id="cb4-156">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">filename =</span> here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb4-157">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>,</span>
<span id="cb4-158">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_netflix_data.png"</span></span>
<span id="cb4-159">  ),</span>
<span id="cb4-160">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> g,</span>
<span id="cb4-161">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,</span>
<span id="cb4-162">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,</span>
<span id="cb4-163">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mm"</span>,</span>
<span id="cb4-164">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> bg_col</span>
<span id="cb4-165">)</span></code></pre></div>
</details>
</div>
</section>
<section id="savings-the-thumbnail-for-the-webpage" class="level3">
<h3 class="anchored" data-anchor-id="savings-the-thumbnail-for-the-webpage">Savings the thumbnail for the webpage</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail</span></span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(magick)</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Saving a thumbnail for the webpage</span></span>
<span id="cb5-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_read</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-7">                      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_netflix_data.png"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_resize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geometry =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x400"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image_write</span>(</span>
<span id="cb5-10">    here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(</span>
<span id="cb5-11">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data_vizs"</span>, </span>
<span id="cb5-12">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thumbnails"</span>, </span>
<span id="cb5-13">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tidy_netflix_data.png"</span></span>
<span id="cb5-14">    )</span>
<span id="cb5-15">  )</span></code></pre></div>
</details>
</div>
</section>
<section id="session-info" class="level3">
<h3 class="anchored" data-anchor-id="session-info">Session Info</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb6-2">  tidyverse,            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># All things tidy</span></span>
<span id="cb6-3">  </span>
<span id="cb6-4">  scales,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nice Scales for ggplot2</span></span>
<span id="cb6-5">  fontawesome,          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Icons display in ggplot2</span></span>
<span id="cb6-6">  ggtext,               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Markdown text support for ggplot2</span></span>
<span id="cb6-7">  showtext,             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Display fonts in ggplot2</span></span>
<span id="cb6-8">  colorspace,           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lighten and Darken colours</span></span>
<span id="cb6-9"></span>
<span id="cb6-10">  patchwork             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Composing Plots</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"></span>
<span id="cb6-13">sessioninfo<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">session_info</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>packages <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-15">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(package, </span>
<span id="cb6-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> loadedversion, </span>
<span id="cb6-17">         date, source) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-18">  dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(package) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-19">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>(</span>
<span id="cb6-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"title"</span></span>
<span id="cb6-21">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-22">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">  gt<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">opt_interactive</span>(</span>
<span id="cb6-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">use_search =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb6-25">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-26">  gtExtras<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gt_theme_espn</span>()</span></code></pre></div>
</details>
<div id="tbl-session-info" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: R Packages and their versions used in the creation of this page and graphics
</figcaption>
<div aria-describedby="tbl-session-info-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="karhzhilgw" class=".gt_table" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#karhzhilgw table {
  font-family: Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#karhzhilgw thead, #karhzhilgw tbody, #karhzhilgw tfoot, #karhzhilgw tr, #karhzhilgw td, #karhzhilgw th {
  border-style: none;
}

#karhzhilgw p {
  margin: 0;
  padding: 0;
}

#karhzhilgw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 3px;
  border-top-color: #FFFFFF;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#karhzhilgw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#karhzhilgw .gt_title {
  color: #333333;
  font-size: 24px;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#karhzhilgw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#karhzhilgw .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#karhzhilgw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#karhzhilgw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#karhzhilgw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#karhzhilgw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#karhzhilgw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#karhzhilgw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#karhzhilgw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#karhzhilgw .gt_spanner_row {
  border-bottom-style: hidden;
}

#karhzhilgw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#karhzhilgw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#karhzhilgw .gt_from_md > :first-child {
  margin-top: 0;
}

#karhzhilgw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#karhzhilgw .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #F6F7F7;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#karhzhilgw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 80%;
  font-weight: bolder;
  text-transform: uppercase;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#karhzhilgw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#karhzhilgw .gt_row_group_first td {
  border-top-width: 2px;
}

#karhzhilgw .gt_row_group_first th {
  border-top-width: 2px;
}

#karhzhilgw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#karhzhilgw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#karhzhilgw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#karhzhilgw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#karhzhilgw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#karhzhilgw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#karhzhilgw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#karhzhilgw .gt_striped {
  background-color: #FAFAFA;
}

#karhzhilgw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#karhzhilgw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#karhzhilgw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#karhzhilgw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#karhzhilgw .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#karhzhilgw .gt_left {
  text-align: left;
}

#karhzhilgw .gt_center {
  text-align: center;
}

#karhzhilgw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#karhzhilgw .gt_font_normal {
  font-weight: normal;
}

#karhzhilgw .gt_font_bold {
  font-weight: bold;
}

#karhzhilgw .gt_font_italic {
  font-style: italic;
}

#karhzhilgw .gt_super {
  font-size: 65%;
}

#karhzhilgw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#karhzhilgw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#karhzhilgw .gt_indent_1 {
  text-indent: 5px;
}

#karhzhilgw .gt_indent_2 {
  text-indent: 10px;
}

#karhzhilgw .gt_indent_3 {
  text-indent: 15px;
}

#karhzhilgw .gt_indent_4 {
  text-indent: 20px;
}

#karhzhilgw .gt_indent_5 {
  text-indent: 25px;
}

#karhzhilgw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#karhzhilgw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<div id="karhzhilgw" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="karhzhilgw">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Package":["R6","Rcpp","cli","colorspace","digest","dplyr","evaluate","farver","fastmap","fontawesome","forcats","generics","ggplot2","ggtext","glue","gridtext","gt","gtExtras","gtable","hms","htmltools","htmlwidgets","janitor","jsonlite","knitr","lifecycle","lubridate","magrittr","munsell","pacman","paletteer","patchwork","pillar","pkgconfig","purrr","readr","rematch2","rlang","rmarkdown","rstudioapi","scales","sessioninfo","showtext","showtextdb","snakecase","stringi","stringr","sysfonts","tibble","tidyr","tidyselect","tidyverse","timechange","tzdb","vctrs","withr","xfun","xml2","yaml"],"Version":["2.6.1","1.0.14","3.6.4","2.1-1","0.6.37","1.1.4","1.0.3","2.1.2","1.2.0","0.5.3","1.0.0","0.1.4","3.5.2","0.1.2","1.8.0","0.1.5","1.0.0","0.5.0","0.3.6","1.1.3","0.5.8.1","1.6.4","2.2.1","2.0.0","1.50","1.0.4","1.9.4","2.0.3","0.5.1","0.5.1","1.6.0","1.3.0","1.11.0","2.0.3","1.0.4","2.1.5","2.1.2","1.1.6","2.29","0.17.1","1.3.0","1.2.3","0.9-7","3.0","0.11.1","1.8.7","1.5.1","0.8.9","3.2.1","1.3.1","1.2.1","2.0.0","0.3.0","0.5.0","0.6.5","3.0.2","0.52","1.3.8","2.3.10"],"Date":["2025-02-15","2025-01-12","2025-02-13","2024-07-26","2024-08-19","2023-11-17","2025-01-10","2024-05-13","2024-05-15","2024-11-16","2023-01-29","2025-05-09","2025-04-09","2022-09-16","2024-09-30","2022-09-16","2025-04-05","2023-09-15","2024-10-25","2023-03-21","2024-04-04","2023-12-06","2024-12-22","2025-03-27","2025-03-16","2023-11-07","2024-12-08","2022-03-30","2024-04-01","2019-03-11","2024-01-21","2024-09-16","2025-07-04","2019-09-22","2025-02-05","2024-01-10","2020-05-01","2025-04-11","2024-11-04","2024-10-22","2023-11-28","2025-02-05","2024-03-02","2020-06-04","2023-08-27","2025-03-27","2023-11-14","2024-03-02","2023-03-20","2024-01-24","2024-03-11","2023-02-22","2024-01-18","2025-03-15","2023-12-01","2024-10-28","2025-04-02","2025-03-14","2024-07-26"],"Source":["CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.1)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)","CRAN (R 4.5.0)"]},"columns":[{"id":"Package","name":"Package","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"},{"id":"Version","name":"Version","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Date","name":"Date","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"right"},{"id":"Source","name":"Source","type":"character","na":"NA","minWidth":125,"style":"function(rowInfo, colInfo) {\nconst rowIndex = rowInfo.index + 1\n}","html":true,"align":"left"}],"searchable":true,"defaultPageSize":10,"showPageSizeOptions":false,"pageSizeOptions":[10,25,50,100],"paginationType":"numbers","showPagination":true,"showPageInfo":true,"minRows":1,"striped":true,"height":"auto","theme":{"color":"#333333","backgroundColor":"#FFFFFF","stripedColor":"#fafafa","style":{"font-family":"Lato, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif","fontSize":"16px"},"tableStyle":{"borderTopStyle":"solid","borderTopWidth":"2px","borderTopColor":"#D3D3D3"},"headerStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"groupHeaderStyle":{"fontWeight":"bolder","backgroundColor":"transparent","borderBottomStyle":"solid","borderBottomWidth":"2px","borderBottomColor":"#D3D3D3"},"cellStyle":{"fontWeight":"normal"}},"elementId":"karhzhilgw","dataKey":"b78dc7312df85389c220fcb26b135ed8"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.style","tag.attribs.columns.1.style","tag.attribs.columns.2.style","tag.attribs.columns.3.style"],"jsHooks":[]}</script>
</div>
</div>
</div>
</figure>
</div>
</div>


</section>
</section>
<section class="level1">
<h1>Links</h1>
<ul>
<li><a href="https://github.com/rfordatascience/tidytuesday">TidyTuesday project</a></li>
<li><a href="https://about.netflix.com/en/news/what-we-watched-the-first-half-of-2025">Engagement Reports</a></li>
<li><a href="https://github.com/jenrichmond">Jen Richmond from RLadies-Sydney</a></li>
<li><a href="https://www.tidyverse.org/">tidyverse</a></li>
<li><a href="https://lubridate.tidyverse.org/">lubridate’s</a></li>
<li><a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/cut"><code>cut()</code></a></li>
<li><a href="https://wilkelab.org/ggridges/"><code>geom_density_ridges()</code></a></li>
<li><a href="https://wilkelab.org/ggridges/">ggridges package</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html"><code>geom_boxplot()</code></a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point()</code></a></li>
<li><a href="https://emilhvitfeldt.github.io/paletteer/">paletteer</a></li>
<li><a href="https://fonts.google.com/">Google Fonts</a></li>
<li><a href="https://github.com/yixuan/showtext">showtext</a></li>
<li><a href="https://wilkelab.org/ggtext/">ggtext</a></li>
<li><a href="https://scales.r-lib.org/">scales</a></li>
</ul>
</section>

 ]]></description>
  <category>#TidyTuesday</category>
  <category>{ggridges}</category>
  <category>Density Ridges Plot</category>
  <guid>https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/tidy_netflix_data.html</guid>
  <pubDate>Tue, 29 Jul 2025 18:30:00 GMT</pubDate>
  <media:content url="https://aditya-dahiya.github.io/projects_presentations/projects.html/data_vizs/thumbnails/tidy_netflix_data.png" medium="image" type="image/png" height="180" width="144"/>
</item>
</channel>
</rss>
